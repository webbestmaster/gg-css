require=(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
(function (global){(function (){
"use strict";

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

;var __browserify_shim_require__ = require;(function browserifyShim(module, exports, require, define, browserify_shim__define__module__export__) {
  /** vim: et:ts=4:sw=4:sts=4
   * @license RequireJS 2.3.3 Copyright jQuery Foundation and other contributors.
   * Released under MIT license, https://github.com/requirejs/requirejs/blob/master/LICENSE
   */
  var requirejs, require, define;!function (global, setTimeout) {
    function commentReplace(e, t) {
      return t || "";
    }function isFunction(e) {
      return "[object Function]" === ostring.call(e);
    }function isArray(e) {
      return "[object Array]" === ostring.call(e);
    }function each(e, t) {
      if (e) {
        var i;for (i = 0; i < e.length && (!e[i] || !t(e[i], i, e)); i += 1) {}
      }
    }function eachReverse(e, t) {
      if (e) {
        var i;for (i = e.length - 1; i > -1 && (!e[i] || !t(e[i], i, e)); i -= 1) {}
      }
    }function hasProp(e, t) {
      return hasOwn.call(e, t);
    }function getOwn(e, t) {
      return hasProp(e, t) && e[t];
    }function eachProp(e, t) {
      var i;for (i in e) {
        if (hasProp(e, i) && t(e[i], i)) break;
      }
    }function mixin(e, t, i, r) {
      return t && eachProp(t, function (t, n) {
        !i && hasProp(e, n) || (!r || "object" != (typeof t === "undefined" ? "undefined" : _typeof(t)) || !t || isArray(t) || isFunction(t) || t instanceof RegExp ? e[n] = t : (e[n] || (e[n] = {}), mixin(e[n], t, i, r)));
      }), e;
    }function bind(e, t) {
      return function () {
        return t.apply(e, arguments);
      };
    }function scripts() {
      return document.getElementsByTagName("script");
    }function defaultOnError(e) {
      throw e;
    }function getGlobal(e) {
      if (!e) return e;var t = global;return each(e.split("."), function (e) {
        t = t[e];
      }), t;
    }function makeError(e, t, i, r) {
      var n = new Error(t + "\nhttp://requirejs.org/docs/errors.html#" + e);return n.requireType = e, n.requireModules = r, i && (n.originalError = i), n;
    }function newContext(e) {
      function t(e) {
        var t, i;for (t = 0; t < e.length; t++) {
          if (i = e[t], "." === i) e.splice(t, 1), t -= 1;else if (".." === i) {
            if (0 === t || 1 === t && ".." === e[2] || ".." === e[t - 1]) continue;t > 0 && (e.splice(t - 1, 2), t -= 2);
          }
        }
      }function i(e, i, r) {
        var n,
            o,
            a,
            s,
            u,
            c,
            d,
            p,
            f,
            l,
            h,
            m,
            g = i && i.split("/"),
            v = y.map,
            x = v && v["*"];if (e && (e = e.split("/"), d = e.length - 1, y.nodeIdCompat && jsSuffixRegExp.test(e[d]) && (e[d] = e[d].replace(jsSuffixRegExp, "")), "." === e[0].charAt(0) && g && (m = g.slice(0, g.length - 1), e = m.concat(e)), t(e), e = e.join("/")), r && v && (g || x)) {
          a = e.split("/");e: for (s = a.length; s > 0; s -= 1) {
            if (c = a.slice(0, s).join("/"), g) for (u = g.length; u > 0; u -= 1) {
              if (o = getOwn(v, g.slice(0, u).join("/")), o && (o = getOwn(o, c))) {
                p = o, f = s;break e;
              }
            }!l && x && getOwn(x, c) && (l = getOwn(x, c), h = s);
          }!p && l && (p = l, f = h), p && (a.splice(0, f, p), e = a.join("/"));
        }return n = getOwn(y.pkgs, e), n ? n : e;
      }function r(e) {
        isBrowser && each(scripts(), function (t) {
          if (t.getAttribute("data-requiremodule") === e && t.getAttribute("data-requirecontext") === q.contextName) return t.parentNode.removeChild(t), !0;
        });
      }function n(e) {
        var t = getOwn(y.paths, e);if (t && isArray(t) && t.length > 1) return t.shift(), q.require.undef(e), q.makeRequire(null, { skipMap: !0 })([e]), !0;
      }function o(e) {
        var t,
            i = e ? e.indexOf("!") : -1;return i > -1 && (t = e.substring(0, i), e = e.substring(i + 1, e.length)), [t, e];
      }function a(e, t, r, n) {
        var a,
            s,
            u,
            c,
            d = null,
            p = t ? t.name : null,
            f = e,
            l = !0,
            h = "";return e || (l = !1, e = "_@r" + (T += 1)), c = o(e), d = c[0], e = c[1], d && (d = i(d, p, n), s = getOwn(j, d)), e && (d ? h = r ? e : s && s.normalize ? s.normalize(e, function (e) {
          return i(e, p, n);
        }) : e.indexOf("!") === -1 ? i(e, p, n) : e : (h = i(e, p, n), c = o(h), d = c[0], h = c[1], r = !0, a = q.nameToUrl(h))), u = !d || s || r ? "" : "_unnormalized" + (A += 1), { prefix: d, name: h, parentMap: t, unnormalized: !!u, url: a, originalName: f, isDefine: l, id: (d ? d + "!" + h : h) + u };
      }function s(e) {
        var t = e.id,
            i = getOwn(S, t);return i || (i = S[t] = new q.Module(e)), i;
      }function u(e, t, i) {
        var r = e.id,
            n = getOwn(S, r);!hasProp(j, r) || n && !n.defineEmitComplete ? (n = s(e), n.error && "error" === t ? i(n.error) : n.on(t, i)) : "defined" === t && i(j[r]);
      }function c(e, t) {
        var i = e.requireModules,
            r = !1;t ? t(e) : (each(i, function (t) {
          var i = getOwn(S, t);i && (i.error = e, i.events.error && (r = !0, i.emit("error", e)));
        }), r || req.onError(e));
      }function d() {
        globalDefQueue.length && (each(globalDefQueue, function (e) {
          var t = e[0];"string" == typeof t && (q.defQueueMap[t] = !0), O.push(e);
        }), globalDefQueue = []);
      }function p(e) {
        delete S[e], delete k[e];
      }function f(e, t, i) {
        var r = e.map.id;e.error ? e.emit("error", e.error) : (t[r] = !0, each(e.depMaps, function (r, n) {
          var o = r.id,
              a = getOwn(S, o);!a || e.depMatched[n] || i[o] || (getOwn(t, o) ? (e.defineDep(n, j[o]), e.check()) : f(a, t, i));
        }), i[r] = !0);
      }function l() {
        var e,
            t,
            i = 1e3 * y.waitSeconds,
            o = i && q.startTime + i < new Date().getTime(),
            a = [],
            s = [],
            u = !1,
            d = !0;if (!x) {
          if (x = !0, eachProp(k, function (e) {
            var i = e.map,
                c = i.id;if (e.enabled && (i.isDefine || s.push(e), !e.error)) if (!e.inited && o) n(c) ? (t = !0, u = !0) : (a.push(c), r(c));else if (!e.inited && e.fetched && i.isDefine && (u = !0, !i.prefix)) return d = !1;
          }), o && a.length) return e = makeError("timeout", "Load timeout for modules: " + a, null, a), e.contextName = q.contextName, c(e);d && each(s, function (e) {
            f(e, {}, {});
          }), o && !t || !u || !isBrowser && !isWebWorker || w || (w = setTimeout(function () {
            w = 0, l();
          }, 50)), x = !1;
        }
      }function h(e) {
        hasProp(j, e[0]) || s(a(e[0], null, !0)).init(e[1], e[2]);
      }function m(e, t, i, r) {
        e.detachEvent && !isOpera ? r && e.detachEvent(r, t) : e.removeEventListener(i, t, !1);
      }function g(e) {
        var t = e.currentTarget || e.srcElement;return m(t, q.onScriptLoad, "load", "onreadystatechange"), m(t, q.onScriptError, "error"), { node: t, id: t && t.getAttribute("data-requiremodule") };
      }function v() {
        var e;for (d(); O.length;) {
          if (e = O.shift(), null === e[0]) return c(makeError("mismatch", "Mismatched anonymous define() module: " + e[e.length - 1]));h(e);
        }q.defQueueMap = {};
      }var x,
          b,
          q,
          E,
          w,
          y = { waitSeconds: 7, baseUrl: "./", paths: {}, bundles: {}, pkgs: {}, shim: {}, config: {} },
          S = {},
          k = {},
          M = {},
          O = [],
          j = {},
          P = {},
          R = {},
          T = 1,
          A = 1;return E = { require: function require(e) {
          return e.require ? e.require : e.require = q.makeRequire(e.map);
        }, exports: function exports(e) {
          if (e.usingExports = !0, e.map.isDefine) return e.exports ? j[e.map.id] = e.exports : e.exports = j[e.map.id] = {};
        }, module: function module(e) {
          return e.module ? e.module : e.module = { id: e.map.id, uri: e.map.url, config: function config() {
              return getOwn(y.config, e.map.id) || {};
            }, exports: e.exports || (e.exports = {}) };
        } }, b = function b(e) {
        this.events = getOwn(M, e.id) || {}, this.map = e, this.shim = getOwn(y.shim, e.id), this.depExports = [], this.depMaps = [], this.depMatched = [], this.pluginMaps = {}, this.depCount = 0;
      }, b.prototype = { init: function init(e, t, i, r) {
          r = r || {}, this.inited || (this.factory = t, i ? this.on("error", i) : this.events.error && (i = bind(this, function (e) {
            this.emit("error", e);
          })), this.depMaps = e && e.slice(0), this.errback = i, this.inited = !0, this.ignore = r.ignore, r.enabled || this.enabled ? this.enable() : this.check());
        }, defineDep: function defineDep(e, t) {
          this.depMatched[e] || (this.depMatched[e] = !0, this.depCount -= 1, this.depExports[e] = t);
        }, fetch: function fetch() {
          if (!this.fetched) {
            this.fetched = !0, q.startTime = new Date().getTime();var e = this.map;return this.shim ? void q.makeRequire(this.map, { enableBuildCallback: !0 })(this.shim.deps || [], bind(this, function () {
              return e.prefix ? this.callPlugin() : this.load();
            })) : e.prefix ? this.callPlugin() : this.load();
          }
        }, load: function load() {
          var e = this.map.url;P[e] || (P[e] = !0, q.load(this.map.id, e));
        }, check: function check() {
          if (this.enabled && !this.enabling) {
            var e,
                t,
                i = this.map.id,
                r = this.depExports,
                n = this.exports,
                o = this.factory;if (this.inited) {
              if (this.error) this.emit("error", this.error);else if (!this.defining) {
                if (this.defining = !0, this.depCount < 1 && !this.defined) {
                  if (isFunction(o)) {
                    if (this.events.error && this.map.isDefine || req.onError !== defaultOnError) try {
                      n = q.execCb(i, o, r, n);
                    } catch (t) {
                      e = t;
                    } else n = q.execCb(i, o, r, n);if (this.map.isDefine && void 0 === n && (t = this.module, t ? n = t.exports : this.usingExports && (n = this.exports)), e) return e.requireMap = this.map, e.requireModules = this.map.isDefine ? [this.map.id] : null, e.requireType = this.map.isDefine ? "define" : "require", c(this.error = e);
                  } else n = o;if (this.exports = n, this.map.isDefine && !this.ignore && (j[i] = n, req.onResourceLoad)) {
                    var a = [];each(this.depMaps, function (e) {
                      a.push(e.normalizedMap || e);
                    }), req.onResourceLoad(q, this.map, a);
                  }p(i), this.defined = !0;
                }this.defining = !1, this.defined && !this.defineEmitted && (this.defineEmitted = !0, this.emit("defined", this.exports), this.defineEmitComplete = !0);
              }
            } else hasProp(q.defQueueMap, i) || this.fetch();
          }
        }, callPlugin: function callPlugin() {
          var e = this.map,
              t = e.id,
              r = a(e.prefix);this.depMaps.push(r), u(r, "defined", bind(this, function (r) {
            var n,
                o,
                d,
                f = getOwn(R, this.map.id),
                l = this.map.name,
                h = this.map.parentMap ? this.map.parentMap.name : null,
                m = q.makeRequire(e.parentMap, { enableBuildCallback: !0 });return this.map.unnormalized ? (r.normalize && (l = r.normalize(l, function (e) {
              return i(e, h, !0);
            }) || ""), o = a(e.prefix + "!" + l, this.map.parentMap, !0), u(o, "defined", bind(this, function (e) {
              this.map.normalizedMap = o, this.init([], function () {
                return e;
              }, null, { enabled: !0, ignore: !0 });
            })), d = getOwn(S, o.id), void (d && (this.depMaps.push(o), this.events.error && d.on("error", bind(this, function (e) {
              this.emit("error", e);
            })), d.enable()))) : f ? (this.map.url = q.nameToUrl(f), void this.load()) : (n = bind(this, function (e) {
              this.init([], function () {
                return e;
              }, null, { enabled: !0 });
            }), n.error = bind(this, function (e) {
              this.inited = !0, this.error = e, e.requireModules = [t], eachProp(S, function (e) {
                0 === e.map.id.indexOf(t + "_unnormalized") && p(e.map.id);
              }), c(e);
            }), n.fromText = bind(this, function (i, r) {
              var o = e.name,
                  u = a(o),
                  d = useInteractive;r && (i = r), d && (useInteractive = !1), s(u), hasProp(y.config, t) && (y.config[o] = y.config[t]);try {
                req.exec(i);
              } catch (e) {
                return c(makeError("fromtexteval", "fromText eval for " + t + " failed: " + e, e, [t]));
              }d && (useInteractive = !0), this.depMaps.push(u), q.completeLoad(o), m([o], n);
            }), void r.load(e.name, m, n, y));
          })), q.enable(r, this), this.pluginMaps[r.id] = r;
        }, enable: function enable() {
          k[this.map.id] = this, this.enabled = !0, this.enabling = !0, each(this.depMaps, bind(this, function (e, t) {
            var i, r, n;if ("string" == typeof e) {
              if (e = a(e, this.map.isDefine ? this.map : this.map.parentMap, !1, !this.skipMap), this.depMaps[t] = e, n = getOwn(E, e.id)) return void (this.depExports[t] = n(this));this.depCount += 1, u(e, "defined", bind(this, function (e) {
                this.undefed || (this.defineDep(t, e), this.check());
              })), this.errback ? u(e, "error", bind(this, this.errback)) : this.events.error && u(e, "error", bind(this, function (e) {
                this.emit("error", e);
              }));
            }i = e.id, r = S[i], hasProp(E, i) || !r || r.enabled || q.enable(e, this);
          })), eachProp(this.pluginMaps, bind(this, function (e) {
            var t = getOwn(S, e.id);t && !t.enabled && q.enable(e, this);
          })), this.enabling = !1, this.check();
        }, on: function on(e, t) {
          var i = this.events[e];i || (i = this.events[e] = []), i.push(t);
        }, emit: function emit(e, t) {
          each(this.events[e], function (e) {
            e(t);
          }), "error" === e && delete this.events[e];
        } }, q = { config: y, contextName: e, registry: S, defined: j, urlFetched: P, defQueue: O, defQueueMap: {}, Module: b, makeModuleMap: a, nextTick: req.nextTick, onError: c, configure: function configure(e) {
          if (e.baseUrl && "/" !== e.baseUrl.charAt(e.baseUrl.length - 1) && (e.baseUrl += "/"), "string" == typeof e.urlArgs) {
            var t = e.urlArgs;e.urlArgs = function (e, i) {
              return (i.indexOf("?") === -1 ? "?" : "&") + t;
            };
          }var i = y.shim,
              r = { paths: !0, bundles: !0, config: !0, map: !0 };eachProp(e, function (e, t) {
            r[t] ? (y[t] || (y[t] = {}), mixin(y[t], e, !0, !0)) : y[t] = e;
          }), e.bundles && eachProp(e.bundles, function (e, t) {
            each(e, function (e) {
              e !== t && (R[e] = t);
            });
          }), e.shim && (eachProp(e.shim, function (e, t) {
            isArray(e) && (e = { deps: e }), !e.exports && !e.init || e.exportsFn || (e.exportsFn = q.makeShimExports(e)), i[t] = e;
          }), y.shim = i), e.packages && each(e.packages, function (e) {
            var t, i;e = "string" == typeof e ? { name: e } : e, i = e.name, t = e.location, t && (y.paths[i] = e.location), y.pkgs[i] = e.name + "/" + (e.main || "main").replace(currDirRegExp, "").replace(jsSuffixRegExp, "");
          }), eachProp(S, function (e, t) {
            e.inited || e.map.unnormalized || (e.map = a(t, null, !0));
          }), (e.deps || e.callback) && q.require(e.deps || [], e.callback);
        }, makeShimExports: function makeShimExports(e) {
          function t() {
            var t;return e.init && (t = e.init.apply(global, arguments)), t || e.exports && getGlobal(e.exports);
          }return t;
        }, makeRequire: function makeRequire(t, n) {
          function o(i, r, u) {
            var d, p, f;return n.enableBuildCallback && r && isFunction(r) && (r.__requireJsBuild = !0), "string" == typeof i ? isFunction(r) ? c(makeError("requireargs", "Invalid require call"), u) : t && hasProp(E, i) ? E[i](S[t.id]) : req.get ? req.get(q, i, t, o) : (p = a(i, t, !1, !0), d = p.id, hasProp(j, d) ? j[d] : c(makeError("notloaded", 'Module name "' + d + '" has not been loaded yet for context: ' + e + (t ? "" : ". Use require([])")))) : (v(), q.nextTick(function () {
              v(), f = s(a(null, t)), f.skipMap = n.skipMap, f.init(i, r, u, { enabled: !0 }), l();
            }), o);
          }return n = n || {}, mixin(o, { isBrowser: isBrowser, toUrl: function toUrl(e) {
              var r,
                  n = e.lastIndexOf("."),
                  o = e.split("/")[0],
                  a = "." === o || ".." === o;return n !== -1 && (!a || n > 1) && (r = e.substring(n, e.length), e = e.substring(0, n)), q.nameToUrl(i(e, t && t.id, !0), r, !0);
            }, defined: function defined(e) {
              return hasProp(j, a(e, t, !1, !0).id);
            }, specified: function specified(e) {
              return e = a(e, t, !1, !0).id, hasProp(j, e) || hasProp(S, e);
            } }), t || (o.undef = function (e) {
            d();var i = a(e, t, !0),
                n = getOwn(S, e);n.undefed = !0, r(e), delete j[e], delete P[i.url], delete M[e], eachReverse(O, function (t, i) {
              t[0] === e && O.splice(i, 1);
            }), delete q.defQueueMap[e], n && (n.events.defined && (M[e] = n.events), p(e));
          }), o;
        }, enable: function enable(e) {
          var t = getOwn(S, e.id);t && s(e).enable();
        }, completeLoad: function completeLoad(e) {
          var t,
              i,
              r,
              o = getOwn(y.shim, e) || {},
              a = o.exports;for (d(); O.length;) {
            if (i = O.shift(), null === i[0]) {
              if (i[0] = e, t) break;t = !0;
            } else i[0] === e && (t = !0);h(i);
          }if (q.defQueueMap = {}, r = getOwn(S, e), !t && !hasProp(j, e) && r && !r.inited) {
            if (!(!y.enforceDefine || a && getGlobal(a))) return n(e) ? void 0 : c(makeError("nodefine", "No define call for " + e, null, [e]));h([e, o.deps || [], o.exportsFn]);
          }l();
        }, nameToUrl: function nameToUrl(e, t, i) {
          var r,
              n,
              o,
              a,
              s,
              u,
              c,
              d = getOwn(y.pkgs, e);if (d && (e = d), c = getOwn(R, e)) return q.nameToUrl(c, t, i);if (req.jsExtRegExp.test(e)) s = e + (t || "");else {
            for (r = y.paths, n = e.split("/"), o = n.length; o > 0; o -= 1) {
              if (a = n.slice(0, o).join("/"), u = getOwn(r, a)) {
                isArray(u) && (u = u[0]), n.splice(0, o, u);break;
              }
            }s = n.join("/"), s += t || (/^data\:|^blob\:|\?/.test(s) || i ? "" : ".js"), s = ("/" === s.charAt(0) || s.match(/^[\w\+\.\-]+:/) ? "" : y.baseUrl) + s;
          }return y.urlArgs && !/^blob\:/.test(s) ? s + y.urlArgs(e, s) : s;
        }, load: function load(e, t) {
          req.load(q, e, t);
        }, execCb: function execCb(e, t, i, r) {
          return t.apply(r, i);
        }, onScriptLoad: function onScriptLoad(e) {
          if ("load" === e.type || readyRegExp.test((e.currentTarget || e.srcElement).readyState)) {
            interactiveScript = null;var t = g(e);q.completeLoad(t.id);
          }
        }, onScriptError: function onScriptError(e) {
          var t = g(e);if (!n(t.id)) {
            var i = [];return eachProp(S, function (e, r) {
              0 !== r.indexOf("_@r") && each(e.depMaps, function (e) {
                if (e.id === t.id) return i.push(r), !0;
              });
            }), c(makeError("scripterror", 'Script error for "' + t.id + (i.length ? '", needed by: ' + i.join(", ") : '"'), e, [t.id]));
          }
        } }, q.require = q.makeRequire(), q;
    }function getInteractiveScript() {
      return interactiveScript && "interactive" === interactiveScript.readyState ? interactiveScript : (eachReverse(scripts(), function (e) {
        if ("interactive" === e.readyState) return interactiveScript = e;
      }), interactiveScript);
    }var req,
        s,
        head,
        baseElement,
        dataMain,
        src,
        interactiveScript,
        currentlyAddingScript,
        mainScript,
        subPath,
        version = "2.3.3",
        commentRegExp = /\/\*[\s\S]*?\*\/|([^:"'=]|^)\/\/.*$/gm,
        cjsRequireRegExp = /[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,
        jsSuffixRegExp = /\.js$/,
        currDirRegExp = /^\.\//,
        op = Object.prototype,
        ostring = op.toString,
        hasOwn = op.hasOwnProperty,
        isBrowser = !("undefined" == typeof window || "undefined" == typeof navigator || !window.document),
        isWebWorker = !isBrowser && "undefined" != typeof importScripts,
        readyRegExp = isBrowser && "PLAYSTATION 3" === navigator.platform ? /^complete$/ : /^(complete|loaded)$/,
        defContextName = "_",
        isOpera = "undefined" != typeof opera && "[object Opera]" === opera.toString(),
        contexts = {},
        cfg = {},
        globalDefQueue = [],
        useInteractive = !1;if ("undefined" == typeof define) {
      if ("undefined" != typeof requirejs) {
        if (isFunction(requirejs)) return;cfg = requirejs, requirejs = void 0;
      }"undefined" == typeof require || isFunction(require) || (cfg = require, require = void 0), req = requirejs = function requirejs(e, t, i, r) {
        var n,
            o,
            a = defContextName;return isArray(e) || "string" == typeof e || (o = e, isArray(t) ? (e = t, t = i, i = r) : e = []), o && o.context && (a = o.context), n = getOwn(contexts, a), n || (n = contexts[a] = req.s.newContext(a)), o && n.configure(o), n.require(e, t, i);
      }, req.config = function (e) {
        return req(e);
      }, req.nextTick = "undefined" != typeof setTimeout ? function (e) {
        setTimeout(e, 4);
      } : function (e) {
        e();
      }, require || (require = req), req.version = version, req.jsExtRegExp = /^\/|:|\?|\.js$/, req.isBrowser = isBrowser, s = req.s = { contexts: contexts, newContext: newContext }, req({}), each(["toUrl", "undef", "defined", "specified"], function (e) {
        req[e] = function () {
          var t = contexts[defContextName];return t.require[e].apply(t, arguments);
        };
      }), isBrowser && (head = s.head = document.getElementsByTagName("head")[0], baseElement = document.getElementsByTagName("base")[0], baseElement && (head = s.head = baseElement.parentNode)), req.onError = defaultOnError, req.createNode = function (e, t, i) {
        var r = e.xhtml ? document.createElementNS("http://www.w3.org/1999/xhtml", "html:script") : document.createElement("script");return r.type = e.scriptType || "text/javascript", r.charset = "utf-8", r.async = !0, r;
      }, req.load = function (e, t, i) {
        var r,
            n = e && e.config || {};if (isBrowser) return r = req.createNode(n, t, i), r.setAttribute("data-requirecontext", e.contextName), r.setAttribute("data-requiremodule", t), !r.attachEvent || r.attachEvent.toString && r.attachEvent.toString().indexOf("[native code") < 0 || isOpera ? (r.addEventListener("load", e.onScriptLoad, !1), r.addEventListener("error", e.onScriptError, !1)) : (useInteractive = !0, r.attachEvent("onreadystatechange", e.onScriptLoad)), r.src = i, n.onNodeCreated && n.onNodeCreated(r, n, t, i), currentlyAddingScript = r, baseElement ? head.insertBefore(r, baseElement) : head.appendChild(r), currentlyAddingScript = null, r;if (isWebWorker) try {
          setTimeout(function () {}, 0), importScripts(i), e.completeLoad(t);
        } catch (r) {
          e.onError(makeError("importscripts", "importScripts failed for " + t + " at " + i, r, [t]));
        }
      }, isBrowser && !cfg.skipDataMain && eachReverse(scripts(), function (e) {
        if (head || (head = e.parentNode), dataMain = e.getAttribute("data-main")) return mainScript = dataMain, cfg.baseUrl || mainScript.indexOf("!") !== -1 || (src = mainScript.split("/"), mainScript = src.pop(), subPath = src.length ? src.join("/") + "/" : "./", cfg.baseUrl = subPath), mainScript = mainScript.replace(jsSuffixRegExp, ""), req.jsExtRegExp.test(mainScript) && (mainScript = dataMain), cfg.deps = cfg.deps ? cfg.deps.concat(mainScript) : [mainScript], !0;
      }), define = function define(e, t, i) {
        var r, n;"string" != typeof e && (i = t, t = e, e = null), isArray(t) || (i = t, t = null), !t && isFunction(i) && (t = [], i.length && (i.toString().replace(commentRegExp, commentReplace).replace(cjsRequireRegExp, function (e, i) {
          t.push(i);
        }), t = (1 === i.length ? ["require"] : ["require", "exports", "module"]).concat(t))), useInteractive && (r = currentlyAddingScript || getInteractiveScript(), r && (e || (e = r.getAttribute("data-requiremodule")), n = contexts[r.getAttribute("data-requirecontext")])), n ? (n.defQueue.push([e, t, i]), n.defQueueMap[e] = !0) : globalDefQueue.push([e, t, i]);
      }, define.amd = { jQuery: !0 }, req.exec = function (text) {
        return eval(text);
      }, req(cfg);
    }
  }(this, "undefined" == typeof setTimeout ? void 0 : setTimeout);
  ;browserify_shim__define__module__export__(typeof require != "undefined" ? require : window.require);
}).call(global, undefined, undefined, undefined, undefined, function defineExport(ex) {
  module.exports = ex;
});

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],2:[function(require,module,exports){
// Copyright Joyent, Inc. and other Node contributors.
//
// Permission is hereby granted, free of charge, to any person obtaining a
// copy of this software and associated documentation files (the
// "Software"), to deal in the Software without restriction, including
// without limitation the rights to use, copy, modify, merge, publish,
// distribute, sublicense, and/or sell copies of the Software, and to permit
// persons to whom the Software is furnished to do so, subject to the
// following conditions:
//
// The above copyright notice and this permission notice shall be included
// in all copies or substantial portions of the Software.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS
// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN
// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE
// USE OR OTHER DEALINGS IN THE SOFTWARE.

function EventEmitter() {
  this._events = this._events || {};
  this._maxListeners = this._maxListeners || undefined;
}
module.exports = EventEmitter;

// Backwards-compat with node 0.10.x
EventEmitter.EventEmitter = EventEmitter;

EventEmitter.prototype._events = undefined;
EventEmitter.prototype._maxListeners = undefined;

// By default EventEmitters will print a warning if more than 10 listeners are
// added to it. This is a useful default which helps finding memory leaks.
EventEmitter.defaultMaxListeners = 10;

// Obviously not all Emitters should be limited to 10. This function allows
// that to be increased. Set to zero for unlimited.
EventEmitter.prototype.setMaxListeners = function(n) {
  if (!isNumber(n) || n < 0 || isNaN(n))
    throw TypeError('n must be a positive number');
  this._maxListeners = n;
  return this;
};

EventEmitter.prototype.emit = function(type) {
  var er, handler, len, args, i, listeners;

  if (!this._events)
    this._events = {};

  // If there is no 'error' event listener then throw.
  if (type === 'error') {
    if (!this._events.error ||
        (isObject(this._events.error) && !this._events.error.length)) {
      er = arguments[1];
      if (er instanceof Error) {
        throw er; // Unhandled 'error' event
      } else {
        // At least give some kind of context to the user
        var err = new Error('Uncaught, unspecified "error" event. (' + er + ')');
        err.context = er;
        throw err;
      }
    }
  }

  handler = this._events[type];

  if (isUndefined(handler))
    return false;

  if (isFunction(handler)) {
    switch (arguments.length) {
      // fast cases
      case 1:
        handler.call(this);
        break;
      case 2:
        handler.call(this, arguments[1]);
        break;
      case 3:
        handler.call(this, arguments[1], arguments[2]);
        break;
      // slower
      default:
        args = Array.prototype.slice.call(arguments, 1);
        handler.apply(this, args);
    }
  } else if (isObject(handler)) {
    args = Array.prototype.slice.call(arguments, 1);
    listeners = handler.slice();
    len = listeners.length;
    for (i = 0; i < len; i++)
      listeners[i].apply(this, args);
  }

  return true;
};

EventEmitter.prototype.addListener = function(type, listener) {
  var m;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events)
    this._events = {};

  // To avoid recursion in the case that type === "newListener"! Before
  // adding it to the listeners, first emit "newListener".
  if (this._events.newListener)
    this.emit('newListener', type,
              isFunction(listener.listener) ?
              listener.listener : listener);

  if (!this._events[type])
    // Optimize the case of one listener. Don't need the extra array object.
    this._events[type] = listener;
  else if (isObject(this._events[type]))
    // If we've already got an array, just append.
    this._events[type].push(listener);
  else
    // Adding the second element, need to change to array.
    this._events[type] = [this._events[type], listener];

  // Check for listener leak
  if (isObject(this._events[type]) && !this._events[type].warned) {
    if (!isUndefined(this._maxListeners)) {
      m = this._maxListeners;
    } else {
      m = EventEmitter.defaultMaxListeners;
    }

    if (m && m > 0 && this._events[type].length > m) {
      this._events[type].warned = true;
      console.error('(node) warning: possible EventEmitter memory ' +
                    'leak detected. %d listeners added. ' +
                    'Use emitter.setMaxListeners() to increase limit.',
                    this._events[type].length);
      if (typeof console.trace === 'function') {
        // not supported in IE 10
        console.trace();
      }
    }
  }

  return this;
};

EventEmitter.prototype.on = EventEmitter.prototype.addListener;

EventEmitter.prototype.once = function(type, listener) {
  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  var fired = false;

  function g() {
    this.removeListener(type, g);

    if (!fired) {
      fired = true;
      listener.apply(this, arguments);
    }
  }

  g.listener = listener;
  this.on(type, g);

  return this;
};

// emits a 'removeListener' event iff the listener was removed
EventEmitter.prototype.removeListener = function(type, listener) {
  var list, position, length, i;

  if (!isFunction(listener))
    throw TypeError('listener must be a function');

  if (!this._events || !this._events[type])
    return this;

  list = this._events[type];
  length = list.length;
  position = -1;

  if (list === listener ||
      (isFunction(list.listener) && list.listener === listener)) {
    delete this._events[type];
    if (this._events.removeListener)
      this.emit('removeListener', type, listener);

  } else if (isObject(list)) {
    for (i = length; i-- > 0;) {
      if (list[i] === listener ||
          (list[i].listener && list[i].listener === listener)) {
        position = i;
        break;
      }
    }

    if (position < 0)
      return this;

    if (list.length === 1) {
      list.length = 0;
      delete this._events[type];
    } else {
      list.splice(position, 1);
    }

    if (this._events.removeListener)
      this.emit('removeListener', type, listener);
  }

  return this;
};

EventEmitter.prototype.removeAllListeners = function(type) {
  var key, listeners;

  if (!this._events)
    return this;

  // not listening for removeListener, no need to emit
  if (!this._events.removeListener) {
    if (arguments.length === 0)
      this._events = {};
    else if (this._events[type])
      delete this._events[type];
    return this;
  }

  // emit removeListener for all listeners on all events
  if (arguments.length === 0) {
    for (key in this._events) {
      if (key === 'removeListener') continue;
      this.removeAllListeners(key);
    }
    this.removeAllListeners('removeListener');
    this._events = {};
    return this;
  }

  listeners = this._events[type];

  if (isFunction(listeners)) {
    this.removeListener(type, listeners);
  } else if (listeners) {
    // LIFO order
    while (listeners.length)
      this.removeListener(type, listeners[listeners.length - 1]);
  }
  delete this._events[type];

  return this;
};

EventEmitter.prototype.listeners = function(type) {
  var ret;
  if (!this._events || !this._events[type])
    ret = [];
  else if (isFunction(this._events[type]))
    ret = [this._events[type]];
  else
    ret = this._events[type].slice();
  return ret;
};

EventEmitter.prototype.listenerCount = function(type) {
  if (this._events) {
    var evlistener = this._events[type];

    if (isFunction(evlistener))
      return 1;
    else if (evlistener)
      return evlistener.length;
  }
  return 0;
};

EventEmitter.listenerCount = function(emitter, type) {
  return emitter.listenerCount(type);
};

function isFunction(arg) {
  return typeof arg === 'function';
}

function isNumber(arg) {
  return typeof arg === 'number';
}

function isObject(arg) {
  return typeof arg === 'object' && arg !== null;
}

function isUndefined(arg) {
  return arg === void 0;
}

},{}],3:[function(require,module,exports){
(function (global){(function (){
(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :
    typeof define === 'function' && define.amd ? define(factory) :
    (global.ResizeObserver = factory());
}(this, (function () { 'use strict';

    /**
     * A collection of shims that provide minimal functionality of the ES6 collections.
     *
     * These implementations are not meant to be used outside of the ResizeObserver
     * modules as they cover only a limited range of use cases.
     */
    /* eslint-disable require-jsdoc, valid-jsdoc */
    var MapShim = (function () {
        if (typeof Map !== 'undefined') {
            return Map;
        }
        /**
         * Returns index in provided array that matches the specified key.
         *
         * @param {Array<Array>} arr
         * @param {*} key
         * @returns {number}
         */
        function getIndex(arr, key) {
            var result = -1;
            arr.some(function (entry, index) {
                if (entry[0] === key) {
                    result = index;
                    return true;
                }
                return false;
            });
            return result;
        }
        return /** @class */ (function () {
            function class_1() {
                this.__entries__ = [];
            }
            Object.defineProperty(class_1.prototype, "size", {
                /**
                 * @returns {boolean}
                 */
                get: function () {
                    return this.__entries__.length;
                },
                enumerable: true,
                configurable: true
            });
            /**
             * @param {*} key
             * @returns {*}
             */
            class_1.prototype.get = function (key) {
                var index = getIndex(this.__entries__, key);
                var entry = this.__entries__[index];
                return entry && entry[1];
            };
            /**
             * @param {*} key
             * @param {*} value
             * @returns {void}
             */
            class_1.prototype.set = function (key, value) {
                var index = getIndex(this.__entries__, key);
                if (~index) {
                    this.__entries__[index][1] = value;
                }
                else {
                    this.__entries__.push([key, value]);
                }
            };
            /**
             * @param {*} key
             * @returns {void}
             */
            class_1.prototype.delete = function (key) {
                var entries = this.__entries__;
                var index = getIndex(entries, key);
                if (~index) {
                    entries.splice(index, 1);
                }
            };
            /**
             * @param {*} key
             * @returns {void}
             */
            class_1.prototype.has = function (key) {
                return !!~getIndex(this.__entries__, key);
            };
            /**
             * @returns {void}
             */
            class_1.prototype.clear = function () {
                this.__entries__.splice(0);
            };
            /**
             * @param {Function} callback
             * @param {*} [ctx=null]
             * @returns {void}
             */
            class_1.prototype.forEach = function (callback, ctx) {
                if (ctx === void 0) { ctx = null; }
                for (var _i = 0, _a = this.__entries__; _i < _a.length; _i++) {
                    var entry = _a[_i];
                    callback.call(ctx, entry[1], entry[0]);
                }
            };
            return class_1;
        }());
    })();

    /**
     * Detects whether window and document objects are available in current environment.
     */
    var isBrowser = typeof window !== 'undefined' && typeof document !== 'undefined' && window.document === document;

    // Returns global object of a current environment.
    var global$1 = (function () {
        if (typeof global !== 'undefined' && global.Math === Math) {
            return global;
        }
        if (typeof self !== 'undefined' && self.Math === Math) {
            return self;
        }
        if (typeof window !== 'undefined' && window.Math === Math) {
            return window;
        }
        // eslint-disable-next-line no-new-func
        return Function('return this')();
    })();

    /**
     * A shim for the requestAnimationFrame which falls back to the setTimeout if
     * first one is not supported.
     *
     * @returns {number} Requests' identifier.
     */
    var requestAnimationFrame$1 = (function () {
        if (typeof requestAnimationFrame === 'function') {
            // It's required to use a bounded function because IE sometimes throws
            // an "Invalid calling object" error if rAF is invoked without the global
            // object on the left hand side.
            return requestAnimationFrame.bind(global$1);
        }
        return function (callback) { return setTimeout(function () { return callback(Date.now()); }, 1000 / 60); };
    })();

    // Defines minimum timeout before adding a trailing call.
    var trailingTimeout = 2;
    /**
     * Creates a wrapper function which ensures that provided callback will be
     * invoked only once during the specified delay period.
     *
     * @param {Function} callback - Function to be invoked after the delay period.
     * @param {number} delay - Delay after which to invoke callback.
     * @returns {Function}
     */
    function throttle (callback, delay) {
        var leadingCall = false, trailingCall = false, lastCallTime = 0;
        /**
         * Invokes the original callback function and schedules new invocation if
         * the "proxy" was called during current request.
         *
         * @returns {void}
         */
        function resolvePending() {
            if (leadingCall) {
                leadingCall = false;
                callback();
            }
            if (trailingCall) {
                proxy();
            }
        }
        /**
         * Callback invoked after the specified delay. It will further postpone
         * invocation of the original function delegating it to the
         * requestAnimationFrame.
         *
         * @returns {void}
         */
        function timeoutCallback() {
            requestAnimationFrame$1(resolvePending);
        }
        /**
         * Schedules invocation of the original function.
         *
         * @returns {void}
         */
        function proxy() {
            var timeStamp = Date.now();
            if (leadingCall) {
                // Reject immediately following calls.
                if (timeStamp - lastCallTime < trailingTimeout) {
                    return;
                }
                // Schedule new call to be in invoked when the pending one is resolved.
                // This is important for "transitions" which never actually start
                // immediately so there is a chance that we might miss one if change
                // happens amids the pending invocation.
                trailingCall = true;
            }
            else {
                leadingCall = true;
                trailingCall = false;
                setTimeout(timeoutCallback, delay);
            }
            lastCallTime = timeStamp;
        }
        return proxy;
    }

    // Minimum delay before invoking the update of observers.
    var REFRESH_DELAY = 20;
    // A list of substrings of CSS properties used to find transition events that
    // might affect dimensions of observed elements.
    var transitionKeys = ['top', 'right', 'bottom', 'left', 'width', 'height', 'size', 'weight'];
    // Check if MutationObserver is available.
    var mutationObserverSupported = typeof MutationObserver !== 'undefined';
    /**
     * Singleton controller class which handles updates of ResizeObserver instances.
     */
    var ResizeObserverController = /** @class */ (function () {
        /**
         * Creates a new instance of ResizeObserverController.
         *
         * @private
         */
        function ResizeObserverController() {
            /**
             * Indicates whether DOM listeners have been added.
             *
             * @private {boolean}
             */
            this.connected_ = false;
            /**
             * Tells that controller has subscribed for Mutation Events.
             *
             * @private {boolean}
             */
            this.mutationEventsAdded_ = false;
            /**
             * Keeps reference to the instance of MutationObserver.
             *
             * @private {MutationObserver}
             */
            this.mutationsObserver_ = null;
            /**
             * A list of connected observers.
             *
             * @private {Array<ResizeObserverSPI>}
             */
            this.observers_ = [];
            this.onTransitionEnd_ = this.onTransitionEnd_.bind(this);
            this.refresh = throttle(this.refresh.bind(this), REFRESH_DELAY);
        }
        /**
         * Adds observer to observers list.
         *
         * @param {ResizeObserverSPI} observer - Observer to be added.
         * @returns {void}
         */
        ResizeObserverController.prototype.addObserver = function (observer) {
            if (!~this.observers_.indexOf(observer)) {
                this.observers_.push(observer);
            }
            // Add listeners if they haven't been added yet.
            if (!this.connected_) {
                this.connect_();
            }
        };
        /**
         * Removes observer from observers list.
         *
         * @param {ResizeObserverSPI} observer - Observer to be removed.
         * @returns {void}
         */
        ResizeObserverController.prototype.removeObserver = function (observer) {
            var observers = this.observers_;
            var index = observers.indexOf(observer);
            // Remove observer if it's present in registry.
            if (~index) {
                observers.splice(index, 1);
            }
            // Remove listeners if controller has no connected observers.
            if (!observers.length && this.connected_) {
                this.disconnect_();
            }
        };
        /**
         * Invokes the update of observers. It will continue running updates insofar
         * it detects changes.
         *
         * @returns {void}
         */
        ResizeObserverController.prototype.refresh = function () {
            var changesDetected = this.updateObservers_();
            // Continue running updates if changes have been detected as there might
            // be future ones caused by CSS transitions.
            if (changesDetected) {
                this.refresh();
            }
        };
        /**
         * Updates every observer from observers list and notifies them of queued
         * entries.
         *
         * @private
         * @returns {boolean} Returns "true" if any observer has detected changes in
         *      dimensions of it's elements.
         */
        ResizeObserverController.prototype.updateObservers_ = function () {
            // Collect observers that have active observations.
            var activeObservers = this.observers_.filter(function (observer) {
                return observer.gatherActive(), observer.hasActive();
            });
            // Deliver notifications in a separate cycle in order to avoid any
            // collisions between observers, e.g. when multiple instances of
            // ResizeObserver are tracking the same element and the callback of one
            // of them changes content dimensions of the observed target. Sometimes
            // this may result in notifications being blocked for the rest of observers.
            activeObservers.forEach(function (observer) { return observer.broadcastActive(); });
            return activeObservers.length > 0;
        };
        /**
         * Initializes DOM listeners.
         *
         * @private
         * @returns {void}
         */
        ResizeObserverController.prototype.connect_ = function () {
            // Do nothing if running in a non-browser environment or if listeners
            // have been already added.
            if (!isBrowser || this.connected_) {
                return;
            }
            // Subscription to the "Transitionend" event is used as a workaround for
            // delayed transitions. This way it's possible to capture at least the
            // final state of an element.
            document.addEventListener('transitionend', this.onTransitionEnd_);
            window.addEventListener('resize', this.refresh);
            if (mutationObserverSupported) {
                this.mutationsObserver_ = new MutationObserver(this.refresh);
                this.mutationsObserver_.observe(document, {
                    attributes: true,
                    childList: true,
                    characterData: true,
                    subtree: true
                });
            }
            else {
                document.addEventListener('DOMSubtreeModified', this.refresh);
                this.mutationEventsAdded_ = true;
            }
            this.connected_ = true;
        };
        /**
         * Removes DOM listeners.
         *
         * @private
         * @returns {void}
         */
        ResizeObserverController.prototype.disconnect_ = function () {
            // Do nothing if running in a non-browser environment or if listeners
            // have been already removed.
            if (!isBrowser || !this.connected_) {
                return;
            }
            document.removeEventListener('transitionend', this.onTransitionEnd_);
            window.removeEventListener('resize', this.refresh);
            if (this.mutationsObserver_) {
                this.mutationsObserver_.disconnect();
            }
            if (this.mutationEventsAdded_) {
                document.removeEventListener('DOMSubtreeModified', this.refresh);
            }
            this.mutationsObserver_ = null;
            this.mutationEventsAdded_ = false;
            this.connected_ = false;
        };
        /**
         * "Transitionend" event handler.
         *
         * @private
         * @param {TransitionEvent} event
         * @returns {void}
         */
        ResizeObserverController.prototype.onTransitionEnd_ = function (_a) {
            var _b = _a.propertyName, propertyName = _b === void 0 ? '' : _b;
            // Detect whether transition may affect dimensions of an element.
            var isReflowProperty = transitionKeys.some(function (key) {
                return !!~propertyName.indexOf(key);
            });
            if (isReflowProperty) {
                this.refresh();
            }
        };
        /**
         * Returns instance of the ResizeObserverController.
         *
         * @returns {ResizeObserverController}
         */
        ResizeObserverController.getInstance = function () {
            if (!this.instance_) {
                this.instance_ = new ResizeObserverController();
            }
            return this.instance_;
        };
        /**
         * Holds reference to the controller's instance.
         *
         * @private {ResizeObserverController}
         */
        ResizeObserverController.instance_ = null;
        return ResizeObserverController;
    }());

    /**
     * Defines non-writable/enumerable properties of the provided target object.
     *
     * @param {Object} target - Object for which to define properties.
     * @param {Object} props - Properties to be defined.
     * @returns {Object} Target object.
     */
    var defineConfigurable = (function (target, props) {
        for (var _i = 0, _a = Object.keys(props); _i < _a.length; _i++) {
            var key = _a[_i];
            Object.defineProperty(target, key, {
                value: props[key],
                enumerable: false,
                writable: false,
                configurable: true
            });
        }
        return target;
    });

    /**
     * Returns the global object associated with provided element.
     *
     * @param {Object} target
     * @returns {Object}
     */
    var getWindowOf = (function (target) {
        // Assume that the element is an instance of Node, which means that it
        // has the "ownerDocument" property from which we can retrieve a
        // corresponding global object.
        var ownerGlobal = target && target.ownerDocument && target.ownerDocument.defaultView;
        // Return the local global object if it's not possible extract one from
        // provided element.
        return ownerGlobal || global$1;
    });

    // Placeholder of an empty content rectangle.
    var emptyRect = createRectInit(0, 0, 0, 0);
    /**
     * Converts provided string to a number.
     *
     * @param {number|string} value
     * @returns {number}
     */
    function toFloat(value) {
        return parseFloat(value) || 0;
    }
    /**
     * Extracts borders size from provided styles.
     *
     * @param {CSSStyleDeclaration} styles
     * @param {...string} positions - Borders positions (top, right, ...)
     * @returns {number}
     */
    function getBordersSize(styles) {
        var positions = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            positions[_i - 1] = arguments[_i];
        }
        return positions.reduce(function (size, position) {
            var value = styles['border-' + position + '-width'];
            return size + toFloat(value);
        }, 0);
    }
    /**
     * Extracts paddings sizes from provided styles.
     *
     * @param {CSSStyleDeclaration} styles
     * @returns {Object} Paddings box.
     */
    function getPaddings(styles) {
        var positions = ['top', 'right', 'bottom', 'left'];
        var paddings = {};
        for (var _i = 0, positions_1 = positions; _i < positions_1.length; _i++) {
            var position = positions_1[_i];
            var value = styles['padding-' + position];
            paddings[position] = toFloat(value);
        }
        return paddings;
    }
    /**
     * Calculates content rectangle of provided SVG element.
     *
     * @param {SVGGraphicsElement} target - Element content rectangle of which needs
     *      to be calculated.
     * @returns {DOMRectInit}
     */
    function getSVGContentRect(target) {
        var bbox = target.getBBox();
        return createRectInit(0, 0, bbox.width, bbox.height);
    }
    /**
     * Calculates content rectangle of provided HTMLElement.
     *
     * @param {HTMLElement} target - Element for which to calculate the content rectangle.
     * @returns {DOMRectInit}
     */
    function getHTMLElementContentRect(target) {
        // Client width & height properties can't be
        // used exclusively as they provide rounded values.
        var clientWidth = target.clientWidth, clientHeight = target.clientHeight;
        // By this condition we can catch all non-replaced inline, hidden and
        // detached elements. Though elements with width & height properties less
        // than 0.5 will be discarded as well.
        //
        // Without it we would need to implement separate methods for each of
        // those cases and it's not possible to perform a precise and performance
        // effective test for hidden elements. E.g. even jQuery's ':visible' filter
        // gives wrong results for elements with width & height less than 0.5.
        if (!clientWidth && !clientHeight) {
            return emptyRect;
        }
        var styles = getWindowOf(target).getComputedStyle(target);
        var paddings = getPaddings(styles);
        var horizPad = paddings.left + paddings.right;
        var vertPad = paddings.top + paddings.bottom;
        // Computed styles of width & height are being used because they are the
        // only dimensions available to JS that contain non-rounded values. It could
        // be possible to utilize the getBoundingClientRect if only it's data wasn't
        // affected by CSS transformations let alone paddings, borders and scroll bars.
        var width = toFloat(styles.width), height = toFloat(styles.height);
        // Width & height include paddings and borders when the 'border-box' box
        // model is applied (except for IE).
        if (styles.boxSizing === 'border-box') {
            // Following conditions are required to handle Internet Explorer which
            // doesn't include paddings and borders to computed CSS dimensions.
            //
            // We can say that if CSS dimensions + paddings are equal to the "client"
            // properties then it's either IE, and thus we don't need to subtract
            // anything, or an element merely doesn't have paddings/borders styles.
            if (Math.round(width + horizPad) !== clientWidth) {
                width -= getBordersSize(styles, 'left', 'right') + horizPad;
            }
            if (Math.round(height + vertPad) !== clientHeight) {
                height -= getBordersSize(styles, 'top', 'bottom') + vertPad;
            }
        }
        // Following steps can't be applied to the document's root element as its
        // client[Width/Height] properties represent viewport area of the window.
        // Besides, it's as well not necessary as the <html> itself neither has
        // rendered scroll bars nor it can be clipped.
        if (!isDocumentElement(target)) {
            // In some browsers (only in Firefox, actually) CSS width & height
            // include scroll bars size which can be removed at this step as scroll
            // bars are the only difference between rounded dimensions + paddings
            // and "client" properties, though that is not always true in Chrome.
            var vertScrollbar = Math.round(width + horizPad) - clientWidth;
            var horizScrollbar = Math.round(height + vertPad) - clientHeight;
            // Chrome has a rather weird rounding of "client" properties.
            // E.g. for an element with content width of 314.2px it sometimes gives
            // the client width of 315px and for the width of 314.7px it may give
            // 314px. And it doesn't happen all the time. So just ignore this delta
            // as a non-relevant.
            if (Math.abs(vertScrollbar) !== 1) {
                width -= vertScrollbar;
            }
            if (Math.abs(horizScrollbar) !== 1) {
                height -= horizScrollbar;
            }
        }
        return createRectInit(paddings.left, paddings.top, width, height);
    }
    /**
     * Checks whether provided element is an instance of the SVGGraphicsElement.
     *
     * @param {Element} target - Element to be checked.
     * @returns {boolean}
     */
    var isSVGGraphicsElement = (function () {
        // Some browsers, namely IE and Edge, don't have the SVGGraphicsElement
        // interface.
        if (typeof SVGGraphicsElement !== 'undefined') {
            return function (target) { return target instanceof getWindowOf(target).SVGGraphicsElement; };
        }
        // If it's so, then check that element is at least an instance of the
        // SVGElement and that it has the "getBBox" method.
        // eslint-disable-next-line no-extra-parens
        return function (target) { return (target instanceof getWindowOf(target).SVGElement &&
            typeof target.getBBox === 'function'); };
    })();
    /**
     * Checks whether provided element is a document element (<html>).
     *
     * @param {Element} target - Element to be checked.
     * @returns {boolean}
     */
    function isDocumentElement(target) {
        return target === getWindowOf(target).document.documentElement;
    }
    /**
     * Calculates an appropriate content rectangle for provided html or svg element.
     *
     * @param {Element} target - Element content rectangle of which needs to be calculated.
     * @returns {DOMRectInit}
     */
    function getContentRect(target) {
        if (!isBrowser) {
            return emptyRect;
        }
        if (isSVGGraphicsElement(target)) {
            return getSVGContentRect(target);
        }
        return getHTMLElementContentRect(target);
    }
    /**
     * Creates rectangle with an interface of the DOMRectReadOnly.
     * Spec: https://drafts.fxtf.org/geometry/#domrectreadonly
     *
     * @param {DOMRectInit} rectInit - Object with rectangle's x/y coordinates and dimensions.
     * @returns {DOMRectReadOnly}
     */
    function createReadOnlyRect(_a) {
        var x = _a.x, y = _a.y, width = _a.width, height = _a.height;
        // If DOMRectReadOnly is available use it as a prototype for the rectangle.
        var Constr = typeof DOMRectReadOnly !== 'undefined' ? DOMRectReadOnly : Object;
        var rect = Object.create(Constr.prototype);
        // Rectangle's properties are not writable and non-enumerable.
        defineConfigurable(rect, {
            x: x, y: y, width: width, height: height,
            top: y,
            right: x + width,
            bottom: height + y,
            left: x
        });
        return rect;
    }
    /**
     * Creates DOMRectInit object based on the provided dimensions and the x/y coordinates.
     * Spec: https://drafts.fxtf.org/geometry/#dictdef-domrectinit
     *
     * @param {number} x - X coordinate.
     * @param {number} y - Y coordinate.
     * @param {number} width - Rectangle's width.
     * @param {number} height - Rectangle's height.
     * @returns {DOMRectInit}
     */
    function createRectInit(x, y, width, height) {
        return { x: x, y: y, width: width, height: height };
    }

    /**
     * Class that is responsible for computations of the content rectangle of
     * provided DOM element and for keeping track of it's changes.
     */
    var ResizeObservation = /** @class */ (function () {
        /**
         * Creates an instance of ResizeObservation.
         *
         * @param {Element} target - Element to be observed.
         */
        function ResizeObservation(target) {
            /**
             * Broadcasted width of content rectangle.
             *
             * @type {number}
             */
            this.broadcastWidth = 0;
            /**
             * Broadcasted height of content rectangle.
             *
             * @type {number}
             */
            this.broadcastHeight = 0;
            /**
             * Reference to the last observed content rectangle.
             *
             * @private {DOMRectInit}
             */
            this.contentRect_ = createRectInit(0, 0, 0, 0);
            this.target = target;
        }
        /**
         * Updates content rectangle and tells whether it's width or height properties
         * have changed since the last broadcast.
         *
         * @returns {boolean}
         */
        ResizeObservation.prototype.isActive = function () {
            var rect = getContentRect(this.target);
            this.contentRect_ = rect;
            return (rect.width !== this.broadcastWidth ||
                rect.height !== this.broadcastHeight);
        };
        /**
         * Updates 'broadcastWidth' and 'broadcastHeight' properties with a data
         * from the corresponding properties of the last observed content rectangle.
         *
         * @returns {DOMRectInit} Last observed content rectangle.
         */
        ResizeObservation.prototype.broadcastRect = function () {
            var rect = this.contentRect_;
            this.broadcastWidth = rect.width;
            this.broadcastHeight = rect.height;
            return rect;
        };
        return ResizeObservation;
    }());

    var ResizeObserverEntry = /** @class */ (function () {
        /**
         * Creates an instance of ResizeObserverEntry.
         *
         * @param {Element} target - Element that is being observed.
         * @param {DOMRectInit} rectInit - Data of the element's content rectangle.
         */
        function ResizeObserverEntry(target, rectInit) {
            var contentRect = createReadOnlyRect(rectInit);
            // According to the specification following properties are not writable
            // and are also not enumerable in the native implementation.
            //
            // Property accessors are not being used as they'd require to define a
            // private WeakMap storage which may cause memory leaks in browsers that
            // don't support this type of collections.
            defineConfigurable(this, { target: target, contentRect: contentRect });
        }
        return ResizeObserverEntry;
    }());

    var ResizeObserverSPI = /** @class */ (function () {
        /**
         * Creates a new instance of ResizeObserver.
         *
         * @param {ResizeObserverCallback} callback - Callback function that is invoked
         *      when one of the observed elements changes it's content dimensions.
         * @param {ResizeObserverController} controller - Controller instance which
         *      is responsible for the updates of observer.
         * @param {ResizeObserver} callbackCtx - Reference to the public
         *      ResizeObserver instance which will be passed to callback function.
         */
        function ResizeObserverSPI(callback, controller, callbackCtx) {
            /**
             * Collection of resize observations that have detected changes in dimensions
             * of elements.
             *
             * @private {Array<ResizeObservation>}
             */
            this.activeObservations_ = [];
            /**
             * Registry of the ResizeObservation instances.
             *
             * @private {Map<Element, ResizeObservation>}
             */
            this.observations_ = new MapShim();
            if (typeof callback !== 'function') {
                throw new TypeError('The callback provided as parameter 1 is not a function.');
            }
            this.callback_ = callback;
            this.controller_ = controller;
            this.callbackCtx_ = callbackCtx;
        }
        /**
         * Starts observing provided element.
         *
         * @param {Element} target - Element to be observed.
         * @returns {void}
         */
        ResizeObserverSPI.prototype.observe = function (target) {
            if (!arguments.length) {
                throw new TypeError('1 argument required, but only 0 present.');
            }
            // Do nothing if current environment doesn't have the Element interface.
            if (typeof Element === 'undefined' || !(Element instanceof Object)) {
                return;
            }
            if (!(target instanceof getWindowOf(target).Element)) {
                throw new TypeError('parameter 1 is not of type "Element".');
            }
            var observations = this.observations_;
            // Do nothing if element is already being observed.
            if (observations.has(target)) {
                return;
            }
            observations.set(target, new ResizeObservation(target));
            this.controller_.addObserver(this);
            // Force the update of observations.
            this.controller_.refresh();
        };
        /**
         * Stops observing provided element.
         *
         * @param {Element} target - Element to stop observing.
         * @returns {void}
         */
        ResizeObserverSPI.prototype.unobserve = function (target) {
            if (!arguments.length) {
                throw new TypeError('1 argument required, but only 0 present.');
            }
            // Do nothing if current environment doesn't have the Element interface.
            if (typeof Element === 'undefined' || !(Element instanceof Object)) {
                return;
            }
            if (!(target instanceof getWindowOf(target).Element)) {
                throw new TypeError('parameter 1 is not of type "Element".');
            }
            var observations = this.observations_;
            // Do nothing if element is not being observed.
            if (!observations.has(target)) {
                return;
            }
            observations.delete(target);
            if (!observations.size) {
                this.controller_.removeObserver(this);
            }
        };
        /**
         * Stops observing all elements.
         *
         * @returns {void}
         */
        ResizeObserverSPI.prototype.disconnect = function () {
            this.clearActive();
            this.observations_.clear();
            this.controller_.removeObserver(this);
        };
        /**
         * Collects observation instances the associated element of which has changed
         * it's content rectangle.
         *
         * @returns {void}
         */
        ResizeObserverSPI.prototype.gatherActive = function () {
            var _this = this;
            this.clearActive();
            this.observations_.forEach(function (observation) {
                if (observation.isActive()) {
                    _this.activeObservations_.push(observation);
                }
            });
        };
        /**
         * Invokes initial callback function with a list of ResizeObserverEntry
         * instances collected from active resize observations.
         *
         * @returns {void}
         */
        ResizeObserverSPI.prototype.broadcastActive = function () {
            // Do nothing if observer doesn't have active observations.
            if (!this.hasActive()) {
                return;
            }
            var ctx = this.callbackCtx_;
            // Create ResizeObserverEntry instance for every active observation.
            var entries = this.activeObservations_.map(function (observation) {
                return new ResizeObserverEntry(observation.target, observation.broadcastRect());
            });
            this.callback_.call(ctx, entries, ctx);
            this.clearActive();
        };
        /**
         * Clears the collection of active observations.
         *
         * @returns {void}
         */
        ResizeObserverSPI.prototype.clearActive = function () {
            this.activeObservations_.splice(0);
        };
        /**
         * Tells whether observer has active observations.
         *
         * @returns {boolean}
         */
        ResizeObserverSPI.prototype.hasActive = function () {
            return this.activeObservations_.length > 0;
        };
        return ResizeObserverSPI;
    }());

    // Registry of internal observers. If WeakMap is not available use current shim
    // for the Map collection as it has all required methods and because WeakMap
    // can't be fully polyfilled anyway.
    var observers = typeof WeakMap !== 'undefined' ? new WeakMap() : new MapShim();
    /**
     * ResizeObserver API. Encapsulates the ResizeObserver SPI implementation
     * exposing only those methods and properties that are defined in the spec.
     */
    var ResizeObserver = /** @class */ (function () {
        /**
         * Creates a new instance of ResizeObserver.
         *
         * @param {ResizeObserverCallback} callback - Callback that is invoked when
         *      dimensions of the observed elements change.
         */
        function ResizeObserver(callback) {
            if (!(this instanceof ResizeObserver)) {
                throw new TypeError('Cannot call a class as a function.');
            }
            if (!arguments.length) {
                throw new TypeError('1 argument required, but only 0 present.');
            }
            var controller = ResizeObserverController.getInstance();
            var observer = new ResizeObserverSPI(callback, controller, this);
            observers.set(this, observer);
        }
        return ResizeObserver;
    }());
    // Expose public methods of ResizeObserver.
    [
        'observe',
        'unobserve',
        'disconnect'
    ].forEach(function (method) {
        ResizeObserver.prototype[method] = function () {
            var _a;
            return (_a = observers.get(this))[method].apply(_a, arguments);
        };
    });

    var index = (function () {
        // Export existing implementation if available.
        if (typeof global$1.ResizeObserver !== 'undefined') {
            return global$1.ResizeObserver;
        }
        return ResizeObserver;
    })();

    return index;

})));

}).call(this)}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})
},{}],4:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTAd;

  VASTAd = (function() {
    function VASTAd() {
      this.id = null;
      this.sequence = null;
      this.system = null;
      this.title = null;
      this.description = null;
      this.advertiser = null;
      this.pricing = null;
      this.survey = null;
      this.errorURLTemplates = [];
      this.impressionURLTemplates = [];
      this.creatives = [];
      this.extensions = [];
    }

    return VASTAd;

  })();

  module.exports = VASTAd;

}).call(this);

},{}],5:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTClient, VASTParser, VASTUtil;

  VASTParser = require('./parser');

  VASTUtil = require('./util');

  VASTClient = (function() {
    function VASTClient() {}

    VASTClient.cappingFreeLunch = 0;

    VASTClient.cappingMinimumTimeInterval = 0;

    VASTClient.options = {
      withCredentials: false,
      timeout: 0
    };

    VASTClient.get = function(url, opts, cb) {
      var extend, now, options, timeSinceLastCall;
      now = +new Date();
      extend = exports.extend = function(object, properties) {
        var key, val;
        for (key in properties) {
          val = properties[key];
          object[key] = val;
        }
        return object;
      };
      if (!cb) {
        if (typeof opts === 'function') {
          cb = opts;
        }
        options = {};
      }
      options = extend(this.options, opts);
      if (this.totalCallsTimeout < now) {
        this.totalCalls = 1;
        this.totalCallsTimeout = now + (60 * 60 * 1000);
      } else {
        this.totalCalls++;
      }
      if (this.cappingFreeLunch >= this.totalCalls) {
        cb(null, new Error("VAST call canceled  FreeLunch capping not reached yet " + this.totalCalls + "/" + this.cappingFreeLunch));
        return;
      }
      timeSinceLastCall = now - this.lastSuccessfullAd;
      if (timeSinceLastCall < 0) {
        this.lastSuccessfullAd = 0;
      } else if (timeSinceLastCall < this.cappingMinimumTimeInterval) {
        cb(null, new Error("VAST call canceled  (" + this.cappingMinimumTimeInterval + ")ms minimum interval reached"));
        return;
      }
      return VASTParser.parse(url, options, (function(_this) {
        return function(response, err) {
          return cb(response, err);
        };
      })(this));
    };

    (function() {
      var defineProperty, storage;
      storage = VASTUtil.storage;
      defineProperty = Object.defineProperty;
      ['lastSuccessfullAd', 'totalCalls', 'totalCallsTimeout'].forEach(function(property) {
        defineProperty(VASTClient, property, {
          get: function() {
            return storage.getItem(property);
          },
          set: function(value) {
            return storage.setItem(property, value);
          },
          configurable: false,
          enumerable: true
        });
      });
      if (VASTClient.lastSuccessfullAd == null) {
        VASTClient.lastSuccessfullAd = 0;
      }
      if (VASTClient.totalCalls == null) {
        VASTClient.totalCalls = 0;
      }
      if (VASTClient.totalCallsTimeout == null) {
        VASTClient.totalCallsTimeout = 0;
      }
    })();

    return VASTClient;

  })();

  module.exports = VASTClient;

}).call(this);

},{"./parser":14,"./util":20}],6:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTCompanionAd;

  VASTCompanionAd = (function() {
    function VASTCompanionAd() {
      this.id = null;
      this.width = 0;
      this.height = 0;
      this.type = null;
      this.staticResource = null;
      this.htmlResource = null;
      this.iframeResource = null;
      this.altText = null;
      this.companionClickThroughURLTemplate = null;
      this.companionClickTrackingURLTemplates = [];
      this.trackingEvents = {};
    }

    return VASTCompanionAd;

  })();

  module.exports = VASTCompanionAd;

}).call(this);

},{}],7:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTCreative, VASTCreativeCompanion, VASTCreativeLinear, VASTCreativeNonLinear,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  VASTCreative = (function() {
    function VASTCreative(creativeAttributes) {
      if (creativeAttributes == null) {
        creativeAttributes = {};
      }
      this.id = creativeAttributes.id || null;
      this.adId = creativeAttributes.adId || null;
      this.sequence = creativeAttributes.sequence || null;
      this.apiFramework = creativeAttributes.apiFramework || null;
      this.trackingEvents = {};
    }

    return VASTCreative;

  })();

  VASTCreativeLinear = (function(superClass) {
    extend(VASTCreativeLinear, superClass);

    function VASTCreativeLinear() {
      VASTCreativeLinear.__super__.constructor.apply(this, arguments);
      this.type = "linear";
      this.duration = 0;
      this.skipDelay = null;
      this.mediaFiles = [];
      this.videoClickThroughURLTemplate = null;
      this.videoClickTrackingURLTemplates = [];
      this.videoCustomClickURLTemplates = [];
      this.adParameters = null;
      this.icons = [];
    }

    return VASTCreativeLinear;

  })(VASTCreative);

  VASTCreativeNonLinear = (function(superClass) {
    extend(VASTCreativeNonLinear, superClass);

    function VASTCreativeNonLinear() {
      VASTCreativeNonLinear.__super__.constructor.apply(this, arguments);
      this.type = "nonlinear";
      this.variations = [];
    }

    return VASTCreativeNonLinear;

  })(VASTCreative);

  VASTCreativeCompanion = (function(superClass) {
    extend(VASTCreativeCompanion, superClass);

    function VASTCreativeCompanion() {
      VASTCreativeCompanion.__super__.constructor.apply(this, arguments);
      this.type = "companion";
      this.variations = [];
    }

    return VASTCreativeCompanion;

  })(VASTCreative);

  module.exports = {
    VASTCreativeLinear: VASTCreativeLinear,
    VASTCreativeNonLinear: VASTCreativeNonLinear,
    VASTCreativeCompanion: VASTCreativeCompanion
  };

}).call(this);

},{}],8:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTAdExtension;

  VASTAdExtension = (function() {
    function VASTAdExtension() {
      this.attributes = {};
      this.children = [];
    }

    return VASTAdExtension;

  })();

  module.exports = VASTAdExtension;

}).call(this);

},{}],9:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTAdExtensionChild;

  VASTAdExtensionChild = (function() {
    function VASTAdExtensionChild() {
      this.name = null;
      this.value = null;
      this.attributes = {};
    }

    return VASTAdExtensionChild;

  })();

  module.exports = VASTAdExtensionChild;

}).call(this);

},{}],10:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTIcon;

  VASTIcon = (function() {
    function VASTIcon() {
      this.program = null;
      this.height = 0;
      this.width = 0;
      this.xPosition = 0;
      this.yPosition = 0;
      this.apiFramework = null;
      this.offset = null;
      this.duration = 0;
      this.type = null;
      this.staticResource = null;
      this.htmlResource = null;
      this.iframeResource = null;
      this.iconClickThroughURLTemplate = null;
      this.iconClickTrackingURLTemplates = [];
      this.iconViewTrackingURLTemplate = null;
    }

    return VASTIcon;

  })();

  module.exports = VASTIcon;

}).call(this);

},{}],11:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  module.exports = {
    client: require('./client'),
    tracker: require('./tracker'),
    parser: require('./parser'),
    util: require('./util')
  };

}).call(this);

},{"./client":5,"./parser":14,"./tracker":16,"./util":20}],12:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTMediaFile;

  VASTMediaFile = (function() {
    function VASTMediaFile() {
      this.id = null;
      this.fileURL = null;
      this.deliveryType = "progressive";
      this.mimeType = null;
      this.codec = null;
      this.bitrate = 0;
      this.minBitrate = 0;
      this.maxBitrate = 0;
      this.width = 0;
      this.height = 0;
      this.apiFramework = null;
      this.scalable = null;
      this.maintainAspectRatio = null;
    }

    return VASTMediaFile;

  })();

  module.exports = VASTMediaFile;

}).call(this);

},{}],13:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTNonLinear;

  VASTNonLinear = (function() {
    function VASTNonLinear() {
      this.id = null;
      this.width = 0;
      this.height = 0;
      this.expandedWidth = 0;
      this.expandedHeight = 0;
      this.scalable = true;
      this.maintainAspectRatio = true;
      this.minSuggestedDuration = 0;
      this.apiFramework = "static";
      this.type = null;
      this.staticResource = null;
      this.htmlResource = null;
      this.iframeResource = null;
      this.nonlinearClickThroughURLTemplate = null;
      this.nonlinearClickTrackingURLTemplates = [];
      this.adParameters = null;
    }

    return VASTNonLinear;

  })();

  module.exports = VASTNonLinear;

}).call(this);

},{}],14:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var EventEmitter, URLHandler, VASTAd, VASTAdExtension, VASTAdExtensionChild, VASTCompanionAd, VASTCreativeCompanion, VASTCreativeLinear, VASTCreativeNonLinear, VASTIcon, VASTMediaFile, VASTNonLinear, VASTParser, VASTResponse, VASTUtil,
    indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  URLHandler = require('./urlhandler');

  VASTResponse = require('./response');

  VASTAd = require('./ad');

  VASTAdExtension = require('./extension');

  VASTAdExtensionChild = require('./extensionchild');

  VASTUtil = require('./util');

  VASTCreativeLinear = require('./creative').VASTCreativeLinear;

  VASTCreativeCompanion = require('./creative').VASTCreativeCompanion;

  VASTCreativeNonLinear = require('./creative').VASTCreativeNonLinear;

  VASTMediaFile = require('./mediafile');

  VASTIcon = require('./icon');

  VASTCompanionAd = require('./companionad');

  VASTNonLinear = require('./nonlinear');

  EventEmitter = require('events').EventEmitter;

  VASTParser = (function() {
    var URLTemplateFilters;

    function VASTParser() {}

    URLTemplateFilters = [];

    VASTParser.addURLTemplateFilter = function(func) {
      if (typeof func === 'function') {
        URLTemplateFilters.push(func);
      }
    };

    VASTParser.removeURLTemplateFilter = function() {
      return URLTemplateFilters.pop();
    };

    VASTParser.countURLTemplateFilters = function() {
      return URLTemplateFilters.length;
    };

    VASTParser.clearUrlTemplateFilters = function() {
      return URLTemplateFilters = [];
    };

    VASTParser.parse = function(url, options, cb) {
      if (!cb) {
        if (typeof options === 'function') {
          cb = options;
        }
        options = {};
      }
      return this._parse(url, null, options, function(err, response) {
        return cb(response, err);
      });
    };

    VASTParser.vent = new EventEmitter();

    VASTParser.track = function(templates, errorCode) {
      this.vent.emit('VAST-error', errorCode);
      return VASTUtil.track(templates, errorCode);
    };

    VASTParser.on = function(eventName, cb) {
      return this.vent.on(eventName, cb);
    };

    VASTParser.once = function(eventName, cb) {
      return this.vent.once(eventName, cb);
    };

    VASTParser._parse = function(url, parentURLs, options, cb) {
      var filter, i, len;
      if (!cb) {
        if (typeof options === 'function') {
          cb = options;
        }
        options = {};
      }
      for (i = 0, len = URLTemplateFilters.length; i < len; i++) {
        filter = URLTemplateFilters[i];
        url = filter(url);
      }
      if (parentURLs == null) {
        parentURLs = [];
      }
      parentURLs.push(url);
      return URLHandler.get(url, options, (function(_this) {
        return function(err, xml) {
          var ad, complete, j, k, len1, len2, loopIndex, node, ref, ref1, response;
          if (err != null) {
            return cb(err);
          }
          response = new VASTResponse();
          if (!(((xml != null ? xml.documentElement : void 0) != null) && xml.documentElement.nodeName === "VAST")) {
            return cb(new Error('Invalid VAST XMLDocument'));
          }
          ref = xml.documentElement.childNodes;
          for (j = 0, len1 = ref.length; j < len1; j++) {
            node = ref[j];
            if (node.nodeName === 'Error') {
              response.errorURLTemplates.push(_this.parseNodeText(node));
            }
          }
          ref1 = xml.documentElement.childNodes;
          for (k = 0, len2 = ref1.length; k < len2; k++) {
            node = ref1[k];
            if (node.nodeName === 'Ad') {
              ad = _this.parseAdElement(node);
              if (ad != null) {
                response.ads.push(ad);
              } else {
                _this.track(response.errorURLTemplates, {
                  ERRORCODE: 101
                });
              }
            }
          }
          complete = function(error, errorAlreadyRaised) {
            var l, len3, noCreatives, ref2;
            if (error == null) {
              error = null;
            }
            if (errorAlreadyRaised == null) {
              errorAlreadyRaised = false;
            }
            if (!response) {
              return;
            }
            noCreatives = true;
            ref2 = response.ads;
            for (l = 0, len3 = ref2.length; l < len3; l++) {
              ad = ref2[l];
              if (ad.nextWrapperURL != null) {
                return;
              }
              if (ad.creatives.length > 0) {
                noCreatives = false;
              }
            }
            if (noCreatives) {
              if (!errorAlreadyRaised) {
                _this.track(response.errorURLTemplates, {
                  ERRORCODE: 303
                });
              }
            }
            if (response.ads.length === 0) {
              response = null;
            }
            return cb(error, response);
          };
          loopIndex = response.ads.length;
          while (loopIndex--) {
            ad = response.ads[loopIndex];
            if (ad.nextWrapperURL == null) {
              continue;
            }
            (function(ad) {
              var baseURL, protocol, ref2;
              if (parentURLs.length > (options.wrapperLimit !== null ? options.wrapperLimit : 9) || (ref2 = ad.nextWrapperURL, indexOf.call(parentURLs, ref2) >= 0)) {
                _this.track(ad.errorURLTemplates, {
                  ERRORCODE: 302
                });
                response.ads.splice(response.ads.indexOf(ad), 1);
                complete(new Error("Wrapper limit reached, as defined by the video player"));
                return;
              }
              if (ad.nextWrapperURL.indexOf('//') === 0) {
                protocol = location.protocol;
                ad.nextWrapperURL = "" + protocol + ad.nextWrapperURL;
              } else if (ad.nextWrapperURL.indexOf('://') === -1) {
                baseURL = url.slice(0, url.lastIndexOf('/'));
                ad.nextWrapperURL = baseURL + "/" + ad.nextWrapperURL;
              }
              return _this._parse(ad.nextWrapperURL, parentURLs, options, function(err, wrappedResponse) {
                var base, creative, errorAlreadyRaised, eventName, index, l, len3, len4, len5, len6, len7, len8, m, n, o, p, q, ref3, ref4, ref5, ref6, ref7, ref8, wrappedAd;
                errorAlreadyRaised = false;
                if (err != null) {
                  _this.track(ad.errorURLTemplates, {
                    ERRORCODE: 301
                  });
                  response.ads.splice(response.ads.indexOf(ad), 1);
                  errorAlreadyRaised = true;
                } else if (wrappedResponse == null) {
                  _this.track(ad.errorURLTemplates, {
                    ERRORCODE: 303
                  });
                  response.ads.splice(response.ads.indexOf(ad), 1);
                  errorAlreadyRaised = true;
                } else {
                  response.errorURLTemplates = response.errorURLTemplates.concat(wrappedResponse.errorURLTemplates);
                  index = response.ads.indexOf(ad);
                  response.ads.splice(index, 1);
                  ref3 = wrappedResponse.ads;
                  for (l = 0, len3 = ref3.length; l < len3; l++) {
                    wrappedAd = ref3[l];
                    wrappedAd.errorURLTemplates = ad.errorURLTemplates.concat(wrappedAd.errorURLTemplates);
                    wrappedAd.impressionURLTemplates = ad.impressionURLTemplates.concat(wrappedAd.impressionURLTemplates);
                    wrappedAd.extensions = ad.extensions.concat(wrappedAd.extensions);
                    if (ad.trackingEvents != null) {
                      ref4 = wrappedAd.creatives;
                      for (m = 0, len4 = ref4.length; m < len4; m++) {
                        creative = ref4[m];
                        if (ad.trackingEvents[creative.type] != null) {
                          ref5 = Object.keys(ad.trackingEvents[creative.type]);
                          for (n = 0, len5 = ref5.length; n < len5; n++) {
                            eventName = ref5[n];
                            (base = creative.trackingEvents)[eventName] || (base[eventName] = []);
                            creative.trackingEvents[eventName] = creative.trackingEvents[eventName].concat(ad.trackingEvents[creative.type][eventName]);
                          }
                        }
                      }
                    }
                    if (ad.videoClickTrackingURLTemplates != null) {
                      ref6 = wrappedAd.creatives;
                      for (o = 0, len6 = ref6.length; o < len6; o++) {
                        creative = ref6[o];
                        if (creative.type === 'linear') {
                          creative.videoClickTrackingURLTemplates = creative.videoClickTrackingURLTemplates.concat(ad.videoClickTrackingURLTemplates);
                        }
                      }
                    }
                    if (ad.videoCustomClickURLTemplates != null) {
                      ref7 = wrappedAd.creatives;
                      for (p = 0, len7 = ref7.length; p < len7; p++) {
                        creative = ref7[p];
                        if (creative.type === 'linear') {
                          creative.videoCustomClickURLTemplates = creative.videoCustomClickURLTemplates.concat(ad.videoCustomClickURLTemplates);
                        }
                      }
                    }
                    if (ad.videoClickThroughURLTemplate != null) {
                      ref8 = wrappedAd.creatives;
                      for (q = 0, len8 = ref8.length; q < len8; q++) {
                        creative = ref8[q];
                        if (creative.type === 'linear' && (creative.videoClickThroughURLTemplate == null)) {
                          creative.videoClickThroughURLTemplate = ad.videoClickThroughURLTemplate;
                        }
                      }
                    }
                    response.ads.splice(++index, 0, wrappedAd);
                  }
                }
                delete ad.nextWrapperURL;
                return complete(err, errorAlreadyRaised);
              });
            })(ad);
          }
          return complete();
        };
      })(this));
    };

    VASTParser.childByName = function(node, name) {
      var child, i, len, ref;
      ref = node.childNodes;
      for (i = 0, len = ref.length; i < len; i++) {
        child = ref[i];
        if (child.nodeName === name) {
          return child;
        }
      }
    };

    VASTParser.childsByName = function(node, name) {
      var child, childs, i, len, ref;
      childs = [];
      ref = node.childNodes;
      for (i = 0, len = ref.length; i < len; i++) {
        child = ref[i];
        if (child.nodeName === name) {
          childs.push(child);
        }
      }
      return childs;
    };

    VASTParser.parseAdElement = function(adElement) {
      var adTypeElement, i, len, ref, ref1;
      ref = adElement.childNodes;
      for (i = 0, len = ref.length; i < len; i++) {
        adTypeElement = ref[i];
        if ((ref1 = adTypeElement.nodeName) !== "Wrapper" && ref1 !== "InLine") {
          continue;
        }
        this.copyNodeAttribute("id", adElement, adTypeElement);
        this.copyNodeAttribute("sequence", adElement, adTypeElement);
        if (adTypeElement.nodeName === "Wrapper") {
          return this.parseWrapperElement(adTypeElement);
        } else if (adTypeElement.nodeName === "InLine") {
          return this.parseInLineElement(adTypeElement);
        }
      }
    };

    VASTParser.parseWrapperElement = function(wrapperElement) {
      var ad, creative, i, len, ref, wrapperCreativeElement, wrapperURLElement;
      ad = this.parseInLineElement(wrapperElement);
      wrapperURLElement = this.childByName(wrapperElement, "VASTAdTagURI");
      if (wrapperURLElement != null) {
        ad.nextWrapperURL = this.parseNodeText(wrapperURLElement);
      } else {
        wrapperURLElement = this.childByName(wrapperElement, "VASTAdTagURL");
        if (wrapperURLElement != null) {
          ad.nextWrapperURL = this.parseNodeText(this.childByName(wrapperURLElement, "URL"));
        }
      }
      ref = ad.creatives;
      for (i = 0, len = ref.length; i < len; i++) {
        creative = ref[i];
        wrapperCreativeElement = null;
        if (creative.type === 'linear' || creative.type === 'nonlinear') {
          wrapperCreativeElement = creative;
          if (wrapperCreativeElement != null) {
            if (wrapperCreativeElement.trackingEvents != null) {
              ad.trackingEvents || (ad.trackingEvents = {});
              ad.trackingEvents[wrapperCreativeElement.type] = wrapperCreativeElement.trackingEvents;
            }
            if (wrapperCreativeElement.videoClickTrackingURLTemplates != null) {
              ad.videoClickTrackingURLTemplates = wrapperCreativeElement.videoClickTrackingURLTemplates;
            }
            if (wrapperCreativeElement.videoClickThroughURLTemplate != null) {
              ad.videoClickThroughURLTemplate = wrapperCreativeElement.videoClickThroughURLTemplate;
            }
            if (wrapperCreativeElement.videoCustomClickURLTemplates != null) {
              ad.videoCustomClickURLTemplates = wrapperCreativeElement.videoCustomClickURLTemplates;
            }
          }
        }
      }
      if (ad.nextWrapperURL != null) {
        return ad;
      }
    };

    VASTParser.parseInLineElement = function(inLineElement) {
      var ad, creative, creativeAttributes, creativeElement, creativeTypeElement, i, j, k, len, len1, len2, node, ref, ref1, ref2;
      ad = new VASTAd();
      ad.id = inLineElement.getAttribute("id") || null;
      ad.sequence = inLineElement.getAttribute("sequence") || null;
      ref = inLineElement.childNodes;
      for (i = 0, len = ref.length; i < len; i++) {
        node = ref[i];
        switch (node.nodeName) {
          case "Error":
            ad.errorURLTemplates.push(this.parseNodeText(node));
            break;
          case "Impression":
            ad.impressionURLTemplates.push(this.parseNodeText(node));
            break;
          case "Creatives":
            ref1 = this.childsByName(node, "Creative");
            for (j = 0, len1 = ref1.length; j < len1; j++) {
              creativeElement = ref1[j];
              creativeAttributes = {
                id: creativeElement.getAttribute('id') || null,
                adId: this.parseCreativeAdIdAttribute(creativeElement),
                sequence: creativeElement.getAttribute('sequence') || null,
                apiFramework: creativeElement.getAttribute('apiFramework') || null
              };
              ref2 = creativeElement.childNodes;
              for (k = 0, len2 = ref2.length; k < len2; k++) {
                creativeTypeElement = ref2[k];
                switch (creativeTypeElement.nodeName) {
                  case "Linear":
                    creative = this.parseCreativeLinearElement(creativeTypeElement, creativeAttributes);
                    if (creative) {
                      ad.creatives.push(creative);
                    }
                    break;
                  case "NonLinearAds":
                    creative = this.parseNonLinear(creativeTypeElement, creativeAttributes);
                    if (creative) {
                      ad.creatives.push(creative);
                    }
                    break;
                  case "CompanionAds":
                    creative = this.parseCompanionAd(creativeTypeElement, creativeAttributes);
                    if (creative) {
                      ad.creatives.push(creative);
                    }
                }
              }
            }
            break;
          case "Extensions":
            this.parseExtension(ad.extensions, this.childsByName(node, "Extension"));
            break;
          case "AdSystem":
            ad.system = {
              value: this.parseNodeText(node),
              version: node.getAttribute("version") || null
            };
            break;
          case "AdTitle":
            ad.title = this.parseNodeText(node);
            break;
          case "Description":
            ad.description = this.parseNodeText(node);
            break;
          case "Advertiser":
            ad.advertiser = this.parseNodeText(node);
            break;
          case "Pricing":
            ad.pricing = {
              value: this.parseNodeText(node),
              model: node.getAttribute("model") || null,
              currency: node.getAttribute("currency") || null
            };
            break;
          case "Survey":
            ad.survey = this.parseNodeText(node);
        }
      }
      return ad;
    };

    VASTParser.parseExtension = function(collection, extensions) {
      var childNode, ext, extChild, extChildNodeAttr, extNode, extNodeAttr, i, j, k, l, len, len1, len2, len3, ref, ref1, ref2, results, txt;
      results = [];
      for (i = 0, len = extensions.length; i < len; i++) {
        extNode = extensions[i];
        ext = new VASTAdExtension();
        if (extNode.attributes) {
          ref = extNode.attributes;
          for (j = 0, len1 = ref.length; j < len1; j++) {
            extNodeAttr = ref[j];
            ext.attributes[extNodeAttr.nodeName] = extNodeAttr.nodeValue;
          }
        }
        ref1 = extNode.childNodes;
        for (k = 0, len2 = ref1.length; k < len2; k++) {
          childNode = ref1[k];
          txt = this.parseNodeText(childNode);
          if (childNode.nodeName !== '#comment' && txt !== '') {
            extChild = new VASTAdExtensionChild();
            extChild.name = childNode.nodeName;
            extChild.value = txt;
            if (childNode.attributes) {
              ref2 = childNode.attributes;
              for (l = 0, len3 = ref2.length; l < len3; l++) {
                extChildNodeAttr = ref2[l];
                extChild.attributes[extChildNodeAttr.nodeName] = extChildNodeAttr.nodeValue;
              }
            }
            ext.children.push(extChild);
          }
        }
        results.push(collection.push(ext));
      }
      return results;
    };

    VASTParser.parseCreativeLinearElement = function(creativeElement, creativeAttributes) {
      var adParamsElement, base, clickTrackingElement, creative, customClickElement, eventName, htmlElement, i, icon, iconClickTrackingElement, iconClicksElement, iconElement, iconsElement, iframeElement, j, k, l, len, len1, len10, len2, len3, len4, len5, len6, len7, len8, len9, m, maintainAspectRatio, mediaFile, mediaFileElement, mediaFilesElement, n, o, offset, p, percent, q, r, ref, ref1, ref10, ref2, ref3, ref4, ref5, ref6, ref7, ref8, ref9, s, scalable, skipOffset, staticElement, trackingElement, trackingEventsElement, trackingURLTemplate, videoClicksElement;
      creative = new VASTCreativeLinear(creativeAttributes);
      creative.duration = this.parseDuration(this.parseNodeText(this.childByName(creativeElement, "Duration")));
      if (creative.duration === -1 && creativeElement.parentNode.parentNode.parentNode.nodeName !== 'Wrapper') {
        return null;
      }
      skipOffset = creativeElement.getAttribute("skipoffset");
      if (skipOffset == null) {
        creative.skipDelay = null;
      } else if (skipOffset.charAt(skipOffset.length - 1) === "%") {
        percent = parseInt(skipOffset, 10);
        creative.skipDelay = creative.duration * (percent / 100);
      } else {
        creative.skipDelay = this.parseDuration(skipOffset);
      }
      videoClicksElement = this.childByName(creativeElement, "VideoClicks");
      if (videoClicksElement != null) {
        creative.videoClickThroughURLTemplate = this.parseNodeText(this.childByName(videoClicksElement, "ClickThrough"));
        ref = this.childsByName(videoClicksElement, "ClickTracking");
        for (i = 0, len = ref.length; i < len; i++) {
          clickTrackingElement = ref[i];
          creative.videoClickTrackingURLTemplates.push(this.parseNodeText(clickTrackingElement));
        }
        ref1 = this.childsByName(videoClicksElement, "CustomClick");
        for (j = 0, len1 = ref1.length; j < len1; j++) {
          customClickElement = ref1[j];
          creative.videoCustomClickURLTemplates.push(this.parseNodeText(customClickElement));
        }
      }
      adParamsElement = this.childByName(creativeElement, "AdParameters");
      if (adParamsElement != null) {
        creative.adParameters = this.parseNodeText(adParamsElement);
      }
      ref2 = this.childsByName(creativeElement, "TrackingEvents");
      for (k = 0, len2 = ref2.length; k < len2; k++) {
        trackingEventsElement = ref2[k];
        ref3 = this.childsByName(trackingEventsElement, "Tracking");
        for (l = 0, len3 = ref3.length; l < len3; l++) {
          trackingElement = ref3[l];
          eventName = trackingElement.getAttribute("event");
          trackingURLTemplate = this.parseNodeText(trackingElement);
          if ((eventName != null) && (trackingURLTemplate != null)) {
            if (eventName === "progress") {
              offset = trackingElement.getAttribute("offset");
              if (!offset) {
                continue;
              }
              if (offset.charAt(offset.length - 1) === '%') {
                eventName = "progress-" + offset;
              } else {
                eventName = "progress-" + (Math.round(this.parseDuration(offset)));
              }
            }
            if ((base = creative.trackingEvents)[eventName] == null) {
              base[eventName] = [];
            }
            creative.trackingEvents[eventName].push(trackingURLTemplate);
          }
        }
      }
      ref4 = this.childsByName(creativeElement, "MediaFiles");
      for (m = 0, len4 = ref4.length; m < len4; m++) {
        mediaFilesElement = ref4[m];
        ref5 = this.childsByName(mediaFilesElement, "MediaFile");
        for (n = 0, len5 = ref5.length; n < len5; n++) {
          mediaFileElement = ref5[n];
          mediaFile = new VASTMediaFile();
          mediaFile.id = mediaFileElement.getAttribute("id");
          mediaFile.fileURL = this.parseNodeText(mediaFileElement);
          mediaFile.deliveryType = mediaFileElement.getAttribute("delivery");
          mediaFile.codec = mediaFileElement.getAttribute("codec");
          mediaFile.mimeType = mediaFileElement.getAttribute("type");
          mediaFile.apiFramework = mediaFileElement.getAttribute("apiFramework");
          mediaFile.bitrate = parseInt(mediaFileElement.getAttribute("bitrate") || 0);
          mediaFile.minBitrate = parseInt(mediaFileElement.getAttribute("minBitrate") || 0);
          mediaFile.maxBitrate = parseInt(mediaFileElement.getAttribute("maxBitrate") || 0);
          mediaFile.width = parseInt(mediaFileElement.getAttribute("width") || 0);
          mediaFile.height = parseInt(mediaFileElement.getAttribute("height") || 0);
          scalable = mediaFileElement.getAttribute("scalable");
          if (scalable && typeof scalable === "string") {
            scalable = scalable.toLowerCase();
            if (scalable === "true") {
              mediaFile.scalable = true;
            } else if (scalable === "false") {
              mediaFile.scalable = false;
            }
          }
          maintainAspectRatio = mediaFileElement.getAttribute("maintainAspectRatio");
          if (maintainAspectRatio && typeof maintainAspectRatio === "string") {
            maintainAspectRatio = maintainAspectRatio.toLowerCase();
            if (maintainAspectRatio === "true") {
              mediaFile.maintainAspectRatio = true;
            } else if (maintainAspectRatio === "false") {
              mediaFile.maintainAspectRatio = false;
            }
          }
          creative.mediaFiles.push(mediaFile);
        }
      }
      iconsElement = this.childByName(creativeElement, "Icons");
      if (iconsElement != null) {
        ref6 = this.childsByName(iconsElement, "Icon");
        for (o = 0, len6 = ref6.length; o < len6; o++) {
          iconElement = ref6[o];
          icon = new VASTIcon();
          icon.program = iconElement.getAttribute("program");
          icon.height = parseInt(iconElement.getAttribute("height") || 0);
          icon.width = parseInt(iconElement.getAttribute("width") || 0);
          icon.xPosition = this.parseXPosition(iconElement.getAttribute("xPosition"));
          icon.yPosition = this.parseYPosition(iconElement.getAttribute("yPosition"));
          icon.apiFramework = iconElement.getAttribute("apiFramework");
          icon.offset = this.parseDuration(iconElement.getAttribute("offset"));
          icon.duration = this.parseDuration(iconElement.getAttribute("duration"));
          ref7 = this.childsByName(iconElement, "HTMLResource");
          for (p = 0, len7 = ref7.length; p < len7; p++) {
            htmlElement = ref7[p];
            icon.type = htmlElement.getAttribute("creativeType") || 'text/html';
            icon.htmlResource = this.parseNodeText(htmlElement);
          }
          ref8 = this.childsByName(iconElement, "IFrameResource");
          for (q = 0, len8 = ref8.length; q < len8; q++) {
            iframeElement = ref8[q];
            icon.type = iframeElement.getAttribute("creativeType") || 0;
            icon.iframeResource = this.parseNodeText(iframeElement);
          }
          ref9 = this.childsByName(iconElement, "StaticResource");
          for (r = 0, len9 = ref9.length; r < len9; r++) {
            staticElement = ref9[r];
            icon.type = staticElement.getAttribute("creativeType") || 0;
            icon.staticResource = this.parseNodeText(staticElement);
          }
          iconClicksElement = this.childByName(iconElement, "IconClicks");
          if (iconClicksElement != null) {
            icon.iconClickThroughURLTemplate = this.parseNodeText(this.childByName(iconClicksElement, "IconClickThrough"));
            ref10 = this.childsByName(iconClicksElement, "IconClickTracking");
            for (s = 0, len10 = ref10.length; s < len10; s++) {
              iconClickTrackingElement = ref10[s];
              icon.iconClickTrackingURLTemplates.push(this.parseNodeText(iconClickTrackingElement));
            }
          }
          icon.iconViewTrackingURLTemplate = this.parseNodeText(this.childByName(iconElement, "IconViewTracking"));
          creative.icons.push(icon);
        }
      }
      return creative;
    };

    VASTParser.parseNonLinear = function(creativeElement, creativeAttributes) {
      var adParamsElement, base, clickTrackingElement, creative, eventName, htmlElement, i, iframeElement, j, k, l, len, len1, len2, len3, len4, len5, len6, m, n, nonlinearAd, nonlinearResource, o, ref, ref1, ref2, ref3, ref4, ref5, ref6, staticElement, trackingElement, trackingEventsElement, trackingURLTemplate;
      creative = new VASTCreativeNonLinear(creativeAttributes);
      ref = this.childsByName(creativeElement, "TrackingEvents");
      for (i = 0, len = ref.length; i < len; i++) {
        trackingEventsElement = ref[i];
        ref1 = this.childsByName(trackingEventsElement, "Tracking");
        for (j = 0, len1 = ref1.length; j < len1; j++) {
          trackingElement = ref1[j];
          eventName = trackingElement.getAttribute("event");
          trackingURLTemplate = this.parseNodeText(trackingElement);
          if ((eventName != null) && (trackingURLTemplate != null)) {
            if ((base = creative.trackingEvents)[eventName] == null) {
              base[eventName] = [];
            }
            creative.trackingEvents[eventName].push(trackingURLTemplate);
          }
        }
      }
      ref2 = this.childsByName(creativeElement, "NonLinear");
      for (k = 0, len2 = ref2.length; k < len2; k++) {
        nonlinearResource = ref2[k];
        nonlinearAd = new VASTNonLinear();
        nonlinearAd.id = nonlinearResource.getAttribute("id") || null;
        nonlinearAd.width = nonlinearResource.getAttribute("width");
        nonlinearAd.height = nonlinearResource.getAttribute("height");
        nonlinearAd.expandedWidth = nonlinearResource.getAttribute("expandedWidth");
        nonlinearAd.expandedHeight = nonlinearResource.getAttribute("expandedHeight");
        nonlinearAd.scalable = this.parseBoolean(nonlinearResource.getAttribute("scalable"));
        nonlinearAd.maintainAspectRatio = this.parseBoolean(nonlinearResource.getAttribute("maintainAspectRatio"));
        nonlinearAd.minSuggestedDuration = this.parseDuration(nonlinearResource.getAttribute("minSuggestedDuration"));
        nonlinearAd.apiFramework = nonlinearResource.getAttribute("apiFramework");
        ref3 = this.childsByName(nonlinearResource, "HTMLResource");
        for (l = 0, len3 = ref3.length; l < len3; l++) {
          htmlElement = ref3[l];
          nonlinearAd.type = htmlElement.getAttribute("creativeType") || 'text/html';
          nonlinearAd.htmlResource = this.parseNodeText(htmlElement);
        }
        ref4 = this.childsByName(nonlinearResource, "IFrameResource");
        for (m = 0, len4 = ref4.length; m < len4; m++) {
          iframeElement = ref4[m];
          nonlinearAd.type = iframeElement.getAttribute("creativeType") || 0;
          nonlinearAd.iframeResource = this.parseNodeText(iframeElement);
        }
        ref5 = this.childsByName(nonlinearResource, "StaticResource");
        for (n = 0, len5 = ref5.length; n < len5; n++) {
          staticElement = ref5[n];
          nonlinearAd.type = staticElement.getAttribute("creativeType") || 0;
          nonlinearAd.staticResource = this.parseNodeText(staticElement);
        }
        adParamsElement = this.childByName(nonlinearResource, "AdParameters");
        if (adParamsElement != null) {
          nonlinearAd.adParameters = this.parseNodeText(adParamsElement);
        }
        nonlinearAd.nonlinearClickThroughURLTemplate = this.parseNodeText(this.childByName(nonlinearResource, "NonLinearClickThrough"));
        ref6 = this.childsByName(nonlinearResource, "NonLinearClickTracking");
        for (o = 0, len6 = ref6.length; o < len6; o++) {
          clickTrackingElement = ref6[o];
          nonlinearAd.nonlinearClickTrackingURLTemplates.push(this.parseNodeText(clickTrackingElement));
        }
        creative.variations.push(nonlinearAd);
      }
      return creative;
    };

    VASTParser.parseCompanionAd = function(creativeElement, creativeAttributes) {
      var base, child, clickTrackingElement, companionAd, companionResource, creative, eventName, htmlElement, i, iframeElement, j, k, l, len, len1, len2, len3, len4, len5, len6, len7, m, n, o, p, ref, ref1, ref2, ref3, ref4, ref5, ref6, ref7, staticElement, trackingElement, trackingEventsElement, trackingURLTemplate;
      creative = new VASTCreativeCompanion(creativeAttributes);
      ref = this.childsByName(creativeElement, "Companion");
      for (i = 0, len = ref.length; i < len; i++) {
        companionResource = ref[i];
        companionAd = new VASTCompanionAd();
        companionAd.id = companionResource.getAttribute("id") || null;
        companionAd.width = companionResource.getAttribute("width");
        companionAd.height = companionResource.getAttribute("height");
        companionAd.companionClickTrackingURLTemplates = [];
        ref1 = this.childsByName(companionResource, "HTMLResource");
        for (j = 0, len1 = ref1.length; j < len1; j++) {
          htmlElement = ref1[j];
          companionAd.type = htmlElement.getAttribute("creativeType") || 'text/html';
          companionAd.htmlResource = this.parseNodeText(htmlElement);
        }
        ref2 = this.childsByName(companionResource, "IFrameResource");
        for (k = 0, len2 = ref2.length; k < len2; k++) {
          iframeElement = ref2[k];
          companionAd.type = iframeElement.getAttribute("creativeType") || 0;
          companionAd.iframeResource = this.parseNodeText(iframeElement);
        }
        ref3 = this.childsByName(companionResource, "StaticResource");
        for (l = 0, len3 = ref3.length; l < len3; l++) {
          staticElement = ref3[l];
          companionAd.type = staticElement.getAttribute("creativeType") || 0;
          ref4 = this.childsByName(companionResource, "AltText");
          for (m = 0, len4 = ref4.length; m < len4; m++) {
            child = ref4[m];
            companionAd.altText = this.parseNodeText(child);
          }
          companionAd.staticResource = this.parseNodeText(staticElement);
        }
        ref5 = this.childsByName(companionResource, "TrackingEvents");
        for (n = 0, len5 = ref5.length; n < len5; n++) {
          trackingEventsElement = ref5[n];
          ref6 = this.childsByName(trackingEventsElement, "Tracking");
          for (o = 0, len6 = ref6.length; o < len6; o++) {
            trackingElement = ref6[o];
            eventName = trackingElement.getAttribute("event");
            trackingURLTemplate = this.parseNodeText(trackingElement);
            if ((eventName != null) && (trackingURLTemplate != null)) {
              if ((base = companionAd.trackingEvents)[eventName] == null) {
                base[eventName] = [];
              }
              companionAd.trackingEvents[eventName].push(trackingURLTemplate);
            }
          }
        }
        ref7 = this.childsByName(companionResource, "CompanionClickTracking");
        for (p = 0, len7 = ref7.length; p < len7; p++) {
          clickTrackingElement = ref7[p];
          companionAd.companionClickTrackingURLTemplates.push(this.parseNodeText(clickTrackingElement));
        }
        companionAd.companionClickThroughURLTemplate = this.parseNodeText(this.childByName(companionResource, "CompanionClickThrough"));
        companionAd.companionClickTrackingURLTemplate = this.parseNodeText(this.childByName(companionResource, "CompanionClickTracking"));
        creative.variations.push(companionAd);
      }
      return creative;
    };

    VASTParser.parseDuration = function(durationString) {
      var durationComponents, hours, minutes, seconds, secondsAndMS;
      if (!(durationString != null)) {
        return -1;
      }
      if (VASTUtil.isNumeric(durationString)) {
        return parseInt(durationString);
      }
      durationComponents = durationString.split(":");
      if (durationComponents.length !== 3) {
        return -1;
      }
      secondsAndMS = durationComponents[2].split(".");
      seconds = parseInt(secondsAndMS[0]);
      if (secondsAndMS.length === 2) {
        seconds += parseFloat("0." + secondsAndMS[1]);
      }
      minutes = parseInt(durationComponents[1] * 60);
      hours = parseInt(durationComponents[0] * 60 * 60);
      if (isNaN(hours || isNaN(minutes || isNaN(seconds || minutes > 60 * 60 || seconds > 60)))) {
        return -1;
      }
      return hours + minutes + seconds;
    };

    VASTParser.parseXPosition = function(xPosition) {
      if (xPosition === "left" || xPosition === "right") {
        return xPosition;
      }
      return parseInt(xPosition || 0);
    };

    VASTParser.parseYPosition = function(yPosition) {
      if (yPosition === "top" || yPosition === "bottom") {
        return yPosition;
      }
      return parseInt(yPosition || 0);
    };

    VASTParser.parseBoolean = function(booleanString) {
      return booleanString === 'true' || booleanString === 'TRUE' || booleanString === '1';
    };

    VASTParser.parseNodeText = function(node) {
      return node && (node.textContent || node.text || '').trim();
    };

    VASTParser.copyNodeAttribute = function(attributeName, nodeSource, nodeDestination) {
      var attributeValue;
      attributeValue = nodeSource.getAttribute(attributeName);
      if (attributeValue) {
        return nodeDestination.setAttribute(attributeName, attributeValue);
      }
    };

    VASTParser.parseCreativeAdIdAttribute = function(creativeElement) {
      return creativeElement.getAttribute('AdID') || creativeElement.getAttribute('adID') || creativeElement.getAttribute('adId') || null;
    };

    return VASTParser;

  })();

  module.exports = VASTParser;

}).call(this);

},{"./ad":4,"./companionad":6,"./creative":7,"./extension":8,"./extensionchild":9,"./icon":10,"./mediafile":12,"./nonlinear":13,"./response":15,"./urlhandler":17,"./util":20,"events":2}],15:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTResponse;

  VASTResponse = (function() {
    function VASTResponse() {
      this.ads = [];
      this.errorURLTemplates = [];
    }

    return VASTResponse;

  })();

  module.exports = VASTResponse;

}).call(this);

},{}],16:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var EventEmitter, VASTClient, VASTCompanionAd, VASTCreativeLinear, VASTNonLinear, VASTTracker, VASTUtil,
    extend = function(child, parent) { for (var key in parent) { if (hasProp.call(parent, key)) child[key] = parent[key]; } function ctor() { this.constructor = child; } ctor.prototype = parent.prototype; child.prototype = new ctor(); child.__super__ = parent.prototype; return child; },
    hasProp = {}.hasOwnProperty;

  VASTClient = require('./client');

  VASTUtil = require('./util');

  VASTCreativeLinear = require('./creative').VASTCreativeLinear;

  VASTNonLinear = require('./nonlinear');

  VASTCompanionAd = require('./companionad');

  EventEmitter = require('events').EventEmitter;

  VASTTracker = (function(superClass) {
    extend(VASTTracker, superClass);

    function VASTTracker(ad, creative, variation) {
      var eventName, events, ref;
      this.ad = ad;
      this.creative = creative;
      this.variation = variation != null ? variation : null;
      this.muted = false;
      this.impressed = false;
      this.skipable = false;
      this.skipDelayDefault = -1;
      this.trackingEvents = {};
      this.emitAlwaysEvents = ['creativeView', 'start', 'firstQuartile', 'midpoint', 'thirdQuartile', 'complete', 'resume', 'pause', 'rewind', 'skip', 'closeLinear', 'close'];
      ref = this.creative.trackingEvents;
      for (eventName in ref) {
        events = ref[eventName];
        this.trackingEvents[eventName] = events.slice(0);
      }
      if (this.creative instanceof VASTCreativeLinear) {
        this.setDuration(this.creative.duration);
        this.skipDelay = this.creative.skipDelay;
        this.linear = true;
        this.clickThroughURLTemplate = this.creative.videoClickThroughURLTemplate;
        this.clickTrackingURLTemplates = this.creative.videoClickTrackingURLTemplates;
      } else {
        this.skipDelay = -1;
        this.linear = false;
        if (this.variation) {
          if (this.variation instanceof VASTNonLinear) {
            this.clickThroughURLTemplate = this.variation.nonlinearClickThroughURLTemplate;
            this.clickTrackingURLTemplates = this.variation.nonlinearClickTrackingURLTemplates;
          } else if (this.variation instanceof VASTCompanionAd) {
            this.clickThroughURLTemplate = this.variation.companionClickThroughURLTemplate;
            this.clickTrackingURLTemplates = this.variation.companionClickTrackingURLTemplates;
          }
        }
      }
      this.on('start', function() {
        VASTClient.lastSuccessfullAd = +new Date();
      });
    }

    VASTTracker.prototype.setDuration = function(duration) {
      this.assetDuration = duration;
      return this.quartiles = {
        'firstQuartile': Math.round(25 * this.assetDuration) / 100,
        'midpoint': Math.round(50 * this.assetDuration) / 100,
        'thirdQuartile': Math.round(75 * this.assetDuration) / 100
      };
    };

    VASTTracker.prototype.setProgress = function(progress) {
      var eventName, events, i, len, percent, quartile, ref, skipDelay, time;
      skipDelay = this.skipDelay === null ? this.skipDelayDefault : this.skipDelay;
      if (skipDelay !== -1 && !this.skipable) {
        if (skipDelay > progress) {
          this.emit('skip-countdown', skipDelay - progress);
        } else {
          this.skipable = true;
          this.emit('skip-countdown', 0);
        }
      }
      if (this.linear && this.assetDuration > 0) {
        events = [];
        if (progress > 0) {
          events.push("start");
          percent = Math.round(progress / this.assetDuration * 100);
          events.push("progress-" + percent + "%");
          events.push("progress-" + (Math.round(progress)));
          ref = this.quartiles;
          for (quartile in ref) {
            time = ref[quartile];
            if ((time <= progress && progress <= (time + 1))) {
              events.push(quartile);
            }
          }
        }
        for (i = 0, len = events.length; i < len; i++) {
          eventName = events[i];
          this.track(eventName, true);
        }
        if (progress < this.progress) {
          this.track("rewind");
        }
      }
      return this.progress = progress;
    };

    VASTTracker.prototype.setMuted = function(muted) {
      if (this.muted !== muted) {
        this.track(muted ? "mute" : "unmute");
      }
      return this.muted = muted;
    };

    VASTTracker.prototype.setPaused = function(paused) {
      if (this.paused !== paused) {
        this.track(paused ? "pause" : "resume");
      }
      return this.paused = paused;
    };

    VASTTracker.prototype.setFullscreen = function(fullscreen) {
      if (this.fullscreen !== fullscreen) {
        this.track(fullscreen ? "fullscreen" : "exitFullscreen");
      }
      return this.fullscreen = fullscreen;
    };

    VASTTracker.prototype.setExpand = function(expanded) {
      if (this.expanded !== expanded) {
        this.track(expanded ? "expand" : "collapse");
      }
      return this.expanded = expanded;
    };

    VASTTracker.prototype.setSkipDelay = function(duration) {
      if (typeof duration === 'number') {
        return this.skipDelay = duration;
      }
    };

    VASTTracker.prototype.load = function() {
      if (!this.impressed) {
        this.impressed = true;
        this.trackURLs(this.ad.impressionURLTemplates);
        return this.track("creativeView");
      }
    };

    VASTTracker.prototype.errorWithCode = function(errorCode) {
      return this.trackURLs(this.ad.errorURLTemplates, {
        ERRORCODE: errorCode
      });
    };

    VASTTracker.prototype.complete = function() {
      return this.track("complete");
    };

    VASTTracker.prototype.close = function() {
      return this.track(this.linear ? "closeLinear" : "close");
    };

    VASTTracker.prototype.stop = function() {};

    VASTTracker.prototype.skip = function() {
      this.track("skip");
      return this.trackingEvents = [];
    };

    VASTTracker.prototype.click = function() {
      var clickThroughURL, ref, variables;
      if ((ref = this.clickTrackingURLTemplates) != null ? ref.length : void 0) {
        this.trackURLs(this.clickTrackingURLTemplates);
      }
      if (this.clickThroughURLTemplate != null) {
        if (this.linear) {
          variables = {
            CONTENTPLAYHEAD: this.progressFormated()
          };
        }
        clickThroughURL = VASTUtil.resolveURLTemplates([this.clickThroughURLTemplate], variables)[0];
        return this.emit("clickthrough", clickThroughURL);
      }
    };

    VASTTracker.prototype.track = function(eventName, once) {
      var idx, trackingURLTemplates;
      if (once == null) {
        once = false;
      }
      if (eventName === 'closeLinear' && ((this.trackingEvents[eventName] == null) && (this.trackingEvents['close'] != null))) {
        eventName = 'close';
      }
      trackingURLTemplates = this.trackingEvents[eventName];
      idx = this.emitAlwaysEvents.indexOf(eventName);
      if (trackingURLTemplates != null) {
        this.emit(eventName, '');
        this.trackURLs(trackingURLTemplates);
      } else if (idx !== -1) {
        this.emit(eventName, '');
      }
      if (once === true) {
        delete this.trackingEvents[eventName];
        if (idx > -1) {
          this.emitAlwaysEvents.splice(idx, 1);
        }
      }
    };

    VASTTracker.prototype.trackURLs = function(URLTemplates, variables) {
      var ref;
      if (variables == null) {
        variables = {};
      }
      if (this.linear) {
        if (((ref = this.creative.mediaFiles[0]) != null ? ref.fileURL : void 0) != null) {
          variables["ASSETURI"] = this.creative.mediaFiles[0].fileURL;
        }
        variables["CONTENTPLAYHEAD"] = this.progressFormated();
      }
      return VASTUtil.track(URLTemplates, variables);
    };

    VASTTracker.prototype.progressFormated = function() {
      var h, m, ms, s, seconds;
      seconds = parseInt(this.progress);
      h = seconds / (60 * 60);
      if (h.length < 2) {
        h = "0" + h;
      }
      m = seconds / 60 % 60;
      if (m.length < 2) {
        m = "0" + m;
      }
      s = seconds % 60;
      if (s.length < 2) {
        s = "0" + m;
      }
      ms = parseInt((this.progress - seconds) * 100);
      return h + ":" + m + ":" + s + "." + ms;
    };

    return VASTTracker;

  })(EventEmitter);

  module.exports = VASTTracker;

}).call(this);

},{"./client":5,"./companionad":6,"./creative":7,"./nonlinear":13,"./util":20,"events":2}],17:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var URLHandler, flash, xhr;

  xhr = require('./urlhandlers/xmlhttprequest');

  flash = require('./urlhandlers/flash');

  URLHandler = (function() {
    function URLHandler() {}

    URLHandler.get = function(url, options, cb) {
      var ref, response;
      if (!cb) {
        if (typeof options === 'function') {
          cb = options;
        }
        options = {};
      }
      if (options.response != null) {
        response = options.response;
        delete options.response;
        return cb(null, response);
      } else if ((ref = options.urlhandler) != null ? ref.supported() : void 0) {
        return options.urlhandler.get(url, options, cb);
      } else if (typeof window === "undefined" || window === null) {
        return require('./urlhandlers/' + 'node').get(url, options, cb);
      } else if (xhr.supported()) {
        return xhr.get(url, options, cb);
      } else if (flash.supported()) {
        return flash.get(url, options, cb);
      } else {
        return cb(new Error('Current context is not supported by any of the default URLHandlers. Please provide a custom URLHandler'));
      }
    };

    return URLHandler;

  })();

  module.exports = URLHandler;

}).call(this);

},{"./urlhandlers/flash":18,"./urlhandlers/xmlhttprequest":19}],18:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var FlashURLHandler;

  FlashURLHandler = (function() {
    function FlashURLHandler() {}

    FlashURLHandler.xdr = function() {
      var xdr;
      if (window.XDomainRequest) {
        xdr = new XDomainRequest();
      }
      return xdr;
    };

    FlashURLHandler.supported = function() {
      return !!this.xdr();
    };

    FlashURLHandler.get = function(url, options, cb) {
      var xdr, xmlDocument;
      if (xmlDocument = typeof window.ActiveXObject === "function" ? new window.ActiveXObject("Microsoft.XMLDOM") : void 0) {
        xmlDocument.async = false;
      } else {
        return cb(new Error('FlashURLHandler: Microsoft.XMLDOM format not supported'));
      }
      xdr = this.xdr();
      xdr.open('GET', url);
      xdr.timeout = options.timeout || 0;
      xdr.withCredentials = options.withCredentials || false;
      xdr.send();
      xdr.onprogress = function() {};
      return xdr.onload = function() {
        xmlDocument.loadXML(xdr.responseText);
        return cb(null, xmlDocument);
      };
    };

    return FlashURLHandler;

  })();

  module.exports = FlashURLHandler;

}).call(this);

},{}],19:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var XHRURLHandler;

  XHRURLHandler = (function() {
    function XHRURLHandler() {}

    XHRURLHandler.xhr = function() {
      var xhr;
      xhr = new window.XMLHttpRequest();
      if ('withCredentials' in xhr) {
        return xhr;
      }
    };

    XHRURLHandler.supported = function() {
      return !!this.xhr();
    };

    XHRURLHandler.get = function(url, options, cb) {
      var xhr;
      if (window.location.protocol === 'https:' && url.indexOf('http://') === 0) {
        return cb(new Error('XHRURLHandler: Cannot go from HTTPS to HTTP.'));
      }
      try {
        xhr = this.xhr();
        xhr.open('GET', url);
        xhr.timeout = options.timeout || 0;
        xhr.withCredentials = options.withCredentials || false;
        xhr.overrideMimeType && xhr.overrideMimeType('text/xml');
        xhr.onreadystatechange = function() {
          if (xhr.readyState === 4) {
            if (xhr.status === 200) {
              return cb(null, xhr.responseXML);
            } else {
              return cb(new Error("XHRURLHandler: " + xhr.statusText));
            }
          }
        };
        return xhr.send();
      } catch (error) {
        return cb(new Error('XHRURLHandler: Unexpected error'));
      }
    };

    return XHRURLHandler;

  })();

  module.exports = XHRURLHandler;

}).call(this);

},{}],20:[function(require,module,exports){
// Generated by CoffeeScript 1.11.1
(function() {
  var VASTUtil;

  VASTUtil = (function() {
    function VASTUtil() {}

    VASTUtil.track = function(URLTemplates, variables) {
      var URL, URLs, i, j, len, results;
      URLs = this.resolveURLTemplates(URLTemplates, variables);
      results = [];
      for (j = 0, len = URLs.length; j < len; j++) {
        URL = URLs[j];
        if (typeof window !== "undefined" && window !== null) {
          i = new Image();
          results.push(i.src = URL);
        } else {

        }
      }
      return results;
    };

    VASTUtil.resolveURLTemplates = function(URLTemplates, variables) {
      var URLTemplate, URLs, j, key, len, macro1, macro2, resolveURL, value;
      if (variables == null) {
        variables = {};
      }
      URLs = [];
      if (variables["ASSETURI"] != null) {
        variables["ASSETURI"] = this.encodeURIComponentRFC3986(variables["ASSETURI"]);
      }
      if (variables["CONTENTPLAYHEAD"] != null) {
        variables["CONTENTPLAYHEAD"] = this.encodeURIComponentRFC3986(variables["CONTENTPLAYHEAD"]);
      }
      if ((variables["ERRORCODE"] != null) && !/^[0-9]{3}$/.test(variables["ERRORCODE"])) {
        variables["ERRORCODE"] = 900;
      }
      variables["CACHEBUSTING"] = this.leftpad(Math.round(Math.random() * 1.0e+8).toString());
      variables["TIMESTAMP"] = this.encodeURIComponentRFC3986((new Date).toISOString());
      variables["RANDOM"] = variables["random"] = variables["CACHEBUSTING"];
      for (j = 0, len = URLTemplates.length; j < len; j++) {
        URLTemplate = URLTemplates[j];
        resolveURL = URLTemplate;
        if (!resolveURL) {
          continue;
        }
        for (key in variables) {
          value = variables[key];
          macro1 = "[" + key + "]";
          macro2 = "%%" + key + "%%";
          resolveURL = resolveURL.replace(macro1, value);
          resolveURL = resolveURL.replace(macro2, value);
        }
        URLs.push(resolveURL);
      }
      return URLs;
    };

    VASTUtil.encodeURIComponentRFC3986 = function(str) {
      return encodeURIComponent(str).replace(/[!'()*]/g, function(c) {
        return '%' + c.charCodeAt(0).toString(16);
      });
    };

    VASTUtil.leftpad = function(str) {
      if (str.length < 8) {
        return ((function() {
          var j, ref, results;
          results = [];
          for (j = 0, ref = 8 - str.length; 0 <= ref ? j < ref : j > ref; 0 <= ref ? j++ : j--) {
            results.push('0');
          }
          return results;
        })()).join('') + str;
      } else {
        return str;
      }
    };

    VASTUtil.storage = (function() {
      var data, isDisabled, storage, storageError;
      try {
        storage = typeof window !== "undefined" && window !== null ? window.localStorage || window.sessionStorage : null;
      } catch (error) {
        storageError = error;
        storage = null;
      }
      isDisabled = function(store) {
        var e, testValue;
        try {
          testValue = '__VASTUtil__';
          store.setItem(testValue, testValue);
          if (store.getItem(testValue) !== testValue) {
            return true;
          }
        } catch (error) {
          e = error;
          return true;
        }
        return false;
      };
      if ((storage == null) || isDisabled(storage)) {
        data = {};
        storage = {
          length: 0,
          getItem: function(key) {
            return data[key];
          },
          setItem: function(key, value) {
            data[key] = value;
            this.length = Object.keys(data).length;
          },
          removeItem: function(key) {
            delete data[key];
            this.length = Object.keys(data).length;
          },
          clear: function() {
            data = {};
            this.length = 0;
          }
        };
      }
      return storage;
    })();

    VASTUtil.isNumeric = function(n) {
      return !isNaN(parseFloat(n)) && isFinite(n);
    };

    return VASTUtil;

  })();

  module.exports = VASTUtil;

}).call(this);

},{}],21:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _events = require('events');

var _events2 = _interopRequireDefault(_events);

var _configUtils = require('./configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _agencyDict = require('./agency/agencyDict');

var _agencyDict2 = _interopRequireDefault(_agencyDict);

var _logger = require('./logger');

var _logger2 = _interopRequireDefault(_logger);

var _adsEvents = require('./adsEvents');

var _preset = require('./preset');

var _imaLoader = require('./imaLoader');

var _imaLoader2 = _interopRequireDefault(_imaLoader);

var _manager = require('./statistic/manager');

var _manager2 = _interopRequireDefault(_manager);

var _resizeObserverPolyfill = require('resize-observer-polyfill');

var _resizeObserverPolyfill2 = _interopRequireDefault(_resizeObserverPolyfill);

var _restrictedPages = require('./restrictedPages');

var _version = require('./version');

var _version2 = _interopRequireDefault(_version);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var AdsController = function (_EventEmitter) {
    _inherits(AdsController, _EventEmitter);

    function AdsController() {
        _classCallCheck(this, AdsController);

        var _this = _possibleConstructorReturn(this, (AdsController.__proto__ || Object.getPrototypeOf(AdsController)).call(this));

        _this.rotation = [];
        _this.busy = false;
        _this.currentAdsIndex = undefined;
        _this.beganAdsIndex = undefined;
        _this.currentAgency = undefined;

        _this.imaLoader = new _imaLoader2.default();
        _this.imaLoader.once('result', function (result) {
            return _this.setupSequence(result);
        });
        _this.imaLoader.load();

        _this.ro = new _resizeObserverPolyfill2.default(function (entries) {
            _this.onResize();
        });

        _this.isAllowedPage = (0, _restrictedPages.isAllowedCurrentPage)();
        _logger2.default.info('page is allowed', _this.isAllowedPage);
        return _this;
    }

    _createClass(AdsController, [{
        key: 'setupSequence',
        value: function setupSequence(step) {
            _logger2.default.debug('setupSequence step', step);

            if (step === 'imaLoaded' || step === 'imaLoadError') {
                this.imaAvailable = step === 'imaLoaded';
                this.imaStepDone = true;
            }

            if (step === 'configured') {
                this.configStepDone = true;
            }

            if (!this.imaStepDone || !this.configStepDone) {
                return;
            }

            this.createRotation(this.adsList);

            if (!this.adsReady) {
                this.adsReady = true;
                this.emit(_adsEvents.ModuleEvent.Ready, { type: _adsEvents.ModuleEvent.Ready, version: _version2.default });
            }
        }
    }, {
        key: 'setConfig',
        value: function setConfig(config) {
            _logger2.default.debug('set config', config);
            if (!config.channelId) _logger2.default.error('config not contain channelId');

            if (!config.container) {
                _logger2.default.error('config not contain container');
            }

            if (!config.adsList && !config.preset && !this.rotation.length) {
                _logger2.default.error('config not contain ads list or preset');
            }

            _configUtils2.default.config = config;
            this.ro.observe(config.container);

            var settings = void 0;
            if (config.preset) {
                settings = (0, _preset.preset)(config.preset);
            }

            _logger2.default.debug('preset settings', settings);
            if (settings) {
                this.adsList = settings.adsList;
                this.statSender = settings.statSender;
            }

            if (config.adsList && config.adsList.length) {
                this.adsList = config.adsList;
            }

            if (config.events) {
                this.statSender = _manager2.default.getSender(config.events) || this.statSender;
            }

            if (!this.statSender) {
                this.statSender = _manager2.default.emptySender();
            }

            this.isGalka = !!config.hidden;

            this.setupSequence('configured');
        }
    }, {
        key: 'setVolume',
        value: function setVolume(volume) {
            if (volume === undefined || isNaN(volume)) {
                _logger2.default.warn('set volume is', volume);
            }
            volume = volume < 0 ? 0 : volume > 1 ? 1 : volume;
            _configUtils2.default.config.volume = volume;

            if (this.currentAgency) {
                this.currentAgency.setVolume(volume);
            }
        }
    }, {
        key: 'createRotation',
        value: function createRotation(adsList) {
            var _this2 = this;

            this.rotation.length = 0;

            this.busy = false;
            this.currentAdsIndex = undefined;
            this.beganAdsIndex = undefined;
            this.currentAgency = undefined;

            var imaAvailable = this.imaAvailable;
            _logger2.default.debug('imaAvailable', imaAvailable);

            if (!adsList || !adsList.length) {
                return;
            }

            adsList.filter(function (adsConf) {
                return adsConf && adsConf.id && _agencyDict2.default.getAgencyClass(adsConf.id) && adsConf.url;
            }).forEach(function (adsConf) {
                // let agencyClass = BaseAgency.getAgencyClass(adsConf.id);
                var agencyClass = _agencyDict2.default.getAgencyClass(adsConf.id);
                if (!imaAvailable && agencyClass.needIma) {
                    return;
                }

                if (agencyClass.checkRestrited && !_this2.isAllowedPage) {
                    return;
                }

                _logger2.default.debug(adsConf.id, 'agencyClass', agencyClass);
                var agency = new agencyClass(adsConf.url, _this2.isGalka);
                _this2.rotation.push(agency);
            });

            _logger2.default.info('ads rotation created', this.rotation.map(function (a) {
                return a.agency;
            }));
        }
    }, {
        key: 'showAd',
        value: function showAd() {
            if (!this.rotation.length) {
                _logger2.default.warn('ads rotation is empty');
                return;
            }

            if (this.busy) {
                _logger2.default.debug('[DEBUG] adsMod busy');
                return;
            }

            this.busy = true;

            this.currentAdsIndex === undefined ? this.currentAdsIndex = -1 : 0;

            var next = this.nextAgencyIndex();
            this.showAgency(next);
            this.beganAdsIndex = this.currentAdsIndex = next;
            _logger2.default.debug('[DEBUG] show ads started from', this.beganAdsIndex);
        }
    }, {
        key: 'nextAgencyIndex',
        value: function nextAgencyIndex() {
            var nextAdsIndex = this.currentAdsIndex + 1;
            nextAdsIndex = nextAdsIndex >= this.rotation.length ? 0 : nextAdsIndex;
            _logger2.default.debug('[DEBUG]', 'nextAgencyIndex. rotation/current/next', this.rotation.length, this.currentAdsIndex, nextAdsIndex);
            return nextAdsIndex;
        }
    }, {
        key: 'showAgency',
        value: function showAgency(index) {
            var _this3 = this;

            var agency = this.rotation[index];
            this.currentAgency = agency;
            _logger2.default.debug('[DEBUG] showAgency', index, agency.agency);
            _adsEvents.modEvents.forEach(function (event) {
                return agency.on(event, function (e) {
                    return _this3.adsListener(e);
                });
            });
            agency.show(_configUtils2.default.config.container);
        }
    }, {
        key: 'showNextModule',
        value: function showNextModule() {
            _logger2.default.debug('showNextModule call');
            var nextAdsIndex = this.nextAgencyIndex();

            if (nextAdsIndex === this.beganAdsIndex) {
                _logger2.default.debug('showNextModule *. rotation ended');
                this.busy = false;
                this.currentAgency = undefined;
                this.emit(_adsEvents.ModuleEvent.Ended, { type: _adsEvents.ModuleEvent.Ended });
                return;
            }

            this.currentAdsIndex = nextAdsIndex;
            this.showAgency(nextAdsIndex);
        }
    }, {
        key: 'adsListener',
        value: function adsListener(event) {
            _logger2.default.debug('AdsController ads event', event);
            switch (event.type) {
                case _adsEvents.AdsEvent.requestAds:
                    _logger2.default.debug('[DEBUG]', 'Agency', event.ads.agency, 'requested ads', event.source.adtag);
                    break;

                case _adsEvents.AdsEvent.startAds:
                    this.emit(_adsEvents.ModuleEvent.Started, { type: _adsEvents.ModuleEvent.Started, agency: event.ads.agency });
                    break;

                case _adsEvents.AdsEvent.errorAds:
                    _logger2.default.debug('[DEBUG]', 'Agency', event.ads.agency, 'error', event.source.error);
                    while (_configUtils2.default.config.container.firstChild) {
                        _configUtils2.default.config.container.removeChild(_configUtils2.default.config.container.firstChild);
                    }

                    event.ads.destroy();

                    this.showNextModule();
                    break;

                case _adsEvents.AdsEvent.skipAds:
                case _adsEvents.AdsEvent.completeAds:
                    while (_configUtils2.default.config.container.firstChild) {
                        _configUtils2.default.config.container.removeChild(_configUtils2.default.config.container.firstChild);
                    }

                    event.ads.destroy();

                    this.busy = false;
                    this.currentAgency = undefined;
                    this.emit(_adsEvents.ModuleEvent.Ended, { type: _adsEvents.ModuleEvent.Ended });
                    break;
            }

            this.statSender.processEvent(event);
        }
    }, {
        key: 'onResize',
        value: function onResize(event) {
            if (this.currentAgency) {
                _logger2.default.debug('window resize. Ad container dimensions:', _configUtils2.default.config.container.clientWidth, 'x', _configUtils2.default.config.container.clientHeight);
                this.currentAgency.resize(_configUtils2.default.config.container.clientWidth, _configUtils2.default.config.container.clientHeight);
            }
        }
    }, {
        key: 'destroy',
        value: function destroy() {
            if (_configUtils2.default.config.container) {
                while (_configUtils2.default.config.container.firstChild) {
                    _configUtils2.default.config.container.removeChild(_configUtils2.default.config.container.firstChild);
                }
            }

            if (this.currentAgency) {
                this.currentAgency.destroy();
                this.emit(_adsEvents.ModuleEvent.Ended, { type: _adsEvents.ModuleEvent.Ended });
            }

            this.removeAllListeners();

            this.ro.disconnect();

            _configUtils2.default.config = null;

            this.rotation.length = 0;
        }
    }]);

    return AdsController;
}(_events2.default);

exports.default = AdsController;

},{"./adsEvents":22,"./agency/agencyDict":25,"./configUtils":34,"./imaLoader":35,"./logger":36,"./preset":41,"./restrictedPages":42,"./statistic/manager":45,"./version":46,"events":2,"resize-observer-polyfill":3}],22:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var AdsEvent = function () {
    function AdsEvent(type) {
        _classCallCheck(this, AdsEvent);

        this.type = type;

        //let [ads, ...otherArg] = arg;
        //this.ads = ads;

        for (var _len = arguments.length, arg = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
            arg[_key - 1] = arguments[_key];
        }

        switch (type) {
            case AdsEvent.requestAds:
                var adtag = arg[0];

                this.adtag = adtag;
                break;

            case AdsEvent.errorAds:
                var error = arg[0];

                this.error = error;
                break;
        }
    }

    _createClass(AdsEvent, null, [{
        key: 'isValid',
        value: function isValid(type) {
            return modEvents.indexOf(type) != -1;
        }
    }]);

    return AdsEvent;
}();

AdsEvent.requestAds = 'request';
AdsEvent.impressionAds = 'impression';
AdsEvent.startAds = 'start';
AdsEvent.completeAds = 'complete';
AdsEvent.skipAds = 'skip';
AdsEvent.errorAds = 'errorAds';

var modEvents = [AdsEvent.requestAds, AdsEvent.impressionAds, AdsEvent.startAds, AdsEvent.completeAds, AdsEvent.skipAds, AdsEvent.errorAds];

// const playerEvents = ['timeupdate', 'volumechange', 'play', 'pause', 'canplay', 'ended', 'click'];
var playerEvent = {
    timeupdate: 'timeupdate',
    volumechange: 'volumechange',
    play: 'play',
    pause: 'pause',
    canplay: 'canplay',
    ended: 'ended',
    click: 'click',
    error: 'error'

    // const CLIENT_EVENTS = [
    //     'creativeView',
    //     'start', 'firstQuartile', 'midpoint', 'thirdQuartile', 'complete',
    //     'resume', 'pause', 'rewind', 'skip', 'closeLinear', 'close', 'clickthrough'];

};var vastClientEvent = {
    creativeView: 'creativeView',
    start: 'start',
    firstQuartile: 'firstQuartile',
    midpoint: 'midpoint',
    thirdQuartile: 'thirdQuartile',
    complete: 'complete',
    resume: 'resume',
    pause: 'pause',
    rewind: 'rewind',
    skip: 'skip',
    closeLinear: 'closeLinear',
    close: 'close',
    clickthrough: 'clickthrough'
};

var ModuleEvent = {
    Started: 'started',
    Ended: 'ended',
    Ready: 'ready'
};

exports.AdsEvent = AdsEvent;
exports.playerEvent = playerEvent;
exports.vastClientEvent = vastClientEvent;
exports.modEvents = modEvents;
exports.ModuleEvent = ModuleEvent;

},{}],23:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _ima = require('../module/ima');

var _ima2 = _interopRequireDefault(_ima);

var _adsEvents = require('../adsEvents');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var FourMedia = function (_BaseAgency) {
    _inherits(FourMedia, _BaseAgency);

    function FourMedia(adtagTemplate) {
        _classCallCheck(this, FourMedia);

        var _this = _possibleConstructorReturn(this, (FourMedia.__proto__ || Object.getPrototypeOf(FourMedia)).call(this, adtagTemplate));

        _this.agency = '4Media';
        _this.adsModule = new _ima2.default();
        _this.adsModule.midSkip = false;
        _this.adsModule.enableVolumeControll = true;
        return _this;
    }

    _createClass(FourMedia, [{
        key: 'show',
        value: function show(container) {
            var _this2 = this;

            var workerEventListener = function workerEventListener(event) {
                // this.emit(event.type, {type: event.type, ads: this});
                _this2.emit(event.type, { type: event.type, ads: _this2, source: event });
            };

            _adsEvents.modEvents.forEach(function (event) {
                _this2.adsModule.on(event, workerEventListener);
            });

            var adtag = _configUtils2.default.prepareAdtag(this.adtagTemplate);
            this.adsModule.showAd(container, undefined, adtag);
        }
    }, {
        key: 'destroy',
        value: function destroy() {
            _get(FourMedia.prototype.__proto__ || Object.getPrototypeOf(FourMedia.prototype), 'destroy', this).call(this);
            this.adsModule.dispose();
        }
    }]);

    return FourMedia;
}(_base2.default);

exports.default = FourMedia;


FourMedia.needIma = true;

},{"../adsEvents":22,"../configUtils":34,"../logger":36,"../module/ima":39,"./base":26}],24:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _adsEvents = require('../adsEvents');

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _ima = require('../module/ima');

var _ima2 = _interopRequireDefault(_ima);

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Adfox = function (_BaseAgency) {
  _inherits(Adfox, _BaseAgency);

  function Adfox(adtagTemplate) {
    _classCallCheck(this, Adfox);

    var _this = _possibleConstructorReturn(this, (Adfox.__proto__ || Object.getPrototypeOf(Adfox)).call(this, adtagTemplate));

    _this.agency = 'AdFox';
    _this.adsModule = new _ima2.default();
    return _this;
  }

  _createClass(Adfox, [{
    key: 'show',
    value: function show(container) {
      var _this2 = this;

      var workerEventListener = function workerEventListener(event) {
        // this.emit(event.type, {type: event.type, ads: this});
        _this2.emit(event.type, { type: event.type, ads: _this2, source: event });
      };

      _adsEvents.modEvents.forEach(function (event) {
        _this2.adsModule.on(event, workerEventListener);
      });

      var adtag = _configUtils2.default.prepareAdtag(this.adtagTemplate);
      this.adsModule.showAd(container, undefined, adtag);
    }
  }, {
    key: 'destroy',
    value: function destroy() {
      _get(Adfox.prototype.__proto__ || Object.getPrototypeOf(Adfox.prototype), 'destroy', this).call(this);
      this.adsModule.dispose();
    }
  }]);

  return Adfox;
}(_base2.default);

exports.default = Adfox;


Adfox.needIma = true;

},{"../adsEvents":22,"../configUtils":34,"../module/ima":39,"./base":26}],25:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _Media = require('./4Media');

var _Media2 = _interopRequireDefault(_Media);

var _adfox = require('./adfox');

var _adfox2 = _interopRequireDefault(_adfox);

var _goodgame = require('./goodgame');

var _goodgame2 = _interopRequireDefault(_goodgame);

var _instreamvideo = require('./instreamvideo');

var _instreamvideo2 = _interopRequireDefault(_instreamvideo);

var _pladformGPMD = require('./pladformGPMD');

var _pladformGPMD2 = _interopRequireDefault(_pladformGPMD);

var _revive = require('./revive');

var _revive2 = _interopRequireDefault(_revive);

var _videonow = require('./videonow');

var _videonow2 = _interopRequireDefault(_videonow);

var _wmgroup = require('./wmgroup');

var _wmgroup2 = _interopRequireDefault(_wmgroup);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

/*
 1:ADVARK,
 2:INSTREAMVIDEO_VAST,
 3:VIDEONOW_VAST,
 4:REVIVE,
 5:PLADFORM_GPMD,
 6:YOULA,
 7:WEBORAMA,
 8:CHOKOLAD,
 9:LIVERAIL,
 10:FOUR_MEDIA,
 11:VADIDEO,
 12:CONVERTADV,
 13:ALTITUDE,
 //14:ADWISE,
 15:MOE_VIDEO,
 goodgameAdv:GOODGAME_ADV,
 goodgameAdv2:NGOODGAME_ADV
 */
var agency = {
  'adfox': _adfox2.default,
  'revive': _revive2.default,
  'gg': _goodgame2.default,
  '2': _instreamvideo2.default,
  '3': _videonow2.default,
  '5': _pladformGPMD2.default,
  '9': _wmgroup2.default,
  '16': _wmgroup2.default,
  '10': _Media2.default
};

var AgencyDict = function () {
  function AgencyDict() {
    _classCallCheck(this, AgencyDict);
  }

  _createClass(AgencyDict, null, [{
    key: 'getAgencyId',
    value: function getAgencyId(agencyClass) {
      for (var id in agency) {
        var clazz = agency[id];
        if (clazz === agencyClass) {
          return id;
        }
      }
      return undefined;
    }
  }, {
    key: 'getAgencyClass',
    value: function getAgencyClass(agencyId) {
      return agency[agencyId];
    }
  }, {
    key: 'getAgencyName',
    value: function getAgencyName(agencyId) {
      return agency[agencyId].agency;
    }
  }]);

  return AgencyDict;
}();

exports.default = AgencyDict;

},{"./4Media":23,"./adfox":24,"./goodgame":27,"./instreamvideo":28,"./pladformGPMD":29,"./revive":30,"./videonow":31,"./wmgroup":32}],26:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _events = require('events');

var _events2 = _interopRequireDefault(_events);

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var BaseAgency = function (_EventEmitter) {
    _inherits(BaseAgency, _EventEmitter);

    function BaseAgency(adtagTemplate) {
        _classCallCheck(this, BaseAgency);

        var _this = _possibleConstructorReturn(this, (BaseAgency.__proto__ || Object.getPrototypeOf(BaseAgency)).call(this));

        _this.adtagTemplate = adtagTemplate;

        _this.setVolume = function (volume) {
            return _this.adsModule.setVolume(volume);
        };
        return _this;
    }

    _createClass(BaseAgency, [{
        key: 'show',
        value: function show(container) {}
    }, {
        key: 'resize',
        value: function resize(width, height) {
            this.adsModule.resize(width, height);
        }
    }, {
        key: 'destroy',
        value: function destroy() {
            this.removeAllListeners();
            _logger2.default.debug('Agency', this.agency, 'clear event listeners');
        }
    }]);

    return BaseAgency;
}(_events2.default);

exports.default = BaseAgency;

},{"../logger":36,"events":2}],27:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _adsEvents = require('../adsEvents');

var _ggDirect = require('../module/ggDirect');

var _ggDirect2 = _interopRequireDefault(_ggDirect);

var _gg = require('../view/gg');

var _gg2 = _interopRequireDefault(_gg);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Goodgame = function (_BaseAgency) {
    _inherits(Goodgame, _BaseAgency);

    function Goodgame(adtagTemplate) {
        _classCallCheck(this, Goodgame);

        var _this = _possibleConstructorReturn(this, (Goodgame.__proto__ || Object.getPrototypeOf(Goodgame)).call(this, adtagTemplate));

        _this.agency = 'goodgame';
        _this.adsModule = new _ggDirect2.default();
        _this.adsModule.view = _gg2.default.getInstance();
        return _this;
    }

    _createClass(Goodgame, [{
        key: 'show',
        value: function show(container) {
            var _this2 = this;

            var workerEventListener = function workerEventListener(event) {
                // Logger.debug(this.agency, 'worker event', event, 'this', this);
                _this2.emit(event.type, { type: event.type, ads: _this2, source: event });
            };

            _adsEvents.modEvents.forEach(function (event) {
                _this2.adsModule.on(event, workerEventListener);
            });

            var adtag = _configUtils2.default.prepareAdtag(this.adtagTemplate);
            // adtag = adtag.replace('/', '\/').replace('#', '%23');
            this.adsModule.showAd(container, undefined, adtag);
        }
    }, {
        key: 'destroy',
        value: function destroy() {
            _get(Goodgame.prototype.__proto__ || Object.getPrototypeOf(Goodgame.prototype), 'destroy', this).call(this);
            this.adsModule.dispose();
        }
    }]);

    return Goodgame;
}(_base2.default);

exports.default = Goodgame;


Goodgame.needIma = false;

},{"../adsEvents":22,"../configUtils":34,"../logger":36,"../module/ggDirect":38,"../view/gg":48,"./base":26}],28:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _ima = require('../module/ima');

var _ima2 = _interopRequireDefault(_ima);

var _adsEvents = require('../adsEvents');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var InstreamVideo = function (_BaseAgency) {
    _inherits(InstreamVideo, _BaseAgency);

    function InstreamVideo(adtagTemplate) {
        _classCallCheck(this, InstreamVideo);

        var _this = _possibleConstructorReturn(this, (InstreamVideo.__proto__ || Object.getPrototypeOf(InstreamVideo)).call(this, adtagTemplate));

        _this.agency = 'InstreamVideo';
        _this.adsModule = new _ima2.default();
        // this.adsModule.midSkip = true; // TODO
        return _this;
    }

    _createClass(InstreamVideo, [{
        key: 'show',
        value: function show(container) {
            var _this2 = this;

            var workerEventListener = function workerEventListener(event) {
                // this.emit(event.type, {type: event.type, ads: this});
                _this2.emit(event.type, { type: event.type, ads: _this2, source: event });
            };

            _adsEvents.modEvents.forEach(function (event) {
                _this2.adsModule.on(event, workerEventListener);
            });

            var adtag = _configUtils2.default.prepareAdtag(this.adtagTemplate);
            this.adsModule.showAd(container, undefined, adtag);
        }
    }, {
        key: 'destroy',
        value: function destroy() {
            _get(InstreamVideo.prototype.__proto__ || Object.getPrototypeOf(InstreamVideo.prototype), 'destroy', this).call(this);
            this.adsModule.dispose();
        }
    }]);

    return InstreamVideo;
}(_base2.default);

exports.default = InstreamVideo;


InstreamVideo.needIma = true;

},{"../adsEvents":22,"../configUtils":34,"../logger":36,"../module/ima":39,"./base":26}],29:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _ima = require('../module/ima');

var _ima2 = _interopRequireDefault(_ima);

var _adsEvents = require('../adsEvents');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var PladformGPMD = function (_BaseAgency) {
    _inherits(PladformGPMD, _BaseAgency);

    function PladformGPMD(adtagTemplate) {
        _classCallCheck(this, PladformGPMD);

        var _this = _possibleConstructorReturn(this, (PladformGPMD.__proto__ || Object.getPrototypeOf(PladformGPMD)).call(this, adtagTemplate));

        _this.agency = 'PladformGPMD';
        _this.adsModule = new _ima2.default();
        return _this;
    }

    _createClass(PladformGPMD, [{
        key: 'show',
        value: function show(container) {
            var _this2 = this;

            var workerEventListener = function workerEventListener(event) {
                // this.emit(event.type, {type: event.type, ads: this});
                _this2.emit(event.type, { type: event.type, ads: _this2, source: event });
            };

            _adsEvents.modEvents.forEach(function (event) {
                _this2.adsModule.on(event, workerEventListener);
            });

            var adtag = _configUtils2.default.prepareAdtag(this.adtagTemplate);
            this.adsModule.showAd(container, undefined, adtag);
        }
    }, {
        key: 'destroy',
        value: function destroy() {
            _get(PladformGPMD.prototype.__proto__ || Object.getPrototypeOf(PladformGPMD.prototype), 'destroy', this).call(this);
            this.adsModule.dispose();
        }
    }]);

    return PladformGPMD;
}(_base2.default);

exports.default = PladformGPMD;


PladformGPMD.needIma = true;
PladformGPMD.checkRestrited = true;

},{"../adsEvents":22,"../configUtils":34,"../logger":36,"../module/ima":39,"./base":26}],30:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _revive = require('../module/revive');

var _revive2 = _interopRequireDefault(_revive);

var _adsEvents = require('../adsEvents');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Revive = function (_BaseAgency) {
    _inherits(Revive, _BaseAgency);

    function Revive(adtagTemplate) {
        _classCallCheck(this, Revive);

        var _this = _possibleConstructorReturn(this, (Revive.__proto__ || Object.getPrototypeOf(Revive)).call(this, adtagTemplate));

        _this.agency = 'revive';
        _this.adsModule = new _revive2.default();
        return _this;
    }

    _createClass(Revive, [{
        key: 'show',
        value: function show(container) {
            var _this2 = this;

            var workerEventListener = function workerEventListener(event) {
                // Logger.debug(this.agency, 'worker event', event, 'this', this);
                _this2.emit(event.type, { type: event.type, ads: _this2, source: event });
            };

            _adsEvents.modEvents.forEach(function (event) {
                _this2.adsModule.on(event, workerEventListener);
            });

            var adtag = _configUtils2.default.prepareAdtag(this.adtagTemplate);
            adtag = adtag.replace('/', '\/').replace('#', '%23');
            this.adsModule.showAd(container, undefined, adtag);
        }
    }, {
        key: 'destroy',
        value: function destroy() {
            _get(Revive.prototype.__proto__ || Object.getPrototypeOf(Revive.prototype), 'destroy', this).call(this);
            this.adsModule.dispose();
        }
    }]);

    return Revive;
}(_base2.default);

exports.default = Revive;


Revive.needIma = false;

},{"../adsEvents":22,"../configUtils":34,"../logger":36,"../module/revive":40,"./base":26}],31:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _ima = require('../module/ima');

var _ima2 = _interopRequireDefault(_ima);

var _adsEvents = require('../adsEvents');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var Videonow = function (_BaseAgency) {
    _inherits(Videonow, _BaseAgency);

    function Videonow(adtagTemplate) {
        _classCallCheck(this, Videonow);

        var _this = _possibleConstructorReturn(this, (Videonow.__proto__ || Object.getPrototypeOf(Videonow)).call(this, adtagTemplate));

        _this.agency = 'VideoNow';
        _this.adsModule = new _ima2.default();
        return _this;
    }

    _createClass(Videonow, [{
        key: 'show',
        value: function show(container) {
            var _this2 = this;

            var workerEventListener = function workerEventListener(event) {
                // this.emit(event.type, {type: event.type, ads: this});
                _this2.emit(event.type, { type: event.type, ads: _this2, source: event });
            };

            _adsEvents.modEvents.forEach(function (event) {
                _this2.adsModule.on(event, workerEventListener);
            });

            var adtag = _configUtils2.default.prepareAdtag(this.adtagTemplate);
            this.adsModule.showAd(container, undefined, adtag);
        }
    }, {
        key: 'destroy',
        value: function destroy() {
            _get(Videonow.prototype.__proto__ || Object.getPrototypeOf(Videonow.prototype), 'destroy', this).call(this);
            this.adsModule.dispose();
        }
    }]);

    return Videonow;
}(_base2.default);

exports.default = Videonow;


Videonow.needIma = true;

},{"../adsEvents":22,"../configUtils":34,"../logger":36,"../module/ima":39,"./base":26}],32:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _ima = require('../module/ima');

var _ima2 = _interopRequireDefault(_ima);

var _adsEvents = require('../adsEvents');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var WMGroup = function (_BaseAgency) {
    _inherits(WMGroup, _BaseAgency);

    function WMGroup(adtagTemplate) {
        _classCallCheck(this, WMGroup);

        var _this = _possibleConstructorReturn(this, (WMGroup.__proto__ || Object.getPrototypeOf(WMGroup)).call(this, adtagTemplate));

        _this.agency = 'WMGroup';
        _this.adsModule = new _ima2.default();
        _this.adsModule.midSkip = false;
        return _this;
    }

    _createClass(WMGroup, [{
        key: 'show',
        value: function show(container) {
            var _this2 = this;

            var workerEventListener = function workerEventListener(event) {
                // this.emit(event.type, {type: event.type, ads: this});
                _this2.emit(event.type, { type: event.type, ads: _this2, source: event });
            };

            _adsEvents.modEvents.forEach(function (event) {
                _this2.adsModule.on(event, workerEventListener);
            });

            var adtag = _configUtils2.default.prepareAdtag(this.adtagTemplate);
            this.adsModule.showAd(container, undefined, adtag);
        }
    }, {
        key: 'destroy',
        value: function destroy() {
            _get(WMGroup.prototype.__proto__ || Object.getPrototypeOf(WMGroup.prototype), 'destroy', this).call(this);
            this.adsModule.dispose();
        }
    }]);

    return WMGroup;
}(_base2.default);

exports.default = WMGroup;


WMGroup.needIma = true;

},{"../adsEvents":22,"../configUtils":34,"../logger":36,"../module/ima":39,"./base":26}],33:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
function hide() {
    this.style.visibility = 'hidden';
}

function show() {
    this.style.visibility = '';
}

var createSkip = function createSkip() {
    var skipButton = document.createElement('img');
    skipButton.src = 'data:image/png;base64,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';
    skipButton.id = 'adsSkipButton';
    skipButton.style.position = 'absolute';
    skipButton.style.top = '10px';
    skipButton.style.right = '10px';
    skipButton.style.width = '32px';
    skipButton.style.height = '32px';
    skipButton.style.cursor = 'pointer';
    skipButton.style.visibility = 'hidden';
    skipButton.style.zIndex = 16777270;
    skipButton.ondragstart = function () {
        return false;
    };
    skipButton.show = show;
    skipButton.hide = hide;
    return skipButton;
};

var createPlay = function createPlay() {
    var playButton = document.createElement('img');

    playButton.src = 'data:image/png;base64,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';
    playButton.style.position = 'absolute';
    playButton.style.left = '50%';
    playButton.style.top = '50%';
    playButton.style.transform = 'translate(-50%, -50%)';
    playButton.style.cursor = 'pointer';
    playButton.style.visibility = 'hidden';
    playButton.style.zIndex = 16777270;
    playButton.ondragstart = function () {
        return false;
    };
    playButton.show = show;
    playButton.hide = hide;
    return playButton;
};

var createVolume = function createVolume(volume, volumeCallback) {
    var volumeControll = document.createElement('div');
    volumeControll.style.width = '32px';
    volumeControll.style.bottom = '10px';
    volumeControll.style.right = '10px';
    volumeControll.style.position = 'absolute';

    var sliderContainer = document.createElement('div');
    sliderContainer.style.position = 'absolute';
    sliderContainer.style.bottom = '32px';
    sliderContainer.style.width = '32px';
    sliderContainer.style.height = '120px';
    sliderContainer.style.backgroundColor = 'rgba(28, 34, 28, 0.75)';
    sliderContainer.style.visibility = 'hidden';
    sliderContainer.ondragstart = function () {
        return false;
    };

    volumeControll.appendChild(sliderContainer);

    var volumeSlider = document.createElement('div');
    volumeSlider.style.position = 'relative';
    volumeSlider.style.width = '10px';
    volumeSlider.style.height = '100px';
    volumeSlider.style.margin = '10px auto';
    volumeSlider.style.border = '#fff 1px solid';
    volumeSlider.style.opacity = 0.8;
    volumeSlider.style.cursor = 'pointer';
    volumeSlider.ondragstart = function () {
        return false;
    };

    sliderContainer.appendChild(volumeSlider);

    var sliderBar = document.createElement('span');
    sliderBar.style.width = '100%';
    sliderBar.style.display = 'block';
    sliderBar.style.position = 'absolute';
    sliderBar.style.bottom = '0px';
    sliderBar.style.backgroundColor = '#DDDCCF';

    volumeSlider.appendChild(sliderBar);

    var muteButton = document.createElement('img');
    muteButton.style.width = '32px';
    muteButton.style.height = '32px';
    muteButton.style.bottom = '0px';
    muteButton.style.position = 'absolute';
    muteButton.style.backgroundColor = '#1C221C';
    muteButton.style.opacity = 0.75;
    muteButton.style.cursor = 'pointer';
    muteButton.style.userSelect = 'none';
    muteButton.src = 'data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjEyOHB4IiBoZWlnaHQ9IjEyOHB4IiB2aWV3Qm94PSIwIDAgNDYxLjU1IDQ2MS41NSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDYxLjU1IDQ2MS41NTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8Zz4KCTxnIGlkPSJ2b2x1bWUtb2ZmIj4KCQk8cGF0aCBkPSJNMzQ1LjUyNSwyMjkuNWMwLTQ1LjktMjUuNS04NC4xNS02My43NS0xMDJ2NTYuMWw2My43NSw2My43NUMzNDUuNTI1LDIzOS43LDM0NS41MjUsMjM0LjYsMzQ1LjUyNSwyMjkuNXogTTQwOS4yNzUsMjI5LjUgICAgYzAsMjIuOTUtNS4xLDQ1LjktMTIuNzUsNjYuM2wzOC4yNSwzOC4yNWMxNy44NS0zMC42LDI1LjUtNjguODUsMjUuNS0xMDcuMWMwLTEwOS42NS03Ni41LTIwMS40NS0xNzguNS0yMjQuNFY1Ni4xICAgIEMzNTUuNzI1LDgxLjYsNDA5LjI3NSwxNDcuOSw0MDkuMjc1LDIyOS41eiBNMzQuNDI1LDBMMS4yNzUsMzMuMTVMMTIxLjEyNSwxNTNIMS4yNzV2MTUzaDEwMmwxMjcuNSwxMjcuNVYyNjIuNjVMMzQwLjQyNSwzNzIuMyAgICBjLTE3Ljg1MSwxMi43NS0zNS43LDIyLjk1LTU4LjY1LDMwLjYwMXY1My41NWMzNS43LTcuNjUsNjYuMy0yMi45NSw5NC4zNS00NS45bDUxLDUxbDMzLjE1LTMzLjE0OWwtMjI5LjUtMjI5LjVMMzQuNDI1LDB6ICAgICBNMjMwLjc3NSwyNS41bC01My41NSw1My41NWw1My41NSw1My41NVYyNS41eiIgZmlsbD0iI0ZGRkZGRiIvPgoJPC9nPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+CjxnPgo8L2c+Cjwvc3ZnPgo=';
    muteButton.ondragstart = function () {
        return false;
    };

    volumeControll.appendChild(muteButton);
    muteButton.style.display = 'none';

    var unmuteButton = document.createElement('img');
    unmuteButton.style.width = '32px';
    unmuteButton.style.height = '32px';
    unmuteButton.style.bottom = '0px';
    unmuteButton.style.position = 'absolute';
    unmuteButton.style.backgroundColor = '#1C221C';
    unmuteButton.style.opacity = 0.75;
    unmuteButton.style.cursor = 'pointer';
    unmuteButton.style.userSelect = 'none';
    unmuteButton.src = 'data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTYuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIgImh0dHA6Ly93d3cudzMub3JnL0dyYXBoaWNzL1NWRy8xLjEvRFREL3N2ZzExLmR0ZCI+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgd2lkdGg9IjEyOHB4IiBoZWlnaHQ9IjEyOHB4IiB2aWV3Qm94PSIwIDAgNDU5IDQ1OSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDU5IDQ1OTsiIHhtbDpzcGFjZT0icHJlc2VydmUiPgo8Zz4KCTxnIGlkPSJ2b2x1bWUtdXAiPgoJCTxwYXRoIGQ9Ik0wLDE1M3YxNTNoMTAybDEyNy41LDEyNy41di00MDhMMTAyLDE1M0gweiBNMzQ0LjI1LDIyOS41YzAtNDUuOS0yNS41LTg0LjE1LTYzLjc1LTEwMnYyMDQgICAgQzMxOC43NSwzMTMuNjUsMzQ0LjI1LDI3NS40LDM0NC4yNSwyMjkuNXogTTI4MC41LDUuMXY1My41NUMzNTQuNDUsODEuNiw0MDgsMTQ3Ljg5OSw0MDgsMjI5LjVTMzU0LjQ1LDM3Ny40LDI4MC41LDQwMC4zNVY0NTMuOSAgICBDMzgyLjUsNDMwLjk0OSw0NTksMzM5LjE1LDQ1OSwyMjkuNUM0NTksMTE5Ljg1LDM4Mi41LDI4LjA0OSwyODAuNSw1LjF6IiBmaWxsPSIjRkZGRkZGIi8+Cgk8L2c+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPC9zdmc+Cg==';
    unmuteButton.ondragstart = function () {
        return false;
    };

    volumeControll.appendChild(unmuteButton);

    var muteClick = function muteClick(e) {
        // console.log('muteUnmute click. mute', muteButton.style.display === 'none');
        if (muteButton.style.display === 'none') {
            muteButton.style.display = 'block';
            unmuteButton.style.display = 'none';

            if (volumeCallback) {
                volumeCallback(0);
            }
        } else {
            muteButton.style.display = 'none';
            unmuteButton.style.display = 'block';

            if (volumeCallback) {
                volumeCallback(currentVolume);
            }
        }
    };

    unmuteButton.onclick = muteClick;
    muteButton.onclick = muteClick;

    var currentVolume = volume;

    var changeVolume = function changeVolume(vol) {
        var val = vol > 1 ? 1 : vol < 0 ? 0 : vol;
        sliderBar.style.height = 100 * val + '%';
        currentVolume = val;
    };

    var onHover = function onHover(e) {
        e.type === 'mouseover' ? sliderContainer.style.visibility = 'visible' : sliderContainer.style.visibility = 'hidden';
    };

    volumeControll.onmouseover = onHover;
    volumeControll.onmouseout = onHover;

    var updateVolume = function updateVolume(y) {
        var pos = volumeSlider.getBoundingClientRect().bottom - y;
        var val = pos / volumeSlider.offsetHeight;
        val = val > 1 ? 1 : val < 0 ? 0 : val;
        sliderBar.style.height = 100 * val + '%';
        currentVolume = val;

        muteButton.style.display = 'none';
        unmuteButton.style.display = 'block';

        if (volumeCallback) {
            volumeCallback(val);
        }
    };

    var mouseMove = function mouseMove(e) {
        updateVolume(e.clientY);
    };

    var mouseUp = function mouseUp(e) {
        document.removeEventListener('mouseup', mouseUp);
        document.removeEventListener('mousemove', mouseMove);
        updateVolume(e.clientY);
    };

    volumeSlider.addEventListener('mousedown', function (e) {
        document.addEventListener('mouseup', mouseUp);
        document.addEventListener('mousemove', mouseMove);
        updateVolume(e.clientY);
    });

    volumeControll.change = changeVolume;
    changeVolume(currentVolume);

    return volumeControll;
};

exports.createSkip = createSkip;
exports.createPlay = createPlay;
exports.createVolume = createVolume;

},{}],34:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _logger = require('./logger');

var _logger2 = _interopRequireDefault(_logger);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var config = {};
var adtagVars = {};
// settings adtagvars
// {{PAGE_URL}}
Object.defineProperty(adtagVars, 'PAGE_URL', {
    configurable: true,
    enumerable: true,
    get: function get() {
        return encodeURIComponent(window.location.href);
    }
});
// {{DOMAIN}} - current domain
Object.defineProperty(adtagVars, 'DOMAIN', {
    configurable: true,
    enumerable: true,
    get: function get() {
        var domain = window.location.href ? window.location.href.match(/http[s]?:\/\/(?:www\.)?([--\-\.\w]*)[\/\?]?/)[1] : 'null';
        return domain;
    }
});
// {{CHANNEL_ID}}
Object.defineProperty(adtagVars, 'CHANNEL_ID', {
    configurable: true,
    enumerable: true,
    get: function get() {
        return encodeURIComponent(config.channelId);
    }
});
// {{WIDTH}}
Object.defineProperty(adtagVars, 'WIDTH', {
    configurable: true,
    enumerable: true,
    get: function get() {
        return config.container.offsetWidth;
    }
});
// {{HEIGHT}}
Object.defineProperty(adtagVars, 'HEIGHT', {
    configurable: true,
    enumerable: true,
    get: function get() {
        return config.container.offsetHeight;
    }
});
// {{CB}} - cachebuster, rnd, timestamp
Object.defineProperty(adtagVars, 'CB', {
    configurable: true,
    enumerable: true,
    get: function get() {
        return Date.now();
    }
});

var ConfigUtil = function () {
    function ConfigUtil() {
        _classCallCheck(this, ConfigUtil);
    }

    _createClass(ConfigUtil, null, [{
        key: 'prepareTemplate',
        value: function prepareTemplate(template, additionVars) {
            var result = template;
            _logger2.default.debug('[debug] prepare template. input:', result);
            for (var name in adtagVars) {
                _logger2.default.debug('[debug] replace', '{{' + name + '}}', adtagVars[name]);
                result = result.replace(new RegExp('\{\{' + name + '\}\}', 'ig'), adtagVars[name]);
            }

            if (additionVars) {
                for (var _name in additionVars) {
                    _logger2.default.debug('[debug] addition replace', '{{' + _name + '}}', additionVars[_name]);
                    result = result.replace(new RegExp('\{\{' + _name + '\}\}', 'ig'), additionVars[_name]);
                }
            }

            _logger2.default.debug('[debug] prepare template. result:', result);
            return result;
        }
    }, {
        key: 'prepareAdtag',
        value: function prepareAdtag(adtagTemplate) {
            return this.prepareTemplate(adtagTemplate);
        }
    }, {
        key: 'config',
        set: function set(_config) {
            config = _config;
        },
        get: function get() {
            return config;
        }
    }, {
        key: 'adtagVars',
        get: function get() {
            return adtagVars;
        }
    }]);

    return ConfigUtil;
}();

exports.default = ConfigUtil;

},{"./logger":36}],35:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _events = require('events');

var _events2 = _interopRequireDefault(_events);

var _logger = require('./logger');

var _logger2 = _interopRequireDefault(_logger);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var requirejs = require('reqjs');

try {
    var _requirejs = require('reqjs');
    _requirejs.config({
        paths: {
            'imasdk': '//imasdk.googleapis.com/js/sdkloader/ima3'
            // 'imasdk': '//imasdk.googleapis.com/js/sdkloader/ima3_debug'
        },
        shim: {
            'imasdk': {
                exports: 'google'
            }
        },
        waitSeconds: 10
    });
} catch (err) {
    _logger2.default.debug('google ima error', err);
}

var googleIma = undefined;

var ImaLoader = function (_EventEmitter) {
    _inherits(ImaLoader, _EventEmitter);

    function ImaLoader() {
        _classCallCheck(this, ImaLoader);

        return _possibleConstructorReturn(this, (ImaLoader.__proto__ || Object.getPrototypeOf(ImaLoader)).apply(this, arguments));
    }

    _createClass(ImaLoader, [{
        key: 'load',
        value: function load() {
            var _this2 = this;

            requirejs(['imasdk'], function (google) {
                _logger2.default.debug('ImaLoader', google);
                googleIma = google;
                _this2.emit('result', 'imaLoaded');
            }, function (error) {
                _logger2.default.debug('ImaLoader error', error);
                _this2.emit('result', 'imaLoadError');
            });
        }
    }], [{
        key: 'getGoogleIma',
        value: function getGoogleIma() {
            return googleIma;
        }
    }]);

    return ImaLoader;
}(_events2.default);

exports.default = ImaLoader;

},{"./logger":36,"events":2,"reqjs":1}],36:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var showMessage = window.location.hostname === 'localhost' || document.cookie.indexOf('ads_log=1') != -1;

var Logger = function () {
    function Logger() {
        _classCallCheck(this, Logger);
    }

    _createClass(Logger, null, [{
        key: 'debug',
        value: function debug() {
            for (var _len = arguments.length, arg = Array(_len), _key = 0; _key < _len; _key++) {
                arg[_key] = arguments[_key];
            }

            if (showMessage) this.message('debug', arg);
        }
    }, {
        key: 'info',
        value: function info() {
            for (var _len2 = arguments.length, arg = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
                arg[_key2] = arguments[_key2];
            }

            if (showMessage) this.message('info', arg);
        }
    }, {
        key: 'warn',
        value: function warn() {
            for (var _len3 = arguments.length, arg = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
                arg[_key3] = arguments[_key3];
            }

            this.message('warn', arg);
        }
    }, {
        key: 'error',
        value: function error() {
            for (var _len4 = arguments.length, arg = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {
                arg[_key4] = arguments[_key4];
            }

            this.message('error', arg);
        }
    }, {
        key: 'message',
        value: function message(level, data) {
            console[level].apply(this, data);
        }
    }]);

    return Logger;
}();

exports.default = Logger;

},{}],37:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _events = require('events');

var _events2 = _interopRequireDefault(_events);

var _adsEvents = require('../adsEvents');

var _default = require('../view/default');

var _default2 = _interopRequireDefault(_default);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var moduleVolume = 0;

var BaseModule = function (_EventEmitter) {
    _inherits(BaseModule, _EventEmitter);

    function BaseModule() {
        _classCallCheck(this, BaseModule);

        var _this = _possibleConstructorReturn(this, (BaseModule.__proto__ || Object.getPrototypeOf(BaseModule)).call(this));

        _this.view = _default2.default.getInstance();
        return _this;
    }

    _createClass(BaseModule, [{
        key: 'request',
        value: function request(adtag) {
            // super.emit('requestAds', 'requestAds');
            _get(BaseModule.prototype.__proto__ || Object.getPrototypeOf(BaseModule.prototype), 'emit', this).call(this, _adsEvents.AdsEvent.requestAds, new _adsEvents.AdsEvent(_adsEvents.AdsEvent.requestAds, adtag));
        }
    }, {
        key: 'impression',
        value: function impression() {
            _get(BaseModule.prototype.__proto__ || Object.getPrototypeOf(BaseModule.prototype), 'emit', this).call(this, _adsEvents.AdsEvent.impressionAds, new _adsEvents.AdsEvent(_adsEvents.AdsEvent.impressionAds));
        }
    }, {
        key: 'start',
        value: function start() {
            _get(BaseModule.prototype.__proto__ || Object.getPrototypeOf(BaseModule.prototype), 'emit', this).call(this, _adsEvents.AdsEvent.startAds, new _adsEvents.AdsEvent(_adsEvents.AdsEvent.startAds));
        }
    }, {
        key: 'complete',
        value: function complete() {
            _get(BaseModule.prototype.__proto__ || Object.getPrototypeOf(BaseModule.prototype), 'emit', this).call(this, _adsEvents.AdsEvent.completeAds, new _adsEvents.AdsEvent(_adsEvents.AdsEvent.completeAds));
        }
    }, {
        key: 'skip',
        value: function skip() {
            _get(BaseModule.prototype.__proto__ || Object.getPrototypeOf(BaseModule.prototype), 'emit', this).call(this, _adsEvents.AdsEvent.skipAds, new _adsEvents.AdsEvent(_adsEvents.AdsEvent.skipAds));
        }
    }, {
        key: 'error',
        value: function error(_error) {
            _get(BaseModule.prototype.__proto__ || Object.getPrototypeOf(BaseModule.prototype), 'emit', this).call(this, _adsEvents.AdsEvent.errorAds, new _adsEvents.AdsEvent(_adsEvents.AdsEvent.errorAds, _error));
        }
    }, {
        key: 'resize',
        value: function resize(width, height) {}
    }, {
        key: 'dispose',
        value: function dispose() {
            this.removeAllListeners();
        }
    }], [{
        key: 'createPlayer',
        value: function createPlayer() {
            var adsPlayer = document.createElement('video');
            adsPlayer.style.display = 'block';
            adsPlayer.style.width = '100%';
            adsPlayer.style.height = '100%';
            adsPlayer.style.backgroundColor = 'black';

            adsPlayer.style.position = 'relative';
            adsPlayer.style.top = '0px';
            adsPlayer.style.left = '0px';
            adsPlayer.style.right = '0px';
            adsPlayer.style.bottom = '0px';
            return adsPlayer;
        }
    }, {
        key: 'volume',
        set: function set(volume) {
            moduleVolume = volume;
        },
        get: function get() {
            return moduleVolume;
        }
    }]);

    return BaseModule;
}(_events2.default);

exports.default = BaseModule;

},{"../adsEvents":22,"../view/default":47,"events":2}],38:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _revive = require('../module/revive');

var _revive2 = _interopRequireDefault(_revive);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var vastTemplate = '<VAST version="3.0">\n    <Ad id="pre-roll" sequence="1">\n        <InLine>\n            <AdSystem>GoodGameVideoAdvert by JIEgOKOJI</AdSystem>\n            <AdTitle>crs2</AdTitle>\n            <Description>Inline Video Ad</Description>\n            <Impression id="secondaryAdServer"><![CDATA[{{IMPRESSION}}]]></Impression>\n            <Creatives>\n                <Creative>\n                    <Linear>\n                        <Duration>{{DURATION}}</Duration>\n                            <TrackingEvents></TrackingEvents>\n                            <VideoClicks>\n                                <ClickThrough><![CDATA[{{CLICK}}]]></ClickThrough>\n                            </VideoClicks>\n                            <MediaFiles>\n                                <MediaFile delivery="progressive" bitrate="400" width="640" height="480" type="video/x-mp4">\n                                <![CDATA[{{MEDIA}}]]>\n                                </MediaFile>\n                            </MediaFiles>\n                    </Linear>\n                </Creative>\n            </Creatives>\n        </InLine>\n    </Ad>\n</VAST>';

var LS_ITEM = 'ggplayer_priority_debug';

var TIME_THRESHOLD = 60 * 60 * 24 * 1000;
// const TIME_THRESHOLD = 60 * 2* 1000;

var mockResp = {
    impression: 'http://h1s.goodgame.ru/del/lgg.php?bid=184&amp;campaignid=25&amp;zid=12&amp;source={\&amp;quot;sequence\&amp;quot;:1,\&amp;quot;site_url\&amp;quot;:\&amp;quot;goodgame.ru\&amp;quot;,\&amp;quot;page_url\&amp;quot;:\&amp;quot;{{PAGE_URL}}\&amp;quot;,\&amp;quot;stremer\&amp;quot;:\&amp;quot;{{CHANNEL_ID}}\&amp;quot;}&amp;OASCCAP=2&amp;loc=1&amp;cb=126befb9b1',
    duration: '00:00:19',
    click: 'http://h1s.goodgame.ru/del/ck.php?oaparams=2__bid=184__zid=12__source=%7B%5C%26quot%3Bsequence%5C%26quot%3B%3A1%2C%5C%26quot%3Bsite_url%5C%26quot%3B%3A%5C%26quot%3Bgoodgame.ru%5C%26quot%3B%2C%5C%26quot%3Bpage_url%5C%26quot%3B%3A%5C%26quot%3B%7B%7BPAGE_URL%7D%7D%5C%26quot%3B%2C%5C%26quot%3Bstremer%5C%26quot%3B%3A%5C%26quot%3B%7B%7BCHANNEL_ID%7D%7D%5C%26quot%3B%7D__cb=126befb9b1__oadest=https%3A%2F%2Fvk.cc%2F6Pn2cG',
    // video: 'http://storage2.goodgame.ru/partvid/summet_Crossout2.mp4'
    video: '//1sxwhbnh.goodgame.ru/1sxwhbnh/1sxwhbnh1.gif'
};

var prepareLink = function prepareLink(link) {
    if (link === undefined) return null;

    return _configUtils2.default.prepareAdtag(link.toString());
};

var genNextAdtag = function genNextAdtag(adtag, d) {
    var host = adtag.match(/^(http[s]?:\/\/|\/\/)([\w.-]*)(\/.*)?\/?$/).splice(1, 2).join('');
    host += '/';
    d = d || 1;
    for (var i = 0; i < d; i++) {
        var max = Math.floor(Math.random() * 9) + 8;
        var part = Math.floor(Math.random() * (Number('1e+' + max) - 1e+8)) + 1e+8;
        host += part.toString(36) + '/';
    }

    return host;
};

var MAX_RETRY = 5;

var adtags = ["bKQ3`KN5Oz:ma1:hY1EwYP6zgP:tZ[owYT63`z:mY2:t`n:iY[MyOt>>", "bKQ3`KN5Oz:ma1:hY1EwYP6zgP:kbnE7O0UyY[Ju", "bKQ3`KN5Oz:ma1:hY1EwYP6zgP:kbnE7O0AuaDtu", "bKQ3`KN5Oz:ma1:hY1EwYP6zgP:uZ[U3b@:kg[QlOt>>", "bKQ3`KN5Oz:ma1:hY1EwYP6zgP:t`nUwb[UwO1wofTgoaj;>"];

var clipsList = [1, 2, 3];

var GoodgameDirect = function (_Revive) {
    _inherits(GoodgameDirect, _Revive);

    function GoodgameDirect() {
        _classCallCheck(this, GoodgameDirect);

        var _this = _possibleConstructorReturn(this, (GoodgameDirect.__proto__ || Object.getPrototypeOf(GoodgameDirect)).call(this));

        _this.clipsData = undefined;
        _this.retry = MAX_RETRY;
        _this.aTags = Array.from(adtags);
        return _this;
    }

    _createClass(GoodgameDirect, [{
        key: 'getClipsFromStore',
        value: function getClipsFromStore() {
            var defaultData = { ts: Date.now(), list: clipsList.slice(0) };

            if (typeof localStorage === 'undefined') {
                return defaultData;
            }

            var value = localStorage.getItem(LS_ITEM);
            try {
                if (!value) return defaultData;

                var data = JSON.parse(value);
                if (!data.ts && typeof data.ts !== 'number') throw 1;

                if (!data.list) throw 2;

                if (Date.now() - data.ts >= TIME_THRESHOLD) {
                    return defaultData;
                }

                return data;
            } catch (err) {
                _logger2.default.warn('local store data is wrong. Case: ' + err + '. Use default');
                return defaultData;
            }
        }
    }, {
        key: 'setClipToStore',
        value: function setClipToStore() {
            if (typeof localStorage === 'undefined') return;

            localStorage.setItem(LS_ITEM, JSON.stringify(this.clipsData));
        }
    }, {
        key: 'onCreateView',
        value: function onCreateView() {
            this.setClipToStore();
            _get(GoodgameDirect.prototype.__proto__ || Object.getPrototypeOf(GoodgameDirect.prototype), 'onCreateView', this).call(this);
        }
    }, {
        key: 'showAd',
        value: function showAd(adsContainer, adsPlayer, adtag) {
            var _this2 = this;

            this.adsContainer = adsContainer;
            this.adsPlayer = adsPlayer;

            new Promise(function (res, rej) {

                _this2.clipsData = _this2.getClipsFromStore();
                var index = _this2.clipsData.list.shift();

                // if (!index) {
                //     index = 7;
                // }

                if (!index || clipsList.indexOf(index) < 0) {
                    throw 'now all show ads is over!';
                }

                var xhr = new XMLHttpRequest();
                xhr.open('post', adtag, true);
                xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');
                xhr.onload = function () {
                    return res(xhr.response);
                };
                xhr.onerror = function () {
                    return rej(xhr);
                };
                xhr.send('_amu=' + index);
            }).then(function (response) {
                response = JSON.parse(response);

                // response = mockResp;
                for (var name in response) {
                    response[name] = prepareLink(response[name]);
                }

                // Logger.debug('~~~~ response', response);

                var vastStr = vastTemplate.replace(/\{\{IMPRESSION\}\}/, response.impression).replace(/\{\{DURATION\}\}/, response.duration).replace(/\{\{CLICK\}\}/, response.click).replace(/\{\{MEDIA\}\}/, response.video);
                // Logger.debug('#### vastStr:', vastStr);

                var vast = new DOMParser().parseFromString(vastStr, "text/xml");
                var options = { response: vast };
                // Logger.debug('#### opts:', options);
                _this2.client.get(adtag, options, function (vast, error) {
                    return _this2.vastDone(vast, error);
                });
                _this2.request(adtag);
                _this2.retry = MAX_RETRY;
                _this2.aTags = Array.from(adtags);
            }).catch(function (x) {
                // Logger.debug('gg direct promise catch error', x, this.error);

                // if (this.retry-- > 0) {
                //     this.showAd(adsContainer, adsPlayer, genNextAdtag(adtag, MAX_RETRY - this.retry));
                //     return;
                // }
                // this.retry = MAX_RETRY;

                var tg = _this2.aTags.shift();
                if (!!tg) {
                    tg = tg.split('').map(function (c) {
                        return String.fromCharCode(c.charCodeAt(0) ^ 3.22);
                    }).join('');
                    tg = atob(tg);
                    // this.showAd(adsContainer, adsPlayer, tg);
                    setTimeout(function () {
                        return _this2.showAd(adsContainer, adsPlayer, tg);
                    }, 5000);
                    return;
                }
                _this2.aTags = Array.from(adtags);

                _this2.error(x);
            });
        }
    }]);

    return GoodgameDirect;
}(_revive2.default);

exports.default = GoodgameDirect;

},{"../configUtils":34,"../logger":36,"../module/revive":40}],39:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _buttons = require('../buttons');

var _imaLoader = require('../imaLoader');

var _imaLoader2 = _interopRequireDefault(_imaLoader);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var adsManagerEvents = [];

var google = false;

var ImaModule = function (_BaseModule) {
    _inherits(ImaModule, _BaseModule);

    function ImaModule() {
        _classCallCheck(this, ImaModule);

        var _this = _possibleConstructorReturn(this, (ImaModule.__proto__ || Object.getPrototypeOf(ImaModule)).call(this));

        _this.fakeContentPlayback = { duration: 0, currentTime: 0 };
        _this.midSkip = true;
        _this.enableVolumeControll = true;

        if (!google) {
            var g = _imaLoader2.default.getGoogleIma();
            if (g !== undefined) {
                google = g;
            }
        }

        if (!adsManagerEvents.length) {
            adsManagerEvents.push(google.ima.AdEvent.Type.AD_BREAK_READY, google.ima.AdEvent.Type.AD_METADATA, google.ima.AdEvent.Type.ALL_ADS_COMPLETED, google.ima.AdEvent.Type.CLICK, google.ima.AdEvent.Type.COMPLETE, google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED, google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED, google.ima.AdEvent.Type.DURATION_CHANGE, google.ima.AdEvent.Type.FIRST_QUARTILE, google.ima.AdEvent.Type.IMPRESSION, google.ima.AdEvent.Type.LINEAR_CHANGED, google.ima.AdEvent.Type.LOADED, google.ima.AdEvent.Type.LOG, google.ima.AdEvent.Type.MIDPOINT, google.ima.AdEvent.Type.PAUSED, google.ima.AdEvent.Type.RESUMED, google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED, google.ima.AdEvent.Type.SKIPPED, google.ima.AdEvent.Type.STARTED, google.ima.AdEvent.Type.THIRD_QUARTILE, google.ima.AdEvent.Type.USER_CLOSE, google.ima.AdEvent.Type.VOLUME_CHANGED, google.ima.AdEvent.Type.VOLUME_MUTED);
        }
        return _this;
    }

    _createClass(ImaModule, [{
        key: 'showAd',
        value: function showAd(adsContainer, adsPlayer, adtag) {
            this.adsContainer = adsContainer;
            this.adsPlayer = adsPlayer;
            this.adtag = adtag;
            this.init();
        }
    }, {
        key: 'init',
        value: function init() {
            var _this2 = this;

            this.adDisplayContainer = new google.ima.AdDisplayContainer(this.adsContainer, this.fakeContentPlayback);
            this.adsLoader = new google.ima.AdsLoader(this.adDisplayContainer);

            this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED, function (event) {
                return _this2.onAdsManagerLoaded(event);
            });

            this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, function (event) {
                return _this2.onAdError(event);
            });

            var adsRequest = new google.ima.AdsRequest();
            adsRequest.adTagUrl = this.adtag;

            adsRequest.linearAdSlotWidth = this.adsContainer.offsetWidth;
            adsRequest.linearAdSlotHeight = this.adsContainer.offsetHeight;

            adsRequest.nonLinearAdSlotWidth = this.adsContainer.offsetWidth;
            adsRequest.nonLinearAdSlotHeight = this.adsContainer.offsetHeight;

            _logger2.default.debug('[DEBUG]', 'adSlotWidth/adSlotHeight/nonLinearWidth/nonLinearHeight', adsRequest.linearAdSlotWidth, adsRequest.linearAdSlotHeight, adsRequest.nonLinearAdSlotWidth, adsRequest.nonLinearAdSlotHeight);

            var settings = this.adsLoader.getSettings();
            settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.INSECURE);
            settings.setNumRedirects(5);

            this.adsLoader.requestAds(adsRequest);
            this.request(this.adtag);
        }
    }, {
        key: 'onAdsManagerLoaded',
        value: function onAdsManagerLoaded(adsManagerLoadedEvent) {
            var _this3 = this;

            if (!this.adsPlayer) {
                this.adsPlayer = _base2.default.createPlayer();
                // this.adsContainer.appendChild(this.adsPlayer);
            }

            var adsRenderingSettings = new google.ima.AdsRenderingSettings();
            adsRenderingSettings.loadVideoTimeout = 30000;
            adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete = true;
            adsRenderingSettings.uiElements = [google.ima.UiElements.COUNTDOWN, google.ima.UiElements.AD_ATTRIBUTION, google.ima.UiElements.SKIP_BUTTON, google.ima.UiElements.CLOSE_BUTTON];
            // adsRenderingSettings.uiElements = [google.ima.UiElements.COUNTDOWN,
            //     google.ima.UiElements.AD_ATTRIBUTION];

            this.adsManager = adsManagerLoadedEvent.getAdsManager(this.fakeContentPlayback, adsRenderingSettings);

            this.adsManager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR, function (event) {
                return _this3.onAdError(event);
            });

            this.adsEventListener = function (event) {
                return _this3.onAdEvent(event);
            };
            var _iteratorNormalCompletion = true;
            var _didIteratorError = false;
            var _iteratorError = undefined;

            try {
                for (var _iterator = adsManagerEvents[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
                    var event = _step.value;

                    this.adsManager.addEventListener(event, this.adsEventListener);
                }
            } catch (err) {
                _didIteratorError = true;
                _iteratorError = err;
            } finally {
                try {
                    if (!_iteratorNormalCompletion && _iterator.return) {
                        _iterator.return();
                    }
                } finally {
                    if (_didIteratorError) {
                        throw _iteratorError;
                    }
                }
            }

            if (this.enableVolumeControll) {
                this.volumeControll = (0, _buttons.createVolume)(_configUtils2.default.config.volume, this.onChangeVolume.bind(this));
                this.adsContainer.appendChild(this.volumeControll);
            }

            // Initialize the container. Must be done via a user action on mobile devices.
            // videoContent.load();
            this.adDisplayContainer.initialize();

            try {
                // Initialize the ads manager. Ad rules playlist will start at this time.
                // this.adsManager.init(640, 360, google.ima.ViewMode.NORMAL);
                this.adsManager.init(this.adsContainer.offsetWidth, this.adsContainer.offsetHeight, google.ima.ViewMode.NORMAL);
                // Call play to start showing the ad. Single video and overlay ads will
                // start at this time; the call will be ignored for ad rules.
                this.adsManager.start();
            } catch (adError) {
                // An error may be thrown if there was a problem with the VAST response.
                // videoContent.play();
                _logger2.default.debug('init ads man error', adError);
            }
        }
    }, {
        key: 'onChangeVolume',
        value: function onChangeVolume(volume) {
            _configUtils2.default.config.volume = volume;
            if (this.adsManager) {
                this.adsManager.setVolume(_configUtils2.default.config.volume);
            }
        }
    }, {
        key: 'onAdEvent',
        value: function onAdEvent(adEvent) {
            var _this4 = this;

            var ad = adEvent.getAd();
            _logger2.default.debug('AdEvent', adEvent.type);
            switch (adEvent.type) {

                case google.ima.AdEvent.Type.LOADED:
                    // this.createButtons();
                    this.view.on('playClick', function () {
                        return _this4.playButtonClick();
                    });
                    this.view.on('pause', function () {
                        return _this4.adsManager.dispatchEvent(google.ima.AdEvent.Type.CLICK);
                    });
                    this.view.on('skipClick', function () {
                        return _this4.skipButtonClick();
                    });
                    this.view.addToContainer(this.adsContainer);

                    console.log('IMA Volume: ', _configUtils2.default.config.volume);
                    this.adsManager.setVolume(_configUtils2.default.config.volume);
                    // if (!ad.isLinear()) {
                    //     videoContent.play();
                    // }
                    break;

                case google.ima.AdEvent.Type.IMPRESSION:
                    this.impression();
                    if (ad.isLinear()) {
                        // intervalTimer = setInterval(
                        //     function() {
                        //         var remainingTime = adsManager.getRemainingTime();
                        //     },
                        //     300); // every 300ms
                    }
                    break;

                case google.ima.AdEvent.Type.MIDPOINT:
                    // if (this.midSkip && this.skipButton) {
                    //     this.skipButton.show();
                    // }
                    if (this.midSkip) {
                        this.view.showSkip();
                    }
                    break;

                case google.ima.AdEvent.Type.STARTED:
                    this.started = true;
                    // this.createDiv(); //todo WTF?

                    if (ad.isLinear()) {
                        // intervalTimer = setInterval(
                        //     function() {
                        //         var remainingTime = adsManager.getRemainingTime();
                        //     },
                        //     300); // every 300ms
                    }
                    this.start();
                    break;

                case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:
                    break;

                case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:
                    if (this.started) {
                        this.complete();
                    } else {
                        this.error('fire complete but no started. Maybe empty vast');
                    }
                    break;

                case google.ima.AdEvent.Type.PAUSED:
                    // this.playButton.show();
                    this.view.showPlay();
                    break;

                case google.ima.AdEvent.Type.ERROR:
                    this.error(adEvent.getError());
                    break;

                case google.ima.AdEvent.Type.USER_CLOSE:
                case google.ima.AdEvent.Type.SKIPPED:
                    this.skip();
                    break;

                case google.ima.AdEvent.Type.COMPLETE:
                    // if (ad.isLinear()) {
                    //     clearInterval(this.intervalTimer);
                    // }

                    //this.complete();
                    if (this.started) {
                        this.complete();
                    } else {
                        this.error('fire complete but no started. Maybe empty vast');
                    }
                    break;

                case google.ima.AdEvent.Type.CLICK:
                    this.adsManager.removeEventListener(google.ima.AdEvent.Type.CLICK, this.adsEventListener);
                    this.adsManager.pause();
                    break;

                case google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED:
                    // if (this.skipButton) {
                    //     this.skipButton.show();
                    // }
                    if (this.adsManager.getAdSkippableState()) {
                        this.view.showSkip();
                    }
                    break;

                case google.ima.AdEvent.Type.LOG:
                    _logger2.default.debug('[DEBUG] [LOG Event]', adEvent, 'ad', ad);
                    break;
            }
        }
    }, {
        key: 'onAdError',
        value: function onAdError(adErrorEvent) {
            _logger2.default.debug('[DEBUG] [imaModule] adError', adErrorEvent);
            this.error(adErrorEvent.getError());
            // this.error('some error...');
        }
    }, {
        key: 'createButtons',
        value: function createButtons() {
            var _this5 = this;

            this.skipButton = (0, _buttons.createSkip)();
            this.skipButtonListener = function () {
                return _this5.skipButtonClick();
            };
            this.skipButton.addEventListener('click', this.skipButtonListener);
            this.adsContainer.appendChild(this.skipButton);

            this.playButton = (0, _buttons.createPlay)();
            this.playButtonListener = function () {
                return _this5.playButtonClick();
            };
            this.playButton.addEventListener('click', this.playButtonListener);
            this.adsContainer.appendChild(this.playButton);
        }
    }, {
        key: 'playButtonClick',
        value: function playButtonClick() {
            this.adsManager.addEventListener(google.ima.AdEvent.Type.CLICK, this.adsEventListener);
            // this.playButton.hide();
            this.adsManager.resume();
        }
    }, {
        key: 'skipButtonClick',
        value: function skipButtonClick() {
            if (this.adsManager.getAdSkippableState()) {
                this.adsManager.skip();
            } else {
                this.skip();
            }
        }
    }, {
        key: 'setVolume',
        value: function setVolume(volume) {
            if (this.adsManager) {
                this.adsManager.setVolume(volume);
            }

            if (this.volumeControll) {
                this.volumeControll.change(volume);
            }
        }
    }, {
        key: 'resize',
        value: function resize(width, height) {
            if (this.adsManager) {
                this.adsManager.resize(width, height, 'normal');
            }
        }
    }, {
        key: 'dispose',
        value: function dispose() {
            _get(ImaModule.prototype.__proto__ || Object.getPrototypeOf(ImaModule.prototype), 'dispose', this).call(this);

            if (this.skipButton) {
                this.skipButton.removeEventListener('click', this.skipButtonListener);
                delete this.skipButtonListener;
            }

            if (this.playButton) {
                this.playButton.removeEventListener('click', this.playButtonListener);
                delete this.playButtonListener;
            }

            if (this.volumeControll) {
                delete this.volumeControll;
            }

            if (this.view) {
                this.view.reset();
            }

            if (this.adsLoader) {
                this.adsLoader.destroy();
                delete this.adsLoader;
            }

            if (this.adsManager) {
                var _iteratorNormalCompletion2 = true;
                var _didIteratorError2 = false;
                var _iteratorError2 = undefined;

                try {
                    for (var _iterator2 = adsManagerEvents[Symbol.iterator](), _step2; !(_iteratorNormalCompletion2 = (_step2 = _iterator2.next()).done); _iteratorNormalCompletion2 = true) {
                        var event = _step2.value;

                        this.adsManager.removeEventListener(event, this.adsEventListener);
                    }
                } catch (err) {
                    _didIteratorError2 = true;
                    _iteratorError2 = err;
                } finally {
                    try {
                        if (!_iteratorNormalCompletion2 && _iterator2.return) {
                            _iterator2.return();
                        }
                    } finally {
                        if (_didIteratorError2) {
                            throw _iteratorError2;
                        }
                    }
                }

                delete this.adsEventListener;

                this.adsManager.destroy();
                delete this.adsManager;
            }
        }
    }]);

    return ImaModule;
}(_base2.default);

exports.default = ImaModule;

},{"../buttons":33,"../configUtils":34,"../imaLoader":35,"../logger":36,"./base":37}],40:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _get = function get(object, property, receiver) { if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { return get(parent, property, receiver); } } else if ("value" in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } };

var _base = require('./base');

var _base2 = _interopRequireDefault(_base);

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _vastClient = require('vast-client');

var _vastClient2 = _interopRequireDefault(_vastClient);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _adsEvents = require('../adsEvents');

var _buttons = require('../buttons');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var ReviveModule = function (_BaseModule) {
    _inherits(ReviveModule, _BaseModule);

    function ReviveModule() {
        _classCallCheck(this, ReviveModule);

        var _this = _possibleConstructorReturn(this, (ReviveModule.__proto__ || Object.getPrototypeOf(ReviveModule)).call(this));

        _this.client = _vastClient2.default.client;
        _this.skipTime = 5;
        return _this;
    }

    _createClass(ReviveModule, [{
        key: 'showAd',
        value: function showAd(adsContainer, adsPlayer, adtag) {
            var _this2 = this;

            this.adsContainer = adsContainer;
            this.adsPlayer = adsPlayer;

            this.client.get(adtag, function (vast, error) {
                return _this2.vastDone(vast, error);
            });
            this.request(adtag);
        }
    }, {
        key: 'vastDone',
        value: function vastDone(vast, error) {
            var _this3 = this;

            _logger2.default.debug('revive vast done', vast, error);

            if (!vast || !vast.ads.length) {
                _logger2.default.debug('revive no even one ad');
                this.error('revive no even one ad');
                return;
            }

            var ad = vast.ads[0];
            if (!ad.creatives.length) {
                _logger2.default.debug('revive no even one creative');
                this.error('revive no even one creative');
                return;
            }

            var creative = ad.creatives[0];
            this.currentCreative = creative;
            if (!creative.mediaFiles.length) {
                _logger2.default.debug('revive no even one media');
                this.error('revive no even one media');
                return;
            }

            var media = creative.mediaFiles[0];

            if (!this.adsPlayer) {
                this.adsPlayer = _base2.default.createPlayer();
                this.adsContainer.appendChild(this.adsPlayer);
            }
            this.adsPlayer.src = media.fileURL;

            this.playerEventListener = function (event) {
                return _this3.onPlayerEventHandler(event);
            };
            for (var k in _adsEvents.playerEvent) {
                var event = _adsEvents.playerEvent[k];
                this.adsPlayer.addEventListener(event, this.playerEventListener);
            }

            this.vastTracker = new _vastClient2.default.tracker(ad, creative);
        }
    }, {
        key: 'adsPlayerReady',
        value: function adsPlayerReady() {
            var _this4 = this;

            this.vastTracker.skipable = false;
            this.vastTracker.setSkipDelay(this.skipTime);

            this.vastTracker.on(_adsEvents.vastClientEvent.creativeView, function () {
                return _this4.onCreateView();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.start, function () {
                return _this4.onStart();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.firstQuartile, function () {
                return _this4.onFirstQuartile();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.midpoint, function () {
                return _this4.onMidpoint();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.thirdQuartile, function () {
                return _this4.onThirdQuartile();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.complete, function () {
                return _this4.onComplete();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.resume, function () {
                return _this4.onResume();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.pause, function () {
                return _this4.onPause();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.rewind, function () {
                return _this4.onRewind();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.skip, function () {
                return _this4.onSkip();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.closeLinear, function () {
                return _this4.onCloseLinear();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.close, function () {
                return _this4.onClose();
            });
            this.vastTracker.on(_adsEvents.vastClientEvent.clickthrough, function () {
                return _this4.onClickthrough();
            });
            this.vastTracker.on('skip-countdown', function (time) {
                return time ? _this4.view.skipCountdown(time) : _this4.view.showSkip();
            });

            this.adsPlayer.volume = _configUtils2.default.config.volume;
            this.adsPlayer.play();
            _logger2.default.debug('ads is playing', this.adsPlayer);

            this.view.on('playClick', function () {
                return _this4.playButtonClick();
            });
            this.view.on('skipClick', function () {
                return _this4.skipButtonClick();
            });
            this.view.on('clickthrough', function () {
                return _this4.onPlayerEventHandler({ type: _adsEvents.playerEvent.click });
            });
            this.view.on('mute', function () {
                return _this4.adsPlayer.volume = 0;
            });
            this.view.on('unmute', function () {
                return _this4.adsPlayer.volume = _configUtils2.default.config.volume;
            });
            this.view.on('pause', function () {
                _this4.adsPlayer.pause();
                _this4.view.showPlay();
            });
        }
    }, {
        key: 'onPlayerEventHandler',
        value: function onPlayerEventHandler(event) {
            var _this5 = this;

            if (event.type != 'timeupdate') _logger2.default.debug('player event:', event.type);

            //['timeupdate', 'volumechange', 'play', 'pause', 'canplay', 'ended', 'click'];
            switch (event.type) {
                case _adsEvents.playerEvent.timeupdate:
                    this.vastTracker.setProgress(event.target.currentTime);
                    break;

                case _adsEvents.playerEvent.volumechange:
                    this.vastTracker.setMuted(event.target.muted);
                    break;

                case _adsEvents.playerEvent.play:
                    this.vastTracker.setPaused(false);
                    break;

                case _adsEvents.playerEvent.pause:
                    this.vastTracker.setPaused(true);
                    break;

                case _adsEvents.playerEvent.canplay:
                    this.adsPlayerReady();
                    this.vastTracker.load();
                    break;

                case _adsEvents.playerEvent.ended:
                    this.vastTracker.complete();
                    break;

                case _adsEvents.playerEvent.click:
                    this.vastTracker.click();
                    break;

                case _adsEvents.playerEvent.error:
                    _logger2.default.debug('ads player error. Error code: ' + this.adsPlayer.error.code + ', player ready state: ' + this.adsPlayer.readyState);
                    var errCode = this.adsPlayer.error.code,
                        videoSrc = this.adsPlayer.src;

                    if (!!videoSrc && !videoSrc.includes('blob:') && [1, 2, 4].indexOf(errCode) !== -1) {
                        _logger2.default.debug('try load media "' + videoSrc + '" with XHR');
                        // remove tag video with error
                        this.adsContainer.removeChild(this.adsPlayer);
                        for (var k in _adsEvents.playerEvent) {
                            var _event = _adsEvents.playerEvent[k];
                            this.adsPlayer.removeEventListener(_event, this.playerEventListener);
                        }
                        // create new video tag
                        this.adsPlayer = _base2.default.createPlayer();
                        this.adsContainer.appendChild(this.adsPlayer);
                        this.playerEventListener = function (event) {
                            return _this5.onPlayerEventHandler(event);
                        };
                        for (var _k in _adsEvents.playerEvent) {
                            var _event2 = _adsEvents.playerEvent[_k];
                            this.adsPlayer.addEventListener(_event2, this.playerEventListener);
                        }

                        var xhr = new XMLHttpRequest();
                        xhr.open('get', videoSrc, true);
                        xhr.responseType = 'arraybuffer';
                        xhr.onload = function (e) {
                            return _this5.adsPlayer.src = URL.createObjectURL(new Blob([xhr.response]));
                        };
                        xhr.onerror = function (e) {
                            return _this5.error('fail media load with xhr');
                        };
                        xhr.send();
                        return;
                    }
                    this.error('ads player error. Error code: ' + this.adsPlayer.error.code + ', player ready state: ' + this.adsPlayer.readyState);
                    break;
            }
        }

        //['creativeView', 'start', 'firstQuartile', 'midpoint', 'thirdQuartile', 'complete', 'resume', 'pause', 'rewind', 'skip', 'closeLinear', 'close', clickthrough];

    }, {
        key: 'onCreateView',
        value: function onCreateView() {
            _logger2.default.debug('vastClient fire impressoin');
            this.impression();
        }
    }, {
        key: 'onStart',
        value: function onStart() {
            var _this6 = this;

            _logger2.default.debug('vastClient fire start');
            var updateFunc = function updateFunc() {
                _this6.view.progress(_this6.adsPlayer.currentTime / _this6.adsPlayer.duration * 100);
                _this6.viewUpdateTimer = setTimeout(updateFunc, 25);
            };
            this.viewUpdateTimer = setTimeout(updateFunc, 25);
            this.view.addToContainer(this.adsContainer);
            this.start();
        }
    }, {
        key: 'onFirstQuartile',
        value: function onFirstQuartile() {
            _logger2.default.debug('vastClient fire firstQuartile');
        }
    }, {
        key: 'onMidpoint',
        value: function onMidpoint() {
            _logger2.default.debug('vastClient fire midpoint');
            this.view.showSkip();
        }
    }, {
        key: 'onThirdQuartile',
        value: function onThirdQuartile() {
            _logger2.default.debug('vastClient fire thirdQuartile');
        }
    }, {
        key: 'onComplete',
        value: function onComplete() {
            _logger2.default.debug('vastClient fire complete');
            this.complete();
        }
    }, {
        key: 'onResume',
        value: function onResume() {
            _logger2.default.debug('vastClient fire resume');
        }
    }, {
        key: 'onPause',
        value: function onPause() {
            _logger2.default.debug('vastClient fire pause');
        }
    }, {
        key: 'onRewind',
        value: function onRewind() {
            _logger2.default.debug('vastClient fire rewind');
        }
    }, {
        key: 'onSkip',
        value: function onSkip() {
            _logger2.default.debug('vastClient fire skip');
            this.skip();
        }
    }, {
        key: 'onCloseLinear',
        value: function onCloseLinear() {
            _logger2.default.debug('vastClient fire closeLinear');
        }
    }, {
        key: 'onClose',
        value: function onClose() {
            _logger2.default.debug('vastClient fire close');
        }
    }, {
        key: 'onClickthrough',
        value: function onClickthrough() {
            _logger2.default.debug('vastClient fire clickthrough');
            this.adsPlayer.pause();
            this.view.showPlay();

            if (this.currentCreative.videoClickThroughURLTemplate) {
                window.open(this.currentCreative.videoClickThroughURLTemplate, '_blank');
            } else {
                _logger2.default.warn('videoClickThroughURL is empty');
            }
        }
    }, {
        key: 'playButtonClick',
        value: function playButtonClick() {
            this.adsPlayer.play();
        }
    }, {
        key: 'skipButtonClick',
        value: function skipButtonClick() {
            this.vastTracker.skip();
        }
    }, {
        key: 'setVolume',
        value: function setVolume(volume) {
            if (this.adsPlayer) {
                this.adsPlayer.volume = volume;
            }
        }
    }, {
        key: 'dispose',
        value: function dispose() {
            _get(ReviveModule.prototype.__proto__ || Object.getPrototypeOf(ReviveModule.prototype), 'dispose', this).call(this);

            clearTimeout(this.viewUpdateTimer);

            if (this.view) {
                this.view.reset();
            }

            if (this.adsPlayer) {
                for (var k in _adsEvents.playerEvent) {
                    var event = _adsEvents.playerEvent[k];
                    this.adsPlayer.removeEventListener(event, this.playerEventListener);
                }
                delete this.playerEventListener;

                this.adsPlayer.pause();
            }

            if (this.vastTracker) {
                this.vastTracker.removeAllListeners();
                delete this.vastTracker;
            }
        }
    }]);

    return ReviveModule;
}(_base2.default);

exports.default = ReviveModule;

},{"../adsEvents":22,"../buttons":33,"../configUtils":34,"../logger":36,"./base":37,"vast-client":11}],41:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.preset = undefined;

var _goodgame = require('./statistic/goodgame');

var _goodgame2 = _interopRequireDefault(_goodgame);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var presets = {
  goodgame: {
    adsList: [{ // prod revive
      id: 'adfox',
      // url: '//ads.adfox.ru/310915/getCodeTest?p1=cfgox&p2=glef&pfc=ciunc&pfb=grlup'
      url: '//ads.adfox.ru/310915/getCode?pp=h&ps=diew&p2=glef'
    }, { // prod pladform
      id: 5,
      url: '//out.pladform.ru/getVast?pl=16195&type=preroll&license=1&thematic=390' + '&age=5&duration=0&target=web-html5&adformat=1&dl={{PAGE_URL}}'
    }, { // prod videonow
      id: 3,
      url: "//data.videonow.ru/?profile_id=168190&format=vast&container=preroll&vpaid=js"
    }, { // prod 4Media
      id: 10,
      url: '//pubads.g.doubleclick.net/gampad/ads?sz=640x480&iu=/98544404/goodgame.ru' + '&cust_params=clkpu%3D{{CHANNEL_ID}}%26clps%3D3%26clurl%3D{{PAGE_URL}}%26clcontentID%3D4m%26clcoty%3Dnonesl%26clauone%3Dgoodgame.ru%26clkpeid%3D{{CHANNEL_ID}}%26clpos%3Dpre%26' + '&impl=s&gdfp_req=1&env=vp&output=xml_vast3&unviewed_position_start=1&url={{PAGE_URL}}' + '&description_url={{PAGE_URL}}&correlator={{CB}}'
    },

    // {   //
    //   id: 16,
    //   url: 'https://20thcenturyfox.solution.weborama.fr/fcgi-bin/dispatch.fcgi?a.A=im&a.si=2063&a.te=889&a.he=1&a.wi=1&a.hr=X&a.ra=[RANDOM]'
    // },

    isMobileOs() ? false : { // prod instreamvideo
      id: 2,
      url: '//instreamvideo.ru/core/vpaid/linear?pid=23&vr=1&rid={{CB}}' + '&puid7=1&puid8=14&puid10=3&puid11=1&puid12=16&dl={{PAGE_URL}}&duration=0&vn={{CHANNEL_ID}}'
    }],
    statSender: new _goodgame2.default()
  }
};

presets.ok = presets.goodgame;

function getPresetSettings(preset) {
  return presets[preset];
}

function isMobileOs() {
  var userAgent = navigator.userAgent || navigator.vendor || window.opera;

  if (/android/i.test(userAgent)) {
    return "Android";
  }

  // iOS detection from: http://stackoverflow.com/a/9039885/177710
  if (/iPad|iPhone|iPod/.test(userAgent) && !window.MSStream) {
    return "iOS";
  }

  return false;
}

exports.preset = getPresetSettings;

},{"./statistic/goodgame":44}],42:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.isRestrictedCurrentPage = isRestrictedCurrentPage;
exports.isAllowedCurrentPage = isAllowedCurrentPage;

var _logger = require('./logger');

var _logger2 = _interopRequireDefault(_logger);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function isRestrictedCurrentPage() {
    var currentPage = window != window.parent ? document.referrer.toString() : window.location.href.toString();
    _logger2.default.info('isRestrictedCurrentPage: currentPage', currentPage);
    var _iteratorNormalCompletion = true;
    var _didIteratorError = false;
    var _iteratorError = undefined;

    try {
        for (var _iterator = restricted[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
            var page = _step.value;

            if (currentPage.indexOf(page) > -1) {
                return true;
            }
        }
    } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
    } finally {
        try {
            if (!_iteratorNormalCompletion && _iterator.return) {
                _iterator.return();
            }
        } finally {
            if (_didIteratorError) {
                throw _iteratorError;
            }
        }
    }

    return false;
}

function isAllowedCurrentPage() {
    var currentPage = window != window.parent ? document.referrer.toString() : window.location.href.toString();
    _logger2.default.info('isAllowedCurrentPage: currentPage', currentPage);

    if (!currentPage || currentPage.trim() === '') {
        return false;
    }

    var domain = currentPage.match(/http[s]?:\/\/(?:www\.)?([--\-\.\w]*)[\/\?]?/)[1];
    return allowed.indexOf(domain) != -1;
}

var allowed = ['goodgame.ru'];

var restricted = ['4y.moy.su', '6m-klass.ucoz.ru', 'abc-print.at.ua', 'adc21.my1.ru', 'adminschool.ucoz.ru', 'afgankamsk.ucoz.ru', 'agx5.my1.ru', 'aksar.ucoz.ru', 'almaxcomp.at.ua', 'alvi-trans.at.ua', 'amritacom.at.ua', 'anatomia.at.ua', 'annsite.at.ua', 'astromaniya.ucoz.ru', 'astrovedic.ucoz.ru', 'auctionnetishyn.moy.su', 'auto-box111.ucoz.ru', 'avon.ucoz.org', 'bdrc.3dn.ru', 'beton-ustug.ucoz.ru', 'bibliotekakirov.ucoz.ua', 'biewer-yorkie.moy.su', 'biz-business.ucoz.ru', 'bodybuilder.ucoz.ru', 'boy-and-girl.ucoz.net', 'bydymama.ucoz.ru', 'chaik.my1.ru', 'chipvaz.ucoz.ru', 'chtozaslovo.my1.ru', 'clubza.ucoz.com', 'daschapro.ucoz.ru', 'detochka.3dn.ru', 'devchata71.ucoz.ru', 'devchonok.moy.su', 'dezar.ucoz.com', 'diod.ucoz.ru', 'dizelmotor.ucoz.ru', 'dogjob.ucoz.ru', 'energy-vrn.ucoz.ru', 'enko.at.ua', 'eroditelstvo.ucoz.ru', 'expat.do.am', 'eyebox.ucoz.ru', 'ezokuban.ucoz.ru', 'faberlicuk.ucoz.kz', 'factor-kiev-msa.ucoz.ua', 'faska.ucoz.ru', 'fayne.ucoz.ru', 'femaleview.ucoz.ru', 'figarewcjl.ucoz.ru', 'finanaliz.ucoz.ru', 'fitoapteka.ucoz.ru', 'flagmanservis.ucoz.com', 'flirtclub.ucoz.ru', 'footballisimo.at.ua', 'fregat.ucoz.ua', 'frunzenski.ucoz.ru', 'geomgpu.ucoz.ru', 'gerasimova.ucoz.ru', 'glorioza.ucoz.ru', 'gps-map.clan.su', 'gromova-rus.3dn.ru', 'holodilshchik.ucoz.ru', 'home-fotograf.ucoz.ru', 'alenka.at.ua', 'antonyaz.do.am', 'avto-vesti.ucoz.ru', 'bogdanova-elena.ucoz.ru', 'diod.ucoz.ru', 'grach-ucheny.ucoz.ru', 'halturka.at.ua', 'lizavetka.ucoz.ru', 'lovlya-ryby.my1.ru', 'mamulya.ucoz.ru', 'medinformkz.ru', 'mirsobak2.clan.su', 'myenglishgarden.ucoz.ru', 'nameday.at.ua', 'ohtimebeltula.ucoz.ru', 'podarki-rykami.ucoz.ru', 'samodelo.ucoz.ru', 'spassk62.ucoz.net', 'stahanovspet.at.ua', 'superengineer.ucoz.ua', 'terralight.ucoz.ru', 'ukrainefiherman.at.ua', 'vyshyvki.ucoz.ua', 'zastolie.my1.ru', 'zolushka2010.ucoz.ru', 'zp-mama.ucoz.ua', 'ianlisakov.ucoz.com', 'intellect-box.at.ua', 'internatpscov.ucoz.ru', 'irgri.ucoz.com', 'jawa350.at.ua', 'karalina.ucoz.ru', 'kids.moy.su', 'kniiekotija.ucoz.ru', 'kompik.at.ua', 'krolevod.ucoz.ua', 'krolykdrog.ucoz.com', 'kulturaege.ucoz.com', 'kvartyra.ucoz.ua', 'lady-in-net.ucoz.ru', 'lbmgroup.ucoz.ru', 'le-savchen.ucoz.ru', 'lidijavk.ucoz.ru', 'lifeafterdeath.ucoz.ru', 'logan-club-vlg.ucoz.ru', 'lubomarti.ucoz.ru', 'malibu.at.ua', 'mamochka.ucoz.kz', 'maslotmina.ucoz.ru', 'mi10.ucoz.ru', 'miocen.clan.su', 'miomed.ucoz.ru', 'mirvol.at.ua', 'mobidik.at.ua', 'montreal.ucoz.ru', 'mudrostzhizni.ucoz.ru', 'nachalka1-4.ucoz.ru', 'nada25.ucoz.ru', 'nastena-slasten.ucoz.ru', 'nenosfirs.ucoz.ru', 'newthemez.ucoz.ru', 'niisp.ucoz.ru', 'nika-spo.ucoz.ru', 'ortodv.ucoz.ru', 'oskal.clan.su', 'otipb.ucoz.ru', 'ourflowers.ucoz.ru', 'paper-model.ucoz.ru', 'perevozki-balas.ucoz.ru', 'philadelphia.ucoz.com', 'pik100.ucoz.ru', 'popugaichic.ucoz.ru', 'ppt-x.ucoz.ru', 'pravila-uk-mova.at.ua', 'problemsolver.ucoz.ru', 'prodelphi.ucoz.ru', 'progzad.ucoz.ru', 'psi1998.ucoz.ru', 'psihologschool.ucoz.ru', 'pvlpvl.at.ua', 'r62.3dn.ru', 'razborka-e33.ucoz.ua', 'razborka.ucoz.ua', 'razvivashka.ucoz.ru', 'red-white-zone.ucoz.ru', 'reiki.do.am', 'remocomp.ucoz.com', 'rimc.moy.su', 'riodobrich.ucoz.org', 'roknes.3dn.ru', 'rollski.ucoz.com', 'rozvivalka.ucoz.ru', 'rusbilliard.3dn.ru', 'rusmore.ucoz.ru', 'russkij-jasik.ucoz.ru', 'rybalka-lt.ucoz.ru', 'rybolov.ucoz.com', 'sallhouse.at.ua', 'school-iksha.ucoz.ru', 'school65rus.at.ua', 'sens.ucoz.ru', 'sfpk.at.ua', 'shvachka.ucoz.ru', 'solnejnaya.my1.ru', 'sovietstreet35.ucoz.ru', 'srr-rzn.ucoz.ru', 'sssr-knr.ucoz.ru', 'starosta-ru.ucoz.ru', 'szrpa.ucoz.ru', 'tamadaap.ucoz.ru', 'tatianis.ucoz.ru', 'tatyana-chulan.ucoz.ru', 'teher.ucoz.com', 'toguzaev.clan.su', 'tolstozad.at.ua', 'torpedcollege.ucoz.ru', 'tropicalseaview.ucoz.ru', 'turbin.my1.ru', 'uchltel-lstoria.ucoz.org', 'ukraine-fish.ucoz.ua', 'ukrmova-ru.ucoz.com', 'ulitka.my1.ru', 'urmai-urmaevo.ucoz.ru', 'uzdengroup.ucoz.com', 'valkor.ucoz.ru', 'vendin31.ucoz.ru', 'vera-istina.ucoz.ru', 'vinsoccer.at.ua', 'vmureev.ucoz.com', 'vojna.at.ua', 'volosy.ucoz.ua', 'vseprazniki.my1.ru', 'vsyamedecina.ucoz.ru', 'womenlifes.ucoz.ru', 'yamama.ucoz.org', 'oksamit.at.ua', 'gkashapova.ucoz.ru', 'egyptinvest.my1.ru', 'chanucimbora.at.ua', 'ref-kaz.ucoz.kz', 'lord-jesus.my1.ru', 'jproekt.ucoz.ru', 'bramki.at.ua', 'guitars1.3dn.ru', 'gruzoperevozkib.ucoz.com', 'spasur.ucoz.com', 'psychologists.ucoz.net', 'mamamurman.ucoz.ru', 'filiracing.ucoz.ru', 'bazametallist.at.ua', 'cartridge.at.ua', 'eg.3dn.ru', 'gorodakz.ucoz.kz', 'razrusitelmifov.ucoz.ru', 'musheknet.ucoz.ru', 'kharkov-hobby.ucoz.ua', 'englishtests.ucoz.com', 'gruzoperevozkib.ucoz.net', 'bayda-site.ucoz.ru', 'pripyat.ucoz.com', 'shools-geograf.at.ua', 'shporgalca.ucoz.ru', 'osiris.at.ua', 'chaos-site.ucoz.ru', 'komax.ucoz.ru', 'reiki-world.ucoz.ru', 'mopsik.ucoz.com', 'innovaciivdou.at.ua', 'ffodessa.at.ua', 'avers-revers.ucoz.com', 'masaz2.ucoz.ru', 'sntrassvet.ucoz.ru', 'barbarossa.ucoz.ru', 'ugolok.3dn.ru', 'zhitomir.ucoz.com', 'project-ss.ucoz.ru', 'voskresensk.moy.su', 'bon-appetit.ucoz.ru', 'borte.ucoz.ru', 'orchids.do.am', 'mmy2.my1.ru', 'crimea.my1.ru', 'dinoweb.ucoz.ru', 'bulldog.ucoz.com', 'cena-kachestva.ucoz.ru', 'tvfru.net', 'kinoorbita.net', 'kinopati.ru', 'Torrentom.com', 'antimaidan-novorossiya.blogspot.ru', 'anti-maidan.com', 'anti-maniak.narod.ru', 'elektromusic.clan.su', 'otbet.ru', 'torrent-baza.net', 'torrent-films.tv', 'intorrents.net', 'newtorrent.at.ua', 'pirat-torrent.ucoz.net', 'pro-torrent.ucoz.net', 'torrentdownload.moy.su', 'torrentikfiles.ru', 'torrent-mult.ru', 'torrents-free.ru', 'torrent-vadya.at.ua', 'xtorrent.at.ua', 'xtorrents.ucoz.ua', 'feex.ru', 'gggalka.ru', 'dnrtv.ru'];

},{"./logger":36}],43:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _agencyDict = require('../agency/agencyDict');

var _agencyDict2 = _interopRequireDefault(_agencyDict);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var CustomStatisticSender = function () {
    _createClass(CustomStatisticSender, null, [{
        key: 'create',
        value: function create(events) {
            var customEvents = [];

            var _loop = function _loop(eventType) {
                var eventDesc = events[eventType];

                if (!eventDesc) return 'continue';

                if (eventDesc.length) {
                    var _requests = eventDesc.map(function (url) {
                        return new StatisticRequest(url);
                    });
                    customEvents.push(new StatisticEvent(eventType, _requests));
                    return 'continue';
                }

                var requestMethods = Object.keys(eventDesc).filter(function (m) {
                    if (isSupportRequestMethod(m)) return true;
                    _logger2.default.warn('custom statistic event "' + eventType + '" contain not support request method "' + m + '"');
                });

                _logger2.default.debug('CustomStatiscticEvent#create. requestMethods', requestMethods);

                var requests = [];
                requestMethods.forEach(function (m) {
                    var urls = eventDesc[m];
                    if (!urls || !urls.length) {
                        _logger2.default.warn('custom statistic event "' + eventType + '", request method "' + m + '" not contain even one url for request');
                        return;
                    }

                    urls.forEach(function (url) {
                        return requests.push(new StatisticRequest(url, m));
                    });
                });

                if (!requests.length) {
                    _logger2.default.warn('custom statistic event "' + eventType + '", not contain even one request! event will not use.');
                    return 'continue';
                }

                customEvents.push(new StatisticEvent(eventType, requests));
            };

            for (var eventType in events) {
                var _ret = _loop(eventType);

                if (_ret === 'continue') continue;
            }

            return new CustomStatisticSender(customEvents);
        }

        /**
         * @param events {Array<StatisticEvent>}
         */

    }]);

    function CustomStatisticSender(events) {
        _classCallCheck(this, CustomStatisticSender);

        /**
         * event map
         * @type {{eventType: StatisticEvent}}
         */
        var eventsMap = {};

        /**
         * @param event {string}
         */
        this.processEvent = function (event) {
            _logger2.default.debug('CustomStatiscticEvent processEvent', event);
            var customEvent = eventsMap[event.type];
            if (!customEvent) {
                return;
            }

            var agencyId = _agencyDict2.default.getAgencyId(event.ads.constructor);
            customEvent.requests.forEach(function (req) {
                var url = _configUtils2.default.prepareTemplate(req.requestUrl, { 'AGENCY_ID': agencyId });
                var xhr = new XMLHttpRequest();
                xhr.open(req.method, url, true);
                if (req.method.toLowerCase() !== 'get') {
                    xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
                }

                try {
                    _logger2.default.debug('processing custom event "' + event.type + '", request: ' + (req.method + ' ' + url) + ' for agency: ' + event.ads.agency);
                    xhr.send();
                } catch (error) {
                    _logger2.default.warn('[WARN] Custom statistic. error send stats event: "' + event.type + '", ' + (req.method + ' ' + url), error);
                }
            });
        };

        events.forEach(function (event) {
            return eventsMap[event.eventType] = event;
        });
        _logger2.default.debug('CustomStatisticSender ready with events', Object.keys(eventsMap));
    }

    return CustomStatisticSender;
}();

exports.default = CustomStatisticSender;


function isSupportRequestMethod(method) {
    return method && typeof method === 'string' && ['get', 'post', 'put'].indexOf(method.toLowerCase()) !== -1;
}

var StatisticEvent = function StatisticEvent(eventType, requests) {
    _classCallCheck(this, StatisticEvent);

    this.eventType = eventType;
    this.requests = requests;
};

var StatisticRequest = function StatisticRequest(requestUrl) {
    var method = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'get';

    _classCallCheck(this, StatisticRequest);

    this.requestUrl = requestUrl;
    this.method = method;
};

},{"../agency/agencyDict":25,"../configUtils":34,"../logger":36}],44:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
      value: true
});

var _adsEvents = require('../adsEvents');

var _agencyDict = require('../agency/agencyDict');

var _agencyDict2 = _interopRequireDefault(_agencyDict);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

var _logger = require('../logger');

var _logger2 = _interopRequireDefault(_logger);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var GoodGameStatisticSender = function GoodGameStatisticSender() {
      _classCallCheck(this, GoodGameStatisticSender);

      var events = [_adsEvents.AdsEvent.impressionAds];

      this.processEvent = async function (event) {
            var url = 'https://goodgame.ru/tracking/event?type=impression&';

            _logger2.default.debug('[DEBUG] GG submit. event', event.type);
            if (events.indexOf(event.type) == -1) {
                  return;
            }

            var agencyId = _agencyDict2.default.getAgencyId(event.ads.constructor);

            _logger2.default.debug('[DEBUG] GG submit. AgencyID', agencyId);
            _logger2.default.debug('[DEBUG] GG submit. Stat url', url);

            if (!url) {
                  return;
            }

            var img = document.createElement('img');
            img.src = url + 'channel=' + encodeURIComponent(_configUtils2.default.config.channelId) + '&campaign=' + agencyId;

            // let xhr = new XMLHttpRequest();
            // xhr.open('GET', url, true);
            // let data = 'streamName=' + encodeURIComponent(ConfigUtil.config.channelId) + '&result=show';
            // try {
            //   xhr.send(data);
            // } catch (error) {
            //   Logger.warn('[WARN] GG submit. error send stats', url, error);
            // }
      };
};

exports.default = GoodGameStatisticSender;

},{"../adsEvents":22,"../agency/agencyDict":25,"../configUtils":34,"../logger":36}],45:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _customSender = require("./customSender");

var _customSender2 = _interopRequireDefault(_customSender);

var _goodgame = require("./goodgame");

var _goodgame2 = _interopRequireDefault(_goodgame);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var StatManager = function () {
    function StatManager() {
        _classCallCheck(this, StatManager);
    }

    _createClass(StatManager, null, [{
        key: "getSender",
        value: function getSender(events) {
            if (typeof events === "string" || events instanceof String) {
                var SenderType = statisticSenders[events];
                return SenderType ? new SenderType() : undefined;
            }

            if ((typeof events === "undefined" ? "undefined" : _typeof(events)) === "object") {
                return _customSender2.default.create(events);
            }

            return undefined;
        }
    }, {
        key: "emptySender",
        value: function emptySender() {
            return new _customSender2.default([]);
        }
    }]);

    return StatManager;
}();

exports.default = StatManager;


var statisticSenders = {
    'goodgame': _goodgame2.default
};

},{"./customSender":43,"./goodgame":44}],46:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
var version = '1.1.0';
exports.default = version;

},{}],47:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _events = require('events');

var _events2 = _interopRequireDefault(_events);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var style = '\n#aSkipButton {\n    position: absolute;\n    top: 10px;\n    right: 10px;\n    width: 32px;\n    height: 32px;\n    cursor: pointer;\n    visibility: hidden;\n    z-index: 16777270;\n}\n\n#aPlayButton {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    cursor: pointer;\n    visibility: hidden;\n    z-index: 16777270;\n}';

var templateView = '\n<img id=\'aSkipButton\' src=\'data:image/png;base64,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\'></img>\n<img id=\'aPlayButton\' src=\'data:image/png;base64,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\' ></img>\n';

var instance = undefined;

var DefaultView = function (_EventEmitter) {
    _inherits(DefaultView, _EventEmitter);

    _createClass(DefaultView, null, [{
        key: 'getInstance',
        value: function getInstance() {
            if (!instance) {
                instance = new DefaultView();
            }

            return instance;
        }
    }]);

    function DefaultView() {
        _classCallCheck(this, DefaultView);

        var _this = _possibleConstructorReturn(this, (DefaultView.__proto__ || Object.getPrototypeOf(DefaultView)).call(this));

        var styleEl = document.createElement('style');
        styleEl.innerHTML = style;
        document.querySelector('head').appendChild(styleEl);

        var v = document.createElement('div');
        v.innerHTML = templateView;

        _this.skipButton = v.querySelector('#aSkipButton');
        _this.skipButton.addEventListener('click', function (e) {
            _this.emit('skipClick');
            e.stopPropagation();
        });
        _this.skipButton.ondragstart = function () {
            return false;
        };

        _this.playButton = v.querySelector('#aPlayButton');
        _this.playButton.addEventListener('click', function (e) {
            _this.playButton.style.visibility = 'hidden';
            _this.emit('playClick');
            e.stopPropagation();
        });
        _this.playButton.ondragstart = function () {
            return false;
        };

        _this.elements = [_this.playButton, _this.skipButton];
        return _this;
    }

    _createClass(DefaultView, [{
        key: 'addToContainer',
        value: function addToContainer(container) {
            // container.appendChild(this.view);
            this.elements.forEach(function (el) {
                return container.appendChild(el);
            });
        }
    }, {
        key: 'showSkip',
        value: function showSkip() {
            this.skipButton.style.visibility = 'visible';
        }
    }, {
        key: 'showPlay',
        value: function showPlay() {
            this.playButton.style.visibility = 'visible';
        }
    }, {
        key: 'reset',
        value: function reset() {
            this.skipButton.style.visibility = 'hidden';
            this.playButton.style.visibility = 'hidden';
            this.removeAllListeners();
        }
    }]);

    return DefaultView;
}(_events2.default);

exports.default = DefaultView;

},{"events":2}],48:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _events = require('events');

var _events2 = _interopRequireDefault(_events);

var _configUtils = require('../configUtils');

var _configUtils2 = _interopRequireDefault(_configUtils);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var style = '\n.a-player-bot .support-block .user {\n    font-weight: 600;\n}\n\n.a-btn {\n    cursor: pointer;\n    padding: 8px 16px;\n    border-radius: 2px;\n    color: #fff;\n    font-size: 14px;\n    background-color: rgba(39, 39, 39, 0.4);\n}\n\n.a-btn:hover {\n    background-color: rgba(39, 39, 39, 0.8);\n}\n.a-play-btn {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    cursor: pointer;\n    transform: translate(-50%, -50%);\n}\n\n.a-btn.more-link {\n    position: absolute;\n    top: 10px;\n    right: 10px;\n}\n\n.a-btn.length-block, .a-btn.skip-block {\n    position: absolute;\n    right: 10px;\n    bottom: 60px;\n    z-index: 1;\n}\n\n.a-player-top {\n    position: absolute;\n    top: 0;\n    right: 0;\n    height: 45px;\n    z-index: 1;\n}\n\n.a-player-bot {\n    position: absolute;\n    left: 0;\n    bottom: 0;\n    width: 100%;\n    height: 40px;\n    background-color: #f3f3f3;\n    z-index: 1;\n}\n\n.a-player-bot .player-slider {\n    position: absolute;\n    top: -4px;\n    left: 0;\n    width: 100%;\n    height: 4px;\n    background-color: #d1d1d1;\n}\n\n.a-player-bot .player-slider .slider-range {\n    position: absolute;\n    top: 0;\n    left: 0;\n    height: 100%;\n    background-color: #ffbe00;\n}\n\n.a-player-bot .support-block, .player-bot .sound-block {\n    position: absolute;\n    top: 10px;\n}\n\n.a-player-bot .support-block {\n    left: 14px;\n    color: #272727;\n    font-size: 14px;\n}\n\n.a-player-bot .sound-block {\n    height: 21px;\n    overflow: hidden;\n    left: 50%;\n    transform: translate(-50%, 0);\n    cursor: pointer;\n    position: absolute;\n    top: 10px;\n}\n\n.a-player-bot .sound-block img {\n    display: block;\n}\n\n.a-player-bot .sound-block .off {\n    display: none;\n}\n\n.a-player-bot .sound-block.mute .on {\n    display: none;\n}\n\n.a-player-bot .sound-block.mute .off {\n    display: block;\n}\n\n.a-player-bot .disable-ad {\n    visibility: hidden;\n    position: absolute;\n    top: 0;\n    right: 0;\n    font-size: 14px;\n    height: 40px;\n    cursor: pointer;\n    color: #272727;\n    padding: 10px 16px;\n    background-color: #f3f3f3;\n    box-sizing: border-box;\n}\n\n.a-player-bot .disable-ad:hover {\n    background-color: #ffbe00;\n}';

var templateView = '\n<div class="a-player-top">\n    <div class="a-btn more-link">\u041F\u043E\u0434\u0440\u043E\u0431\u043D\u0435\u0435\u2026</div>\n</div>\n<div class="a-btn length-block">\n    \u0420\u0435\u043A\u043B\u0430\u043C\u0443 \u043C\u043E\u0436\u043D\u043E \u0431\u0443\u0434\u0435\u0442 \u043F\u0440\u043E\u043F\u0443\u0441\u0442\u0438\u0442\u044C <span class="count">(0:07)</span>\n</div>\n<div class="a-btn skip-block">\u041F\u0440\u043E\u043F\u0443\u0441\u0442\u0438\u0442\u044C ></div>\n<div class="a-play-btn">\n    <img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iNzdweCIgaGVpZ2h0PSIxMDJweCIgdmlld0JveD0iMCAwIDc3IDEwMiIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB4bWxuczpza2V0Y2g9Imh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaC9ucyI+ICAgICAgICA8dGl0bGU+YmlnLXBsYXk8L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGRlZnM+PC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBza2V0Y2g6dHlwZT0iTVNQYWdlIj4gICAgICAgIDxnIGlkPSJodG1sLXBsYXllciIgc2tldGNoOnR5cGU9Ik1TQXJ0Ym9hcmRHcm91cCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTM2OC4wMDAwMDAsIC0xODMuMDAwMDAwKSIgZmlsbD0iI0ZGRkZGRiI+ICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwIiBza2V0Y2g6dHlwZT0iTVNMYXllckdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTIuMDAwMDAwLCAwLjAwMDAwMCkiPiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNMzg0LjEyNDgzLDI4NC4xNzA3OSBDMzgxLjg0Njc0OSwyODUuNzMzMzIgMzgwLDI4NC43NjE1ODIgMzgwLDI4MS45OTQxOTggTDM4MCwxODYuMDA1ODAyIEMzODAsMTgzLjI0MTE3NCAzODEuODUxMTY3LDE4Mi4yNDU5NzggMzg0LjE1MjI4NSwxODMuNzk0ODA3IEw0NTQuNjczMzksMjMxLjI2MDkzNSBDNDU2LjUxMDYyNiwyMzIuNDk3NTM3IDQ1Ni41Mjg2NTcsMjM0LjUwOTE5IDQ1NC42OTgyNTgsMjM1Ljc2NDY1NyBMMzg0LjEyNDgzLDI4NC4xNzA3OSBaIiBpZD0iYmlnLXBsYXkiIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiPjwvcGF0aD4gICAgICAgICAgICA8L2c+ICAgICAgICA8L2c+ICAgIDwvZz48L3N2Zz4=" alt=""/>\n</div>\n<div class="a-player-bot">\n    <div class="player-slider">\n        <div class="slider-range" style="width: 62%;"></div>\n    </div>\n    <div class="support-block">\n        \u0420\u0435\u043A\u043B\u0430\u043C\u0430 \u0432 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u043A\u0443 <span class="user">Miker</span>\n    </div>\n    <div class="sound-block">\n        <div class="on"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMjFweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMjEgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiPiAgICAgICAgPHRpdGxlPm11dGU8L3RpdGxlPiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4gICAgPGRlZnM+ICAgICAgICA8bGluZWFyR3JhZGllbnQgeDE9IjUwJSIgeTE9IjAlIiB4Mj0iNTAlIiB5Mj0iMTAwJSIgaWQ9ImxpbmVhckdyYWRpZW50LTEiPiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwMDAwMDAiIHN0b3Atb3BhY2l0eT0iMC4yOTYzMDg4NzciIG9mZnNldD0iMCUiPjwvc3RvcD4gICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMDAwMDAwIiBzdG9wLW9wYWNpdHk9IjAiIG9mZnNldD0iMTAwJSI+PC9zdG9wPiAgICAgICAgPC9saW5lYXJHcmFkaWVudD4gICAgICAgIDxsaW5lYXJHcmFkaWVudCB4MT0iNTAlIiB5MT0iMCUiIHgyPSI1MCUiIHkyPSIxMDAlIiBpZD0ibGluZWFyR3JhZGllbnQtMiI+ICAgICAgICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iIzAwMDAwMCIgc3RvcC1vcGFjaXR5PSIwLjMiIG9mZnNldD0iMCUiPjwvc3RvcD4gICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMDAwMDAwIiBzdG9wLW9wYWNpdHk9IjAiIG9mZnNldD0iMTAwJSI+PC9zdG9wPiAgICAgICAgPC9saW5lYXJHcmFkaWVudD4gICAgICAgIDxwYXRoIGlkPSJwYXRoLTMiIGQ9Ik0xMSwwIEwxMSwyNCBMMCwxMy41IEwxMSwwIFoiPjwvcGF0aD4gICAgPC9kZWZzPiAgICA8ZyBpZD0iUGFnZS0xIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIiBza2V0Y2g6dHlwZT0iTVNQYWdlIj4gICAgICAgIDxnIGlkPSJodG1sLXBsYXllci10aXBzIiBza2V0Y2g6dHlwZT0iTVNBcnRib2FyZEdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMjc2LjAwMDAwMCwgLTQyMC4wMDAwMDApIj4gICAgICAgICAgICA8ZyBpZD0iR3JvdXAiIHNrZXRjaDp0eXBlPSJNU0xheWVyR3JvdXAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0xMi4wMDAwMDAsIDAuMDAwMDAwKSI+ICAgICAgICAgICAgICAgIDxnIGlkPSJtdXRlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyODguMDAwMDAwLCA0MTYuMDAwMDAwKSI+ICAgICAgICAgICAgICAgICAgICA8ZyBpZD0id2F2ZXMiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEwLjAwMDAwMCwgMC4wMDAwMDApIj4gICAgICAgICAgICAgICAgICAgICAgICA8bWFzayBpZD0ibWFzay00IiBza2V0Y2g6bmFtZT0iTWFzayIgZmlsbD0id2hpdGUiPiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNwYXRoLTMiPjwvdXNlPiAgICAgICAgICAgICAgICAgICAgICAgIDwvbWFzaz4gICAgICAgICAgICAgICAgICAgICAgICA8dXNlIGlkPSJNYXNrIiBmaWxsLW9wYWNpdHk9IjAiIGZpbGw9IiMyNzI3MjciIHNrZXRjaDp0eXBlPSJNU1NoYXBlR3JvdXAiIHhsaW5rOmhyZWY9IiNwYXRoLTMiPjwvdXNlPiAgICAgICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0xLDIzIEM2LjUyMjg0NzUsMjMgMTEsMTguNTIyODQ3NSAxMSwxMyBDMTEsNy40NzcxNTI1IDYuNTIyODQ3NSwzIDEsMyBDLTQuNTIyODQ3NSwzIC05LDcuNDc3MTUyNSAtOSwxMyBDLTksMTguNTIyODQ3NSAtNC41MjI4NDc1LDIzIDEsMjMgWiBNMSwyMSBDNS40MTgyNzgsMjEgOSwxNy40MTgyNzggOSwxMyBDOSw4LjU4MTcyMiA1LjQxODI3OCw1IDEsNSBDLTMuNDE4Mjc4LDUgLTcsOC41ODE3MjIgLTcsMTMgQy03LDE3LjQxODI3OCAtMy40MTgyNzgsMjEgMSwyMSBaIE0xLDE5IEM0LjMxMzcwODUsMTkgNywxNi4zMTM3MDg1IDcsMTMgQzcsOS42ODYyOTE1IDQuMzEzNzA4NSw3IDEsNyBDLTIuMzEzNzA4NSw3IC01LDkuNjg2MjkxNSAtNSwxMyBDLTUsMTYuMzEzNzA4NSAtMi4zMTM3MDg1LDE5IDEsMTkgWiBNMSwxNyBDMy4yMDkxMzksMTcgNSwxNS4yMDkxMzkgNSwxMyBDNSwxMC43OTA4NjEgMy4yMDkxMzksOSAxLDkgQy0xLjIwOTEzOSw5IC0zLDEwLjc5MDg2MSAtMywxMyBDLTMsMTUuMjA5MTM5IC0xLjIwOTEzOSwxNyAxLDE3IFoiIGlkPSJUcmlhbmdsZS0xIiBmaWxsPSIjMjcyNzI3IiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIiBtYXNrPSJ1cmwoI21hc2stNCkiPjwvcGF0aD4gICAgICAgICAgICAgICAgICAgIDwvZz4gICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDEwLjk5NzAzMDEgQzAsMTAuNDQ2Mzg1NiAwLjQ0MzM1MzE3NiwxMCAxLjAwOTM2ODksMTAgTDQsMTAgTDEwLDQgTDExLDQgTDExLDIzIEwxMCwyMyBMNCwxOCBMMS4wMDkzNjg5LDE4IEMwLjQ1MTkwOTg0OCwxOCAwLDE3LjU0Njk2MzcgMCwxNy4wMDI5Njk5IEwwLDEwLjk5NzAzMDEgWiIgZmlsbD0iIzI3MjcyNyIgc2tldGNoOnR5cGU9Ik1TU2hhcGVHcm91cCI+PC9wYXRoPiAgICAgICAgICAgICAgICA8L2c+ICAgICAgICAgICAgPC9nPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+" alt=""/></div>\n        <div class="off"><img src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB3aWR0aD0iMjFweCIgaGVpZ2h0PSIzMHB4IiB2aWV3Qm94PSIwIDAgMjEgMzAiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeG1sbnM6c2tldGNoPSJodHRwOi8vd3d3LmJvaGVtaWFuY29kaW5nLmNvbS9za2V0Y2gvbnMiPiAgICAgICAgPHRpdGxlPnVubXV0ZTwvdGl0bGU+ICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPiAgICA8ZGVmcz4gICAgICAgIDxsaW5lYXJHcmFkaWVudCB4MT0iNTAlIiB5MT0iMCUiIHgyPSI1MCUiIHkyPSIxMDAlIiBpZD0ibGluZWFyR3JhZGllbnQtMSI+ICAgICAgICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iIzAwMDAwMCIgc3RvcC1vcGFjaXR5PSIwLjI5NjMwODg3NyIgb2Zmc2V0PSIwJSI+PC9zdG9wPiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwMDAwMDAiIHN0b3Atb3BhY2l0eT0iMCIgb2Zmc2V0PSIxMDAlIj48L3N0b3A+ICAgICAgICA8L2xpbmVhckdyYWRpZW50PiAgICAgICAgPGxpbmVhckdyYWRpZW50IHgxPSI1MCUiIHkxPSIwJSIgeDI9IjUwJSIgeTI9IjEwMCUiIGlkPSJsaW5lYXJHcmFkaWVudC0yIj4gICAgICAgICAgICA8c3RvcCBzdG9wLWNvbG9yPSIjMDAwMDAwIiBzdG9wLW9wYWNpdHk9IjAuMyIgb2Zmc2V0PSIwJSI+PC9zdG9wPiAgICAgICAgICAgIDxzdG9wIHN0b3AtY29sb3I9IiMwMDAwMDAiIHN0b3Atb3BhY2l0eT0iMCIgb2Zmc2V0PSIxMDAlIj48L3N0b3A+ICAgICAgICA8L2xpbmVhckdyYWRpZW50PiAgICA8L2RlZnM+ICAgIDxnIGlkPSJQYWdlLTEiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIHNrZXRjaDp0eXBlPSJNU1BhZ2UiPiAgICAgICAgPGcgaWQ9Imh0bWwtcGxheWVyLXRpcHMiIHNrZXRjaDp0eXBlPSJNU0FydGJvYXJkR3JvdXAiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC03My4wMDAwMDAsIC00MjAuMDAwMDAwKSI+ICAgICAgICAgICAgPGcgaWQ9Ikdyb3VwIiBza2V0Y2g6dHlwZT0iTVNMYXllckdyb3VwIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtMTIuMDAwMDAwLCAwLjAwMDAwMCkiPiAgICAgICAgICAgICAgICA8ZyBpZD0idW5tdXRlIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg4NS4wMDAwMDAsIDQyMC4wMDAwMDApIiBza2V0Y2g6dHlwZT0iTVNTaGFwZUdyb3VwIj4gICAgICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDYuOTk3MDMwMTQgQzAsNi40NDYzODU2IDAuNDQzMzUzMTc2LDYgMS4wMDkzNjg5LDYgTDQsNiBMMTAsMCBMMTEsMCBMMTEsMTkgTDEwLDE5IEw0LDE0IEwxLjAwOTM2ODksMTQgQzAuNDUxOTA5ODQ4LDE0IDAsMTMuNTQ2OTYzNyAwLDEzLjAwMjk2OTkgTDAsNi45OTcwMzAxNCBaIE0xNy45NDk3NDc1LDkuNTM1NTMzOTEgTDIwLjA3MTA2NzgsNy40MTQyMTM1NiBMMTguNjU2ODU0Miw2IEwxNi41MzU1MzM5LDguMTIxMzIwMzQgTDE0LjQxNDIxMzYsNiBMMTMsNy40MTQyMTM1NiBMMTUuMTIxMzIwMyw5LjUzNTUzMzkxIEwxMywxMS42NTY4NTQyIEwxNC40MTQyMTM2LDEzLjA3MTA2NzggTDE2LjUzNTUzMzksMTAuOTQ5NzQ3NSBMMTguNjU2ODU0MiwxMy4wNzEwNjc4IEwyMC4wNzEwNjc4LDExLjY1Njg1NDIgTDE3Ljk0OTc0NzUsOS41MzU1MzM5MSBaIiBpZD0ibXV0ZSIgZmlsbD0iIzI3MjcyNyI+PC9wYXRoPiAgICAgICAgICAgICAgICA8L2c+ICAgICAgICAgICAgPC9nPiAgICAgICAgPC9nPiAgICA8L2c+PC9zdmc+" alt=""/></div>\n    </div>\n    <div class="disable-ad">\u041E\u0442\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u0440\u0435\u043A\u043B\u0430\u043C\u0443</div>\n</div>';

var instance = undefined;

var GGView = function (_EventEmitter) {
    _inherits(GGView, _EventEmitter);

    _createClass(GGView, null, [{
        key: 'getInstance',
        value: function getInstance() {
            if (!instance) {
                instance = new GGView();
            }

            return instance;
        }
    }]);

    function GGView() {
        _classCallCheck(this, GGView);

        var _this = _possibleConstructorReturn(this, (GGView.__proto__ || Object.getPrototypeOf(GGView)).call(this));

        var fontAvailable = false;
        try {
            fontAvailable = document.fonts.check('14px "Open Sans"');
        } catch (err) {
            fontAvailable = false;
        }
        if (!fontAvailable) {
            var fontLink = document.createElement('link');
            fontLink.href = '//fonts.googleapis.com/css?family=Open+Sans:400,600&amp;subset=cyrillic-ext';
            fontLink.rel = 'stylesheet';
            fontLink.type = 'text/css';
            document.querySelector('head').appendChild(fontLink);
            document.fonts.load('14px "Open Sans"');
        }

        var styleEl = document.createElement('style');
        styleEl.innerHTML = style;
        document.querySelector('head').appendChild(styleEl);

        var v = document.createElement('div');
        v.innerHTML = templateView;

        _this.countBlock = v.querySelector('.a-btn.length-block');
        _this.countEl = _this.countBlock.querySelector('.count');

        _this.skipButton = v.querySelector('.a-btn.skip-block');
        _this.skipButton.addEventListener('click', function (e) {
            _this.emit('skipClick');
            e.stopPropagation();
        });

        _this.playButton = v.querySelector('.a-play-btn');
        _this.playButton.addEventListener('click', function (e) {
            _this.playButton.style.visibility = 'hidden';
            _this.emit('playClick');
            e.stopPropagation();
        });

        _this.volume = v.querySelector('.sound-block');
        _this.volume.addEventListener('click', function () {
            var isMute = _this.volume.classList.toggle('mute');
            _this.emit(isMute ? 'mute' : 'unmute');
        });

        _this.progressSlider = v.querySelector('.slider-range');

        _this.moreInfo = v.querySelector('.a-btn.more-link');
        _this.moreInfo.addEventListener('click', function () {
            return _this.emit('clickthrough');
        });

        _this.channelNameEl = v.querySelector('.support-block .user');

        if (_configUtils2.default.config.adOffCallback) {
            var adOffBtn = v.querySelector('.disable-ad');
            adOffBtn.style.visibility = 'visible';
            adOffBtn.addEventListener('click', function () {
                _this.emit('pause');
                _configUtils2.default.config.adOffCallback.call();
            });
        }

        _this.elements = v.querySelectorAll(['.a-player-top', '.a-btn.length-block', '.a-btn.skip-block', '.a-play-btn', '.a-player-bot']);
        _this.reset();
        return _this;
    }

    _createClass(GGView, [{
        key: 'addToContainer',
        value: function addToContainer(container) {
            this.channelNameEl.innerHTML = _configUtils2.default.config.channelName;
            this.elements.forEach(function (el) {
                return container.appendChild(el);
            });

            container.style.fontFamily = '"Open Sans", sans-serif';
            container.style.fontSize = '14px';
            container.style.color = '#272727';
        }
    }, {
        key: 'showSkip',
        value: function showSkip() {
            this.countBlock.style.visibility = 'hidden';
            this.skipButton.style.visibility = 'visible';
        }
    }, {
        key: 'showPlay',
        value: function showPlay() {
            this.playButton.style.visibility = 'visible';
        }
    }, {
        key: 'progress',
        value: function progress(percent) {
            percent = percent > 100 ? 100 : percent;
            this.progressSlider.style.width = percent + '%';
        }
    }, {
        key: 'skipCountdown',
        value: function skipCountdown(sec) {
            sec = Math.ceil(sec);
            this.countEl.innerHTML = '(0:' + (sec < 10 ? '0' + sec.toString() : sec) + ')';
        }
    }, {
        key: 'reset',
        value: function reset() {
            this.progressSlider.style.width = '0%';

            this.countBlock.style.visibility = 'visible';
            this.skipButton.style.visibility = 'hidden';

            this.playButton.style.visibility = 'hidden';

            if (this.volume.classList.contains('mute')) {
                this.volume.classList.toggle('mute');
            }

            this.removeAllListeners();
        }
    }]);

    return GGView;
}(_events2.default);

exports.default = GGView;

},{"../configUtils":34,"events":2}],"goodgame.adsmod":[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

var _events = require('events');

var _events2 = _interopRequireDefault(_events);

var _logger = require('./logger');

var _logger2 = _interopRequireDefault(_logger);

var _adsController = require('./adsController');

var _adsController2 = _interopRequireDefault(_adsController);

var _adsEvents = require('./adsEvents');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return call && (typeof call === "object" || typeof call === "function") ? call : self; }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function, not " + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }

var AdMod = function (_EventEmitter) {
    _inherits(AdMod, _EventEmitter);

    function AdMod() {
        _classCallCheck(this, AdMod);

        var _this = _possibleConstructorReturn(this, (AdMod.__proto__ || Object.getPrototypeOf(AdMod)).call(this));

        var adsController = new _adsController2.default();
        adsController.on(_adsEvents.ModuleEvent.Started, function (event) {
            return _this.emit(event.type, event);
        });
        adsController.on(_adsEvents.ModuleEvent.Ended, function (event) {
            return _this.emit(event.type, event);
        });
        adsController.on(_adsEvents.ModuleEvent.Ready, function (event) {
            return _this.emit(event.type, event);
        });
        _logger2.default.debug('AdMod created');

        _this.showAd = function () {
            adsController.showAd();
        };

        _this.setConfig = function (config) {
            adsController.setConfig(config);
            return _this;
        };

        _this.setVolume = function (volume) {
            adsController.setVolume(volume);
            return _this;
        };

        _this.destroy = function () {
            adsController.destroy();
            _this.removeAllListeners();
        };
        return _this;
    }

    return AdMod;
}(_events2.default);

exports.default = AdMod;

module.exports = AdMod;

},{"./adsController":21,"./adsEvents":22,"./logger":36,"events":2}]},{},["goodgame.adsmod"]);
